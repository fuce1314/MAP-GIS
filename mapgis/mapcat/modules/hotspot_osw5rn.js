/**/ï»¿_jsload&&_jsload('hotspot', 'function G(e){this._map=e;this._enableSpot=true;this.bindMapEvent()}G.prototype.enable=function(){this._enableSpot=true};G.prototype.disable=function(){this._enableSpot=false};G.prototype.bindMapEvent=function(){var jX=this._map;var jV=this;function i(){jV.disable()}function e(){jV.enable()}jX.addEventListener("movestart",i);jX.addEventListener("moveend",e);jX.addEventListener("zoomstart",i);jX.addEventListener("zoomend",function(){setTimeout(e,10)});function T(){jV.reset()}jX.addEventListener("load",T);jX.addEventListener("moveend",T);jX.addEventListener("zoomend",T);jX.addEventListener("dragend",function(){this.temp.__dragged=true});jX.addEventListener("mousemove",function jW(j7){if(jX.currentOperation!==d6.idle||jV._enableSpot===false){return}if(j7.overlay&&!(j7.overlay instanceof ik)||j7.infoWindow){return}var kc=this.temp;if(kc.spottimer){clearTimeout(kc.spottimer);kc.spottimer=null}if(jX.spotsPool){var jY=jX.temp.curSpots.slice(0);jX.temp.curSpots=[];var j8=jV.getSpotsByScreenPosition(j7.pixel);if(j8.length>0){jX.platform.style.cursor="pointer"}jX.temp.curSpotsArray=[];for(var j5=jX.temp.curSpots.length-1;j5>=0;j5--){if(jX.temp.curSpots[j5]&&jX.temp.curSpots[j5].spots&&jX.temp.curSpots[j5].spots.length>0){jX.temp.curSpotsArray=jX.temp.curSpots[j5].spots;break}}var j9=jX.temp.curSpotsArray.slice(0);var j0=[];var kb=j5;for(var j5=jY.length-1;j5>=0;j5--){if(j5===kb){j0=jY[kb]&&jY[kb].spots||[];for(var j4=0,j2=j0.length;j4<j2;j4++){for(var j3=0,jZ=0,j1=jX.temp.curSpotsArray.length;j3<j1;j3++,jZ++){if(j0[j4]===jX.temp.curSpotsArray[j3]){j0.splice(j4,1);j4--;j9.splice(jZ,1);jZ--}}}}else{if(jY[j5]&&jY[j5].spots&&jY[j5].spots.length>0){for(var j4=0;j4<jY[j5].spots.length;j4++){j0.push(jY[j5].spots[j4])}}}}if(j0.length>0){var j6=new fA("onspotmouseout");j6.spots=j0.slice(0);jX.dispatchEvent(j6)}if(jX.temp.curSpotsArray.length===0){var ka=null;if(jX.getZoom()>=17){ka=jV.checkAreaSpot(j7.point)}if(ka){if(jX.platform.style.cursor!=="pointer"){jX.platform.style.cursor="pointer"}jX.temp.curAreaSpot=ka}else{if(jX.platform.style.cursor!==jX.config.defaultCursor){jX.platform.style.cursor=jX.config.defaultCursor}jX.temp.curAreaSpot=null}}else{if(j9.length>0){var j6=new fA("onspotmouseover");if(jX.temp.curSpots[jX.temp.curSpots.length-1].enableMultiResponse){j6.spots=j9.slice(0)}else{j9.sort(function(ke,kd){return ke._distance-kd._distance});j6.spots=j9.slice(0,1)}if(j7.point){j6.point=new cu(j7.point.lng,j7.point.lat)}j6.pixel=new fa(j7.pixel.x,j7.pixel.y);jX.dispatchEvent(j6)}}}});jX.addEventListener("click",function(j4){var j2=this.temp;if(j4.overlay&&!(j4.overlay instanceof g4)){return}if(!j4.point){return}if(eP.Platform.iphone||eP.Platform.ipad||eP.Platform.android){j2.curSpotsArray=jV.getSpotsByScreenPosition(j4.pixel)}var j3=new fA("onspotclick");j3.point=new cu(j4.point.lng,j4.point.lat);j3.pixel=new fa(j4.pixel.x,j4.pixel.y);if(j2.curSpotsArray.length>0){for(var j1=0,jY=j2.curSpots.length;j1<jY;j1++){if(j2.curSpots[j1].spots&&j2.curSpots[j1].spots.length>0){if(j2.curSpots[j1].enableMultiResponse){j3.spots=j2.curSpotsArray.slice(0)}else{j2.curSpotsArray.sort(function(j7,j6){return j7._distance-j6._distance});j3.spots=j2.curSpotsArray.slice(0,1)}break}}}var j0=j3.spots||[];for(var j1=0;j1<j0.length;j1++){var jZ=j0[j1].pt;var j5=jV.checkAreaSpot(jZ);if(j5){j2.curAreaSpot=j5}}j3.curAreaSpot=j2.curAreaSpot;this.dispatchEvent(j3)});jX.addEventListener("rightclick",function(jZ){if(jZ.overlay&&!(jZ.overlay instanceof g4)){return}if(!jZ.point){return}var jY=new fA("onhotspotrightclick");jY.point=new cu(jZ.latlng.lng,jZ.latlng.lat);jY.mct=new cu(jZ.point.lng,jZ.point.lat);jY.pixel=new fa(jZ.pixel.x,jZ.pixel.y);if(u.environment==="customEditor"){jY.styleIds=jV.checkStyleAreaSpot(jZ.point)}this.dispatchEvent(jY)})};G.prototype.getSpotsByScreenPosition=function(jX){var j4=[];var e=this._map;var jZ=e.getTilt();if(!e.spotsPool){return j4}for(var jV in e.spotsPool){var j2=e.spotsPool[jV];var j0=j2.spots.slice(0);e.temp.curSpots[j2.zIndex]={spots:[],enableMultiResponse:j2.enableMultiResponse};for(var jY=0,jW=j0.length;jY<jW;jY++){var j3=j0[jY];if(j3.lr&&(e.getZoom()<j3.lr[0]||e.getZoom()>j3.lr[1])){continue}var T=j3.px||e.pointToPixelIn(j3.pt);if(T.x<e.width&&T.y<e.height){if((jX.x-T.x<j3.bd[2]&&jX.x-T.x>j3.bd[0])&&(T.y-jX.y<j3.bd[3]&&T.y-jX.y>j3.bd[1])){if(jZ>55){var j1=e.pointToOverlayPixelIn(j3.pt);if(j1.outOfFrustum){continue}}e.temp.curSpots[j2.zIndex].spots.push(j3);j3._distance=cf(T,jX);j4.push(j3)}}}}return j4};G.prototype.checkAreaSpot=function(e){if(!e){return null}var T=this._map;if(T._displayOptions.indoor===false){return null}for(var jV in T.areaSpots){var i=T.areaSpots[jV];if(bJ([e.lng,e.lat],i.spot)){return jV}}return null};G.prototype.checkStyleAreaSpot=function(T){if(!T){return null}var jW=this._map;var i=[];for(var jX in jW.areaSpots){var jV=jW.areaSpots[jX];var e=jV.userData;if(e.type==="mapstyle"&&bJ([T.lng,T.lat],jV.spot)){i.push([e.styleId])}}return i};G.prototype.reset=function(){var e=this._map;if(e.temp.__dragged==true){e.temp.__dragged=false}else{e.temp.curSpots=[];e.platform.style.cursor=e.config.defaultCursor}};G.prototype.resetAreaSpot=function(){for(var T in this.areaSpots){var i=this.areaSpots[T];var e=i.userData;if(e.type==="mapstyle"){delete this.areaSpots[T]}}};bw.register(function(e){e._spotsMgr=new G(e)});');
