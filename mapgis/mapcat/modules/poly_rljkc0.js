/**/ï»¿_jsload&&_jsload('poly', 'ik.DOM_ATTRS={strokecolor:1,strokeweight:1,strokeopacity:1,fillcolor:1,fillopacity:1,strokelinecap:1,strokelinejoin:1,strokestyle:1,topfillcolor:1,topfillopacity:1,sidefillcolor:1,sidefillopacity:1};eP.extend(ik.prototype,{initialize:function(T){if(T&&this._graphMouseEvent){T.addEventListener("onmousemove",this._graphMouseEvent)}if(T&&this._graphClickEvent){T.addEventListener("onclick",this._graphClickEvent);T.addEventListener("ondblclick",this._graphClickEvent);T.addEventListener("onrightclick",this._graphClickEvent);T.addEventListener("onrightdblclick",this._graphClickEvent)}if((this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"||this._config.strokeTexture)&&T.getRenderType()==="webgl"&&!this._config.texture){this._generateTexture()}var e=et.prototype.initialize.call(this,T);if(this._config.enableEditing===true&&!this._config.geodesic){var i=this;setTimeout(function(){i.clearVertexs();i.addVertexs()},0)}return e},_generateTexture:function(){var jY=this._config;if(jY.strokeTexture&&jY.strokeTexture.url){this._config.texture=jY.strokeTexture.url;var jZ=jY.strokeTexture.width||16;var i=jY.strokeTexture.height||16;this._totalDashLen=jY.strokeWeight*Math.round(i/jZ);this._config.textureSize=[jZ,i];return}var jV=jY.dashArray;var jX=document.createElement("canvas");var e;var jW;if(jY.strokeStyle==="dashed"){e=16;jW=e*8}else{if(jY.strokeStyle==="dotted"){e=32;jW=e*2}}jX.width=e;jX.height=jW;var T=jX.getContext("2d");T.fillStyle=jY.strokeColor;T.globalAlpha=jY.strokeOpacity;if(jY.strokeStyle==="dashed"){this._drawDashArrayTexture(T,e,jW)}else{if(jY.strokeStyle==="dotted"){this._drawDottedTexture(T,e,jW)}}this._config.texture=jX;this._config.textureSize=[e,jW]},_drawDashArrayTexture:function(j1,jV,jX){var T=this._config;var jZ=T.dashArray;if(!jZ){j1.fillRect(0,0,jV,jX/2);this._totalDashLen=T.strokeWeight*4}else{var j0=0;if(jZ.length%2!==0){jZ=jZ.concat(jZ)}for(var jW=0;jW<jZ.length;jW++){j0+=jZ[jW]}var e=0;for(var jW=0;jW<jZ.length;jW++){var jY=jZ[jW]/j0*jX;if(jW%2===0){j1.fillRect(0,e,jV,jY)}e+=jY}this._totalDashLen=j0}},_drawDottedTexture:function(i,e,T){i.beginPath();i.arc(e/2,e/2,e/2,0,2*Math.PI);i.fill();i.closePath();this._totalDashLen=this._config.strokeWeight*2},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=fL.getDrawer(this.map);this.domElement=e.addLine()},_bind:function(){var e=this.domElement;var jV=this;function jX(j3,j1){var j0=j3.srcElement||j3.target;var jZ=gH();var i=j3.pageX?j3.pageX:(j3.clientX+jZ[1]);var j5=j3.pageY?j3.pageY:(j3.clientY+jZ[0]);if(j3&&j1&&i&&j5&&j0){var j2=eP.I(j0.hashCode).map;var j4=eP.Dom.getOffset(j2.container);j1.pixel=new fa(i-j4.left,j5-j4.top);j1.point=j2.pixelToPointIn(j1.pixel);j1.latLng=j2.pixelToPoint(j1.pixel);return j1}else{return j1}}if(e&&fL.getDrawer(this.map).getType()!=="canvas"){eP.on(e,"click",function(i){jV.dispatchEvent(jX(i,new fA("onclick").inherit(i)))});eP.on(e,"mousedown",function(i){jV.dispatchEvent(jX(i,new fA("onmousedown").inherit(i)))});eP.on(e,"mouseup",function(i){jV.dispatchEvent(jX(i,new fA("onmouseup").inherit(i)))});eP.on(e,"dblclick",function(i){jV.dispatchEvent(jX(i,new fA("ondblclick").inherit(i)))})}e=null;if(!this._binded){this._binded=true;this.enableEventListen=true;this._graphMouseEvent=function(j2){if(!jV.map){return}if(jV.map.getMapType()==="B_EARTH_MAP"){return}if(jV instanceof bw.PolylineMultipart||jV instanceof bw.Marker3D){return}if(jV.map.temp._draggingMarker){return}if(!jV.enableEventListen){return}var jZ;if(j2.overlay&&j2.overlay.toString()==="Marker"){if(!j2.overlay.keepWhenMousemoveOn){if(jV._temp.ismouseout===false&&jV._temp.ismouseover===true){jV._temp.ismouseover=false;jV._temp.ismouseout=true;jZ=new fA("onmouseout");jV.dispatchEvent(jZ)}return}}var i=j2.point;var j1;if(jV.toString()!=="Polyline"){j1=jV._getInPnpoly(i)}else{j1=jV._getProximity(i)}var j0=j1.dist;if(j0>=0&&j0<jV._config.mouseOverTolerance){if(!jV._temp.ismouseover){jV._temp.ismouseover=true;jV._temp.ismouseout=false;jZ=new fA("onmouseover")}else{jZ=new fA("onmousemove");jV.map.platform.style.cursor=jV.map.config.overlayMoveCursor}}else{if(!jV._temp.ismouseout&&jV._temp.ismouseover){jV._temp.ismouseover=false;jV._temp.ismouseout=true;jZ=new fA("onmouseout");jV.map.platform.style.cursor=jV.map.config.defaultCursor}}if(jZ){if(jV.toString()!=="Polyline"&&jZ.type==="onmousemove"&&jV._temp.ismouseover===true&&(j0===0||j0>jV._config.mouseOverTolerance)){jZ.pixel=j2.pixel;jZ.point=j2.point;jZ.latLng=this.overlayPixelToPoint(j2.pixel)}else{jZ.point=this.overlayPixelToPointIn(j1.pixel);jZ.pixel=this.pointToPixelIn(jZ.point);jZ.latLng=this.overlayPixelToPoint(j1.pixel)}jV.dispatchEvent(jZ)}};this._graphClickEvent=function(j2){if(!jV.map){return}if(jV.map.getMapType()==="B_EARTH_MAP"){return}if(jV instanceof bw.PolylineMultipart||jV instanceof bw.Marker3D){return}if(jV.map.temp._draggingMarker){return}if(!jV.enableEventListen){return}var jZ;var i=j2.point;var j1;if(jV.toString()!=="Polyline"){j1=jV._getInPnpoly(i)}else{j1=jV._getProximity(i)}var j0=j1.dist;if(j0>=0&&j0<jV._config.mouseOverTolerance){jZ=new fA(j2.type)}if(jZ){if(jV.toString()!=="Polyline"&&jZ.type==="onmousemove"&&jV._temp.ismouseover===true&&(j0===0||j0>jV._config.mouseOverTolerance)){jZ.pixel=j2.pixel;jZ.point=j2.point;jZ.latLng=this.overlayPixelToPoint(j2.pixel)}else{jZ.point=this.overlayPixelToPointIn(j1.pixel);jZ.pixel=this.pointToPixelIn(jZ.point);jZ.latLng=this.overlayPixelToPoint(j1.pixel);if(jV.toString()==="GroundOverlay"&&jV.canPixelMap&&jV.canPixelMap()){jZ.color=jV.getImagePixel(jZ.point);jZ.value=jV.getValue(jZ.color)}}jV.dispatchEvent(jZ)}};this.map.addEventListener("onmousemove",this._graphMouseEvent);var jW=["onclick","dblclick","onrightclick","onrightdblclick"];for(var T=0;T<jW.length;T++){var jY=jW[T];this.map.addEventListener(jY,this._graphClickEvent)}this.addEventListener("mouseover",function(i){if(!this.map){return}});this.addEventListener("mouseout",function(i){if(!this.map){return}});this.map.addEventListener("movestart",function(){jV.enableEventListen=false;jV._mouseEventPixels=null});this.map.addEventListener("moveend",function(){jV.enableEventListen=true});this.map.addEventListener("zoomstart",function(){jV.enableEventListen=false;jV._mouseEventPixels=null});this.map.addEventListener("zoomend",function(){jV.enableEventListen=true});this.map.on("center_changed",function(){jV._mouseEventPixels=null});this.map.on("zoom_changed",function(){jV._mouseEventPixels=null});this.map.on("load",function(){jV._mouseEventPixels=null})}},draw:function(jW){if(!this.domElement){return}var jV=this.map;if(jV.getMapType()==="B_EARTH_MAP"||jV._renderType==="webgl"){return}jW=jW||{};var T=this.points.slice(0);if(this.greatCirclePoints.length>0){T[0]=this.greatCirclePoints}var i=this._getDisplayPixels(T,jW.zoom,jW.center);if(this._drawer){this._drawer.setPath(this.domElement,i)}},_draw:function(){if(this.map){this.initialize(this.map);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}this.draw()}},_getDisplayPixels:function(jZ,j0,e){var jV=this.map;var jY=[];if(jZ.length==0||!this.isVisible()){return[jY]}if(jV._renderType!=="webgl"&&!this.domElement){return[jY]}var T=jZ;if(!this._config.enableEditing&&this._config.enableParse){T=this._simplification(jZ)}var jX=[];if(jZ[0] instanceof cu){var j1=this._toOverlayPixels(T,j0,e);jX.push(j1.pixels);jX.isOnBack=j1.isOnBack}else{jX.isOnBack=false;for(var jW=0;jW<T.length;jW++){var j1=this._toOverlayPixels(T[jW],j0,e);jX.push(j1.pixels);if(j1.isOnBack===true){jX.isOnBack=true}}}return jX},_toOverlayPixels:function(j0,j3,e){var T=this.map;var j1;var j2=[];var jZ=T.pointToOverlayPixelIn(j0[0],{zoom:j3,center:e});j2.push(jZ);if(jZ.onBack){j1=true}for(var jX=1,jW=1,jV=j0.length;jX<jV;jX++){var jY=T.pointToOverlayPixelIn(j0[jX],{zoom:j3,center:e});if(jY.onBack){j1=true}if(!jY.equals(j2[jW-1])){j2.push(jY);jW++}}return{pixels:j2,isOnBack:j1}},getParseCacheIndex:function(e){e=Math.floor(e);if(this._config.getParseCacheIndex){return this._config.getParseCacheIndex(e)}if(e<6){return 0}if(e<10){return 1}if(e<15){return 2}return 3},getParseTolerance:function(i,e){if(e===2){e=1}i=Math.floor(i);if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return ik.parseTolerance[e][this.getParseCacheIndex(i)]},setPoints:function(i){this._clearCache();this.points=ik.getGraphPoints(i).slice(0);if(this.toString()==="GroundOverlay"&&this.updatePixelMc){this.updatePixelMc()}this._calcBounds();this.draw();var e=new fA("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(this._visible&&this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setPointAt:function(T,e){if(!e||!this.points[T]){return}this._clearCache();this.points[T]=new cu(e.lng,e.lat);this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=iU.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setOptions:function(i){i=i||{};var T=this.isStyleUseTexture();for(var e in i){if(i.hasOwnProperty(e)){var jW=this._config[e];var jV=i[e];this._config[e]=jV;if(jV!==jW&&(e==="strokeColor"||e==="strokeOpacity"||e==="strokeWeight")){if(this._config.texture){this._config.texture=null}if(T){this._generateTexture()}}if(this.map){this._setDomAttribute(e.toLowerCase(),i[e])}}}},isStyleUseTexture:function(){if(!this.map){return false}if(this.map.getRenderType()!=="webgl"){return false}return this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"||this._config.strokeTexture},setStrokeColor:function(e){this.setOptions({strokeColor:e})},setStrokeLineCap:function(e){if(this._config){this._config.strokeLineCap=e}this._setDomAttribute("strokelinecap",e)},setStrokeLineJoin:function(e){if(this._config){this._config.strokeLineJoin=e}this._setDomAttribute("strokelinejoin",e)},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e;if(!this.map){return}this._setDomAttribute("strokeweight",e)}},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e;if(!this.map){return}this._setDomAttribute("strokeopacity",e)},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this._setDomAttribute("fillopacity",e)},setStrokeStyle:function(e){if(e!="solid"&&e!="dashed"&&e!="dotted"){return}this._config.strokeStyle=e;this._setDomAttribute("strokestyle",e)},setFillColor:function(e){this._config.fillColor=e||"";this._setDomAttribute("fillcolor",e)},_setDomAttribute:function(i,T){if(!ik.DOM_ATTRS[i]){return}if(this._drawer){if(T===false||T===null||typeof T==="undefined"){T=""}this._drawer.setAttribute(this.domElement,i,T,this._config)}var e=new fA("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(i==="strokeweight"&&this.getStrokeStyle()==="dashed"&&fL.getDrawer(this.map)&&fL.getDrawer(this.map).getType()==="svg"){this._setDomAttribute("strokestyle","dashed")}},addVertexs:function(){var jZ=this;if(jZ.vertexMarkers.length){return}var j0=this.getVertexPoints();var jY;for(var jX=0,jV=j0.length;jX<jV;jX++){var e=j0[jX];if(e.t){if(this._config.nodeT&&this._config.nodeT instanceof jd){var T=this._config.nodeT}else{jY=B.imgPath+"nodeT.gif";var T=new jd(jY,new iL(11,11),{offset:new iL(5,5)})}}else{if(this._config.node&&this._config.node instanceof jd){var T=this._config.node}else{jY=B.imgPath+"node.gif";var T=new jd(jY,new iL(11,11),{offset:new iL(5,5)})}}var jW=new jz(e.p,{icon:T,delFlag:true});jW.enableDragging(true);jW.addEventListener("ondragging",function(j1){var i=new fA("onlinevertexdragging");i.overlay=this;i.from=j1;jZ.dispatchEvent(i);jZ._onMarkerDragging(j1)});jW.addEventListener("ondragstart",function(j1){var i=new fA("onlinevertexdragstart");i.overlay=this;i.from=j1;jZ.dispatchEvent(i);jZ._onMarkerDragstart(j1)});jW.addEventListener("ondragend",function(j1){var i=new fA("onlinevertexdragend");i.overlay=this;i.from=j1;jZ.dispatchEvent(i);jZ._onMarkerDragend(j1)});jW.addEventListener("onmarkerdelvertex",function(j1){var i=new fA("onlinevertexdel");i.overlay=this;i.from=j1;jZ.dispatchEvent(i);jZ._onMarkerDelVertex(j1)});jW.index=jX;jW.t=e.t;this.vertexMarkers.push(jW);this.map?this.map.addOverlay(jW):""}},clearVertexs:function(){var e;while(e=this.vertexMarkers.pop()){this.map.removeOverlay(e);e=undefined}this.vertexMarkers.length=0},getVertexPoints:function(){var jX=[];for(var jW=0,T=this.points.length;jW<T;jW++){var jY=this.points[jW];jX.push({p:jY,t:0});if(jW<T-1){var e=this.points[jW+1];var jV=new cu((jY.lng+e.lng)/2,(jY.lat+e.lat)/2);jX.push({p:jV,t:1})}}this.vertexPoints=jX;return jX},delVertex:function(e){this.map.removeOverlay(this.vertexMarkers[e]);this.vertexPoints.splice(e,1);this.vertexMarkers.splice(e,1)},_onMarkerDragging:function(i){},_onMarkerDragstart:function(T){this._editstate=false;var i=new fA("oneditstart");i.pixel=T.pixel;i.point=T.point;i.latLng=T.latLng;i.overlay=this;this.dispatchEvent(i)},_onMarkerDragend:function(jZ){this.vertexPoints.length=0;this._editstate=false;if(this._temp.dashedLine){this.map.removeOverlay(this._temp.dashedLine);delete this._temp.dashedLine}if(this._temp.preTNode){this.map.removeOverlay(this._temp.preTNode);delete this._temp.preTNode}if(this._temp.nexTNode){this.map.removeOverlay(this._temp.nexTNode);delete this._temp.nexTNode}var jY=jZ.currentTarget;var j0=jZ.point;var T=jY.index;var jX;if(T%2!=0){T=Math.ceil(T/2);jX=this.points.slice();var jW=this.points.length-T;var jV=jX.splice(T,jW);jX[jX.length]=j0;jX=jX.concat(jV)}else{T=T/2;this.points.splice(T,1,j0);if(this instanceof g4&&this.points.length-1==T){this.points.splice(0,1,j0)}jX=this.points}this.clearVertexs();this.setPoints(jX);this.addVertexs();var i=new fA("oneditend");i.pixel=jZ.pixel;i.point=jZ.point;i.latLng=jZ.latLng;i.overlay=this;this.dispatchEvent(i);this._mouseEventPixels=null},_onMarkerDelVertex:function(jX){if(this.toString()!=="Polyline"&&this.toString()!=="Polygon"){return}if(jX.target.type===0||jX.target.t===0){var jW=[];if(this.vertexPoints.length<4&&this.toString()==="Polyline"){return}if(this.vertexPoints.length<8&&this.toString()==="Polygon"){return}if(this.toString()==="Polygon"&&(jX.target.index===0||jX.target.index===(this.vertexPoints.length-1))){this.delVertex(this.vertexPoints.length-1);this.delVertex(0)}else{this.delVertex(jX.target.index)}for(var jV=0;jV<this.vertexPoints.length;jV++){if(this.vertexPoints[jV].t===0){jW.push(this.vertexPoints[jV].p)}}this.points=jW;if(this.points[0].lng===this.points[this.points.length-1].lng&&this.points[0].lat===this.points[this.points.length-1].lat){this.points.splice(this.points.length-1,1)}this.clearVertexs();this.setPoints(this.points);this.addVertexs();var T=new fA("oneditend");T.pixel=jX.pixel;T.point=jX.point;T.latLng=jX.latLng;T.overlay=this;this.dispatchEvent(T);this._mouseEventPixels=null}},_getInPnpoly:function(T){var jV;var jZ=[];var e=this.map.pointToOverlayPixelIn(T);if(this._mouseEventPixels){jZ=this._mouseEventPixels}else{if(!(this.points[0] instanceof cu)){var jY=this._getDisplayPixels(this.points);for(var jX=0;jX<jY.length;jX++){jY[jX].push(jY[jX][0]);jZ=jZ.concat(jY[jX])}}else{jZ=this._getDisplayPixels(this.points)[0]}jZ=jZ[0]===undefined?[]:jZ;this._mouseEventPixels=jZ}var jW=this._pixelPnpoly(e,jZ);jV=jW?0:1000;return{pixel:e,dist:jV}},_getProximity:function(j6){var T,jW,j7,jZ,jY,j5,j4,j3=[];var j8=this.map.pointToOverlayPixelIn(j6);if(this._mouseEventPixels){j3=this._mouseEventPixels}else{j3=this._getDisplayPixels(this.points)[0];j3=j3[0]===undefined?[]:j3;this._mouseEventPixels=j3}var kb=j3.length;if(kb>1){for(var j9=1;j9<kb;j9++){var j1=j3[j9-1];var kf=j3[j9];if(!j1||!kf){continue}if(j1.x!=kf.x){var ke=(kf.y-j1.y)/(kf.x-j1.x);var kc=kf.y-ke*kf.x;j4=Math.abs(ke*j8.x+kc-j8.y)/Math.sqrt(ke*ke+1)}else{j4=Math.abs(j8.x-kf.x)}var ka=Math.pow(kf.y-j1.y,2)+Math.pow(kf.x-j1.x,2);var jV=Math.pow(kf.y-j8.y,2)+Math.pow(kf.x-j8.x,2);var kd=Math.pow(j1.y-j8.y,2)+Math.pow(j1.x-j8.x,2);var jX=Math.pow(j4,2);var e=jV-jX+kd-jX;if(e>ka){j4=Math.sqrt(Math.min(jV,kd))}if((T==null)||(T>j4)){jW=Math.sqrt(kd-jX)/Math.sqrt(ka);j7=Math.sqrt(jV-jX)/Math.sqrt(ka);T=j4;j5=j9}T=Math.min(T,j4)}if(jW>1){jW=1}if(j7>1){jW=0;j7=1}var j2=j3[j5-1].x-j3[j5].x;var j0=j3[j5-1].y-j3[j5].y;jZ=j3[j5-1].x-(j2*jW);jY=j3[j5-1].y-(j0*jW)}return{pixel:new fa(jZ,jY),dist:T}},_pixelPnpoly:function(jW,jY){var e=jY.length;var T=0;var jX=false;for(var jV=0;jV<e;jV++){T=(jV===e-1)?0:T+1;if((jY[jV].y!==jY[T].y)&&(((jW.y>=jY[jV].y)&&(jW.y<jY[T].y))||((jW.y>=jY[T].y)&&(jW.y<jY[jV].y)))&&(jW.x<(jY[T].x-jY[jV].x)*(jW.y-jY[jV].y)/(jY[T].y-jY[jV].y)+jY[jV].x)){jX=!jX}}return jX},getMinDistance:function(i){var e=this._getProximity(i);var T=this.map.overlayPixelToPointIn(e.pixel);return this.map.getDistanceIn(i,T)},buildVertex:function(jW,j2){var jZ=[];var j3=[];var j5=this.points.slice(0);var j6=[];if(this.greatCirclePoints.length>0){j5[0]=this.greatCirclePoints}var T=ik.JOININDEX[this._config.strokeLineJoin];var j4=ik.CAPINDEX[this._config.strokeLineCap];var jV=this.getStrokeColorForGL();var e=this._config.strokeWeight/2;var jY=this.map.getZoom();if(j5.length>500&&j5[0] instanceof cu){if(!j2&&this._lastResult){return this._lastResult}var j1=this._getDisplayPixelsGLWithCut(j5);for(var jX=0;jX<j1.length;jX++){if(j1[jX].length<2){continue}if(jZ.length/6+jW.getVertexCount(j1[jX].length)>65536){j6.push([jZ,j3]);jZ=[];j3=[]}jW.buildData(j1[jX],T,j4,jZ,j3,jV,e)}j6.push([jZ,j3]);j6.inCache=false;this._lastResult=j6;return j6}var j0=this.getParseCacheIndex(this.map.getZoom());if(j2!==true&&this._parseCacheGL[j0]){this._parseCacheGL[j0].inCache=true;return this._parseCacheGL[j0]}var j1=this._getDisplayPixelsGL(j5);for(var jX=0;jX<j1.length;jX++){if(j1[jX].length<2){continue}if(jZ.length/6+jW.getVertexCount(j1[jX].length)>65536){j6.push([jZ,j3]);jZ=[];j3=[]}jW.buildData(j1[jX],T,j4,jZ,j3,jV,e)}j6.push([jZ,j3]);this._parseCacheGL[j0]=j6;this._parseCacheGL[j0].cacheIndex=j0;return j6},ifInMapView:function(){if(!this.map){return false}if(this.map.getZoom()<5){return true}if(this._config.clip===false){return true}var e=this.map.getBoundsIn();return !!e.intersects(this.getBoundsIn())},_getDisplayPixelsGLWithCut:function(e){return this._getDisplayPixelsGL(e)},_getDisplayPixelsGL:function(jV){var jX=this.map;var jW=[];var jZ=[];jW.pointsArray=jZ;if(jV.length==0||!this.isVisible()){return[jW]}var jY=jV;if(!this._config.enableEditing&&this._config.enableParse){jY=this._simplification(jV)}var T=[];if(!this.hasMultipleParts){T[0]=this._toOverlayPixelsGL(jY)}else{for(var e=0;e<jY.length;e++){T.push(this._toOverlayPixelsGL(jY[e]))}}return T},_toOverlayPixelsGL:function(j2){var T=this.map;var j1=[];var jY=[];j1.pointsArray=jY;var e=T._polyOverlayBasePoint;var j0=[j2[0].lng-e.lng,j2[0].lat-e.lat];j1.push(j0);jY.push(j0[0],j0[1]);for(var jX=1,jW=1,jV=j2.length;jX<jV;jX++){var jZ=[j2[jX].lng-e.lng,j2[jX].lat-e.lat];if(jZ[0]!==j1[jW-1][0]||jZ[1]!==j1[jW-1][1]){j1.push(jZ);jY.push(jZ[0],jZ[1]);jW++}}return j1},getStrokeColorForGL:function(){var i=this._config.strokeOpacity;var e;e=ho.formatColorCssToRgbaArray(this._config.strokeColor,i,false);return e},show:function(){et.prototype.show.call(this);var e=new fA("onlineupdate");e.action="show";e.overlay=this;this.dispatchEvent(e);if(this.map.getMapType()==="B_EARTH_MAP"||this.map._renderType==="webgl"){this._draw()}else{this.draw()}this._mouseEventPixels=null;if(this._config.enableEditing===true&&!this._config.geodesic){this.addVertexs()}if(this._areaCacheGL){var i=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[i]){this._areaCacheGL[i]=null}this.map._overlayMgrGL._updateGraphRenderData(this,true)}},hide:function(){et.prototype.hide.call(this);var e=new fA("onlineupdate");e.action="hide";e.overlay=this;this.dispatchEvent(e);this._mouseEventPixels=null;if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent);this.map.removeEventListener("ondblclick",this._graphClickEvent);this.map.removeEventListener("onrightclick",this._graphClickEvent);this.map.removeEventListener("onrightdblclick",this._graphClickEvent)}et.prototype.remove.call(this);this._clearCache();var e=new fA("onlineupdate");e.action="remove";e.overlay=this;this.fire(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},destroy:function(){this._normalizedBounds=[];this._bounds=[];this.vertexPoints=[];this._userPoints=[];this.points=[];this._mouseEventPixels=null;this._graphClickEvent=null;this._graphMouseEvent=null}});eP.extend(fK.prototype,{initialize:function(i){ik.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},_getDisplayPixels:function(j8,e,kd){var ke=this.map;var jX=[];if(j8.length===0||!this.isVisible()){return[jX]}if(ke._renderType!=="webgl"&&!this.domElement){return[jX]}if(!((eP.Platform.ipad||eP.Platform.iphone||eP.Platform.android)&&j8.length>5000)&&!this._config.enableEditing){var jY=this.getParseCacheIndex(ke.getZoom());if(this._parseCache[jY]){j8=this._parseCache[jY]}else{var j0=ke.config.coordType===2?1:ke.config.coordType;var T=dK(j8,this.getParseTolerance(ke.getZoom(),j0));j8=this._parseCache[jY]=T}}var kc;var kf=ke.pointToOverlayPixelIn(j8[0],{zoom:e,center:kd});jX.push(kf);if(kf.onBack){kc=true}for(var j9=1,j6=1,j5=j8.length;j9<j5;j9++){var jW=ke.pointToOverlayPixelIn(j8[j9],{zoom:e,center:kd});if(jW.onBack){kc=true}if(!jW.equals(jX[j6-1])){jX.push(jW);j6++}}var kb=[];var j3=Math.round(ke.offsetX);var j2=Math.round(ke.offsetY);if(ke._renderType==="webgl"){j3=j2=0}var j1=ke.config.drawMargin;var jZ={minX:-j3-j1,minY:-j2-j1,maxX:-j3+j1+ke.width,maxY:-j2+j1+ke.height};for(j9=0,j5=jX.length-1;j9<j5;j9++){var ka=jX[j9];var j7=jX[j9+1];var jV=bp(ka,j7,jZ);if(jV){kb.push(jV)}}var j4=[[]];for(j9=0,j5=kb.length;j9<j5;j9++){if(kb[j9].clip){j4[j4.length-1].push(kb[j9].pixel0);j4[j4.length-1].push(kb[j9].pixel1);if(kb[j9+1]&&kb[j9+1].clip){j4.push([])}}else{j4[j4.length-1].push(kb[j9].pixel0);if(j9===kb.length-1){j4[j4.length-1].push(kb[j9].pixel1)}}}j4.isOnBack=kc;return j4},_getDisplayPixelsGLWithCut:function(j6){var kb=this.map;var jX=[];if(j6.length===0||!this.isVisible()){return[jX]}if(!this._config.enableEditing){var jY=this.getParseCacheIndex(kb.getZoom());if(this._parseCache[jY]){j6=this._parseCache[jY]}else{var j0=kb.config.coordType===2?1:kb.config.coordType;var T=dK(j6,this.getParseTolerance(kb.getZoom(),j0));j6=this._parseCache[jY]=T}}var kc=kb._polyOverlayBasePoint;var e=kb.getZoomUnits();if(this._parseCacheGLRaw[jY]){jX=this._parseCacheGLRaw[jY]}else{var kd=new fa(j6[0].lng-kc.lng,j6[0].lat-kc.lat);jX.push(kd);for(var j7=1,j4=1,j3=j6.length;j7<j3;j7++){var jW=new fa(j6[j7].lng-kc.lng,j6[j7].lat-kc.lat);if(!jW.equals(jX[j4-1])){jX.push(jW);j4++}}this._parseCacheGLRaw[jY]=jX}var ka=kb.pixelToPointIn(new fa(0,kb.height));var j9=[];var j1=kb.config.drawMarginGL;var jZ={minX:Math.round(-j1*e+(ka.lng-kc.lng)),minY:Math.round(-j1*e+(ka.lat-kc.lat)),maxX:Math.round((j1+kb.width)*e+(ka.lng-kc.lng)),maxY:Math.round((j1+kb.height)*e+(ka.lat-kc.lat))};for(j7=0,j3=jX.length-1;j7<j3;j7++){var j8=jX[j7];var j5=jX[j7+1];var jV=bp(j8,j5,jZ);if(jV){j9.push(jV)}}var j2=[[]];for(j7=0,j3=j9.length;j7<j3;j7++){if(j9[j7].clip){j2[j2.length-1].push([j9[j7].pixel0.x,j9[j7].pixel0.y]);j2[j2.length-1].push([j9[j7].pixel1.x,j9[j7].pixel1.y]);if(j9[j7+1]&&j9[j7+1].clip){j2.push([])}}else{j2[j2.length-1].push([j9[j7].pixel0.x,j9[j7].pixel0.y]);if(j7===j9.length-1){j2[j2.length-1].push([j9[j7].pixel1.x,j9[j7].pixel1.y])}}}return j2},_getDisplayPixelsGL:function(j2){var T=this.map;var j1=[];if(j2.length===0||!this.isVisible()){return[j1]}if(this.greatCirclePoints.length>0){j2=this.greatCirclePoints}if(!this._config.enableEditing){var j0=this.getParseCacheIndex(T.getZoom());if(this._parseCache[j0]){j2=this._parseCache[j0]}else{var jY=T.config.coordType===2?1:T.config.coordType;var j3=dK(j2,this.getParseTolerance(T.getZoom(),jY));j2=this._parseCache[j0]=j3}}var e=T._polyOverlayBasePoint;j1.push([j2[0].lng-e.lng,j2[0].lat-e.lat]);for(var jX=1,jW=1,jV=j2.length;jX<jV;jX++){var jZ=[j2[jX].lng-e.lng,j2[jX].lat-e.lat];if(jZ[0]!==j1[jW-1][0]||jZ[1]!==j1[jW-1][1]){j1.push(jZ);jW++}}j1=[j1];this._addMultipleDrawPath(j1);return j1},_addMultipleDrawPath:function(T,jX,i){if(this._config.clip===true){return}var jW=this.map;jX=jX||jW.getZoom();if(jX>12&&jW.getRenderType()!=="webgl"){return}var e=i?jW.worldSize(jX):hx.WORLD_SIZE_MC;var jV=T.slice(0);eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x-e,j0.y))}else{jZ.push([j0[0]-e,j0[1]])}});T.push(jZ)});eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x+e,j0.y))}else{jZ.push([j0[0]+e,j0[1]])}});T.push(jZ)})},getParsedPoints:function(){var jY=this.map;var i=this.points;var e=[];var T=this;var jX=i.slice(0);jX=[jX];if(this.greatCirclePoints.length>0){jX=[];jX[0]=this.greatCirclePoints}eP.each(jX,function(j1){var j0=jY.config.coordType===2?1:jY.config.coordType;var jZ=dK(j1,T.getParseTolerance(jY.getZoom(),j0));e.push(jZ)});var jW=0;if(this._bounds.sw.lng<-hx.WORLD_SIZE_MC_HALF){jW=hx.WORLD_SIZE_MC}if(this._bounds.ne.lng>hx.WORLD_SIZE_MC_HALF){jW=-hx.WORLD_SIZE_MC}if(jW===0){return e}var jV=e.slice(0);eP.each(jV,function(jZ){var j0=[];eP.each(jZ,function(j1){j0.push(new cu(j1.lng+jW,j1.lat))});e.push(j0)});return e},_onMarkerDragging:function(j1){this._editstate=true;var T=j1.currentTarget;var j3=j1.point;var j2=T.index;var i=this.vertexPoints;var j4;var jZ=null;var jV=null;if(j2===0){var j0=i[j2+2].p;j4=[j3,j0];jZ=new cu((j0.lng+j3.lng)/2,(j0.lat+j3.lat)/2);if(this.vertexMarkers[j2+1]){this.vertexMarkers[j2+1].hide()}}else{if(j2===i.length-1){var jY=i[j2-2].p;j4=[jY,j3];jZ=new cu((jY.lng+j3.lng)/2,(jY.lat+j3.lat)/2);if(this.vertexMarkers[j2-1]){this.vertexMarkers[j2-1].hide()}}else{var jY=i[j2-1].p;var j0=i[j2+1].p;j4=[jY,j3,j0];if(!T.t){jY=i[j2-2].p;j0=i[j2+2].p;j4=[jY,j3,j0];jZ=new cu((jY.lng+j3.lng)/2,(jY.lat+j3.lat)/2);jV=new cu((j0.lng+j3.lng)/2,(j0.lat+j3.lat)/2);if(this.vertexMarkers[j2-1]){this.vertexMarkers[j2-1].hide()}if(this.vertexMarkers[j2+1]){this.vertexMarkers[j2+1].hide()}}}}if(!this._temp.dashedLine){var jX=new fK(j4,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(jX);jX.hide();this._temp.dashedLine=jX}else{this._temp.dashedLine.setPoints(j4);this._temp.dashedLine.show()}if(this._config.nodeT&&this._config.nodeT instanceof jd){var jW=this._config.nodeT}else{var jW=new jd(B.imgPath+"nodeT.gif",new iL(11,11),{offset:new iL(5,5)})}if(!this._temp.preTNode&&jZ){this._temp.preTNode=new jz(jZ,{icon:jW,delFlag:true});this.map.addOverlay(this._temp.preTNode)}else{if(jZ){this._temp.preTNode.setPoint(jZ)}}if(!this._temp.nexTNode&&jV){this._temp.nexTNode=new jz(jV,{icon:jW,delFlag:true});this.map.addOverlay(this._temp.nexTNode)}else{if(jV){this._temp.nexTNode.setPoint(jV)}}}});eP.extend(gE.prototype,{initialize:function(i){ik.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(i){this._clearCache();this.points=ik.getGraphPoints(i).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds();this.draw();var e=new fA("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(j8,e,kd){var ke=this.map;var jX=[];if(j8.length===0||!this.isVisible()){return[jX]}if(ke._renderType!=="webgl"&&!this.domElement){return[jX]}if(!((eP.Platform.ipad||eP.Platform.iphone||eP.Platform.android)&&j8.length>5000)&&!this._config.enableEditing){var jY=this.getParseCacheIndex(ke.getZoom());if(this._parseCache[jY]){j8=this._parseCache[jY]}else{var j0=ke.config.coordType===2?1:ke.config.coordType;var T=dK(j8,this.getParseTolerance(ke.getZoom(),j0));j8=this._parseCache[jY]=T}}var kc;var kf=ke.pointToOverlayPixelIn(j8[0],{zoom:e,center:kd});jX.push(kf);if(kf.onBack){kc=true}for(var j9=1,j6=1,j5=j8.length;j9<j5;j9++){var jW=ke.pointToOverlayPixelIn(j8[j9],{zoom:e,center:kd});if(jW.onBack){kc=true}if(!jW.equals(jX[j6-1])){jX.push(jW);j6++}}var kb=[];var j3=Math.round(ke.offsetX);var j2=Math.round(ke.offsetY);if(ke._renderType==="webgl"){j3=j2=0}var j1=ke.config.drawMargin;var jZ={minX:-j3-j1,minY:-j2-j1,maxX:-j3+j1+ke.width,maxY:-j2+j1+ke.height};for(j9=0,j5=jX.length-1;j9<j5;j9++){var ka=jX[j9];var j7=jX[j9+1];var jV=bp(ka,j7,jZ);if(jV){kb.push(jV)}}var j4=[[]];for(j9=0,j5=kb.length;j9<j5;j9++){if(kb[j9].clip){j4[j4.length-1].push(kb[j9].pixel0);j4[j4.length-1].push(kb[j9].pixel1);if(kb[j9+1]&&kb[j9+1].clip){j4.push([])}}else{j4[j4.length-1].push(kb[j9].pixel0);if(j9===kb.length-1){j4[j4.length-1].push(kb[j9].pixel1)}}}j4.isOnBack=kc;return j4},_getDisplayPixelsGLWithCut:function(j6){var kb=this.map;var jX=[];if(j6.length===0||!this.isVisible()){return[jX]}if(!this._config.enableEditing){var jY=this.getParseCacheIndex(kb.getZoom());if(this._parseCache[jY]){j6=this._parseCache[jY]}else{var j0=kb.config.coordType===2?1:kb.config.coordType;var T=dK(j6,this.getParseTolerance(kb.getZoom(),j0));j6=this._parseCache[jY]=T}}var kc=kb._polyOverlayBasePoint;var e=kb.getZoomUnits();if(this._parseCacheGLRaw[jY]){jX=this._parseCacheGLRaw[jY]}else{var kd=new fa(j6[0].lng-kc.lng,j6[0].lat-kc.lat);jX.push(kd);for(var j7=1,j4=1,j3=j6.length;j7<j3;j7++){var jW=new fa(j6[j7].lng-kc.lng,j6[j7].lat-kc.lat);if(!jW.equals(jX[j4-1])){jX.push(jW);j4++}}this._parseCacheGLRaw[jY]=jX}var ka=kb.pixelToPointIn(new fa(0,kb.height));var j9=[];var j1=kb.config.drawMarginGL;var jZ={minX:Math.round(-j1*e+(ka.lng-kc.lng)),minY:Math.round(-j1*e+(ka.lat-kc.lat)),maxX:Math.round((j1+kb.width)*e+(ka.lng-kc.lng)),maxY:Math.round((j1+kb.height)*e+(ka.lat-kc.lat))};for(j7=0,j3=jX.length-1;j7<j3;j7++){var j8=jX[j7];var j5=jX[j7+1];var jV=bp(j8,j5,jZ);if(jV){j9.push(jV)}}var j2=[[]];for(j7=0,j3=j9.length;j7<j3;j7++){if(j9[j7].clip){j2[j2.length-1].push([j9[j7].pixel0.x,j9[j7].pixel0.y]);j2[j2.length-1].push([j9[j7].pixel1.x,j9[j7].pixel1.y]);if(j9[j7+1]&&j9[j7+1].clip){j2.push([])}}else{j2[j2.length-1].push([j9[j7].pixel0.x,j9[j7].pixel0.y]);if(j7===j9.length-1){j2[j2.length-1].push([j9[j7].pixel1.x,j9[j7].pixel1.y])}}}return j2},_getDisplayPixelsGL:function(j2){var T=this.map;var j1=[];if(j2.length===0||!this.isVisible()){return[j1]}if(this.greatCirclePoints.length>0){j2=this.greatCirclePoints}if(!this._config.enableEditing){var j0=this.getParseCacheIndex(T.getZoom());if(this._parseCache[j0]){j2=this._parseCache[j0]}else{var jY=T.config.coordType===2?1:T.config.coordType;var j3=dK(j2,this.getParseTolerance(T.getZoom(),jY));j2=this._parseCache[j0]=j3}}var e=T._polyOverlayBasePoint;j1.push([j2[0].lng-e.lng,j2[0].lat-e.lat]);for(var jX=1,jW=1,jV=j2.length;jX<jV;jX++){var jZ=[j2[jX].lng-e.lng,j2[jX].lat-e.lat];if(jZ[0]!==j1[jW-1][0]||jZ[1]!==j1[jW-1][1]){j1.push(jZ);jW++}}j1=[j1];this._addMultipleDrawPath(j1);return j1},_addMultipleDrawPath:function(T,jX,i){if(this._config.clip===true){return}var jW=this.map;jX=jX||jW.getZoom();if(jX>12&&jW.getRenderType()!=="webgl"){return}var e=i?jW.worldSize(jX):hx.WORLD_SIZE_MC;var jV=T.slice(0);eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x-e,j0.y))}else{jZ.push([j0[0]-e,j0[1]])}});T.push(jZ)});eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x+e,j0.y))}else{jZ.push([j0[0]+e,j0[1]])}});T.push(jZ)})},});eP.extend(cg.prototype,{initialize:function(T){ik.prototype.initialize.call(this,T);var i=this._config;var e={paths:i.path,isBuildingMask:i.isBuildingMask,isPoiMask:i.isPoiMask,isMapMask:i.isMapMask,showRegion:i.showRegion};T.stencil=T.stencil?Object.assign(T.stencil,e):e;return this.domElement},getFillStyleForGL:function(){var e=this._config.fillOpacity;var i=ho.formatColorCssToRgbaArray(this._config.fillColor,e);this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(jY){var j2=[];var j0=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[j0]){return this._areaCacheGL[j0]}var j1=this._getDisplayPixelsGL(this.points);if(j1.pointsArray&&j1.pointsArray.length<3){this._areaCacheGL[j0]=[[],j2];return this._areaCacheGL[j0]}var jW;var jX=[];var jV=0;for(var T=0;T<j1.length;T++){if(T>0){jV+=j1[T-1].length}jW=jY(j1[T].pointsArray,null,null,jV);for(var e=0,jZ=jW.length;e<jZ;e+=3){j2.push(jW[e],jW[e+1],jW[e+2])}jX=jX.concat(j1[T].pointsArray)}var j3=[new Float32Array(jX),new Uint16Array(j2)];this._areaCacheGL[j0]=j3;return j3}});eP.extend(ee.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);if(this._config.geodesic===true){this.calcGreatCirclePoints(iU.convertMC2LL(this.points[0][0]),iU.convertMC2LL(this.points[0][1]))}this._calcBounds()},_getDisplayPixels:function(e,jY,jV){var jX=this.map;var T=[];var i=this;var jW=e.slice(0);if(this.greatCirclePoints.length>0){jW[0]=this.greatCirclePoints}eP.each(jW,function(j0,jZ){var j1=i._getEachDisplayPixels(j0,jZ,jY,jV);eP.each(j1,function(j2){T.push(j2)})});this._addMultipleDrawPath(T,jY,true);return T},_addMultipleDrawPath:function(T,jX,i){if(this._config.clip===true){return}var jW=this.map;jX=jX||jW.getZoom();if(jX>12&&jW.getRenderType()!=="webgl"){return}var e=i?jW.worldSize(jX):hx.WORLD_SIZE_MC;var jV=T.slice(0);eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x-e,j0.y))}else{jZ.push([j0[0]-e,j0[1]])}});T.push(jZ)});eP.each(jV,function(jY){var jZ=[];eP.each(jY,function(j0){if(j0.x){jZ.push(new fa(j0.x+e,j0.y))}else{jZ.push([j0[0]+e,j0[1]])}});T.push(jZ)})},_getDisplayPixelsGL:function(e){var T=[];var i=this;var jV=e.slice(0);if(this.greatCirclePoints.length>0){jV[0]=this.greatCirclePoints}eP.each(jV,function(jX,jW){var jY=i._getEachDisplayPixelsGL(jX,jW);eP.each(jY,function(jZ){T.push(jZ)})});this._addMultipleDrawPath(T);return T},_getEachDisplayPixels:function(j5,jZ,jY,j2){var e=this.map;var j4=[];if(j5.length===0||!this.domElement||!this.isVisible()){return[j4]}j5=this._simplification(j5,jZ);var j3;var j1=e.pointToOverlayPixelIn(j5[0],{zoom:jY,center:j2});j4.push(j1);if(j1.onBack){j3=true}for(var jX=1,jV=1,T=j5.length;jX<T;jX++){var j0=e.pointToOverlayPixelIn(j5[jX],{zoom:jY,center:j2});if(j0.onBack){j3=true}if(!j0.equals(j4[jV-1])){j4.push(j0);jV++}}if(e.getZoom()<5||this._config.clip===false){return[j4]}var jW=this._clipLine(j4);jW.isOnBack=j3;return jW},_simplification:function(jV,T){if(this._config.enableEditing){return jV}var jX=this.map;var jW=this.getParseCacheIndex(jX.getZoom());if(this._parseCache[jW]&&this._parseCache[jW][T]){return this._parseCache[jW][T]}else{var i=jX.config.coordType===2?1:jX.config.coordType;var e=dK(jV,this.getParseTolerance(jX.getZoom(),i));if(!this._parseCache[jW]){this._parseCache[jW]=[]}this._parseCache[jW][T]=e;return e}},_clipLine:function(jV){var e=this.map;var j1=[];var j4=Math.round(e.offsetX);var j3=Math.round(e.offsetY);var j5=e.config.drawMargin;var jX={minX:-j4-j5,minY:-j3-j5,maxX:-j4+j5+e.width,maxY:-j3+j5+e.height};for(var jY=0,T=jV.length-1;jY<T;jY++){var j0=jV[jY];var jZ=jV[jY+1];var j2=bp(j0,jZ,jX);if(j2){j1.push(j2)}}var jW=[[]];for(var jY=0,T=j1.length;jY<T;jY++){if(j1[jY].clip){jW[jW.length-1].push(j1[jY].pixel0);jW[jW.length-1].push(j1[jY].pixel1);if(j1[jY+1]&&j1[jY+1].clip){jW.push([])}}else{jW[jW.length-1].push(j1[jY].pixel0);if(jY===j1.length-1){jW[jW.length-1].push(j1[jY].pixel1)}}}return jW},_getEachDisplayPixelsGL:function(j1,jY){var T=this.map;var j0=[];if(j1.length===0||!this.isVisible()){return[j0]}j1=this._simplification(j1,jY);if(this._config.clip===true){return this._clipLineGL(j1,jY)}var e=T._polyOverlayBasePoint;j0.push([j1[0].lng-e.lng,j1[0].lat-e.lat]);for(var jX=1,jW=1,jV=j1.length;jX<jV;jX++){var jZ=[j1[jX].lng-e.lng,j1[jX].lat-e.lat];if(jZ[0]!==j0[jW-1][0]||jZ[1]!==j0[jW-1][1]){j0.push(jZ);jW++}}return[j0]},_clipLineGL:function(j5,jY){var ka=this.map;var jX=this.getParseCacheIndex(ka.getZoom());var kb=ka._polyOverlayBasePoint;var jW=[];if(this._parseCacheGLRaw[jX]&&this._parseCacheGLRaw[jX][jY]){jW=this._parseCacheGLRaw[jX][jY]}else{var kc=new fa(j5[0].lng-kb.lng,j5[0].lat-kb.lat);jW.push(kc);for(var j6=1,j3=1,j2=j5.length;j6<j2;j6++){var jV=new fa(j5[j6].lng-kb.lng,j5[j6].lat-kb.lat);if(!jV.equals(jW[j3-1])){jW.push(jV);j3++}}if(!this._parseCacheGLRaw[jX]){this._parseCacheGLRaw[jX]=[]}this._parseCacheGLRaw[jX][jY]=jW}var e=ka.getZoomUnits();var j9=ka.pixelToPointIn(new fa(0,ka.height));var j8=[];var j0=ka.config.drawMarginGL;var jZ={minX:Math.round(-j0*e+(j9.lng-kb.lng)),minY:Math.round(-j0*e+(j9.lat-kb.lat)),maxX:Math.round((j0+ka.width)*e+(j9.lng-kb.lng)),maxY:Math.round((j0+ka.height)*e+(j9.lat-kb.lat))};for(j6=0,j2=jW.length-1;j6<j2;j6++){var j7=jW[j6];var j4=jW[j6+1];var T=bp(j7,j4,jZ);if(T){j8.push(T)}}var j1=[[]];for(j6=0,j2=j8.length;j6<j2;j6++){if(j8[j6].clip){j1[j1.length-1].push([j8[j6].pixel0.x,j8[j6].pixel0.y]);j1[j1.length-1].push([j8[j6].pixel1.x,j8[j6].pixel1.y]);if(j8[j6+1]&&j8[j6+1].clip){j1.push([])}}else{j1[j1.length-1].push([j8[j6].pixel0.x,j8[j6].pixel0.y]);if(j6===j8.length-1){j1[j1.length-1].push([j8[j6].pixel1.x,j8[j6].pixel1.y])}}}return j1},getParsedPoints:function(){var jY=this.map;var i=this.points;var e=[];var T=this;var jX=i.slice(0);if(this.greatCirclePoints.length>0){jX[0]=this.greatCirclePoints}eP.each(jX,function(j1){var j0=jY.config.coordType===2?1:jY.config.coordType;var jZ=dK(j1,T.getParseTolerance(jY.getZoom(),j0));e.push(jZ)});var jW=0;if(this._bounds.sw.lng<-hx.WORLD_SIZE_MC_HALF){jW=hx.WORLD_SIZE_MC}if(this._bounds.ne.lng>hx.WORLD_SIZE_MC_HALF){jW=-hx.WORLD_SIZE_MC}if(jW===0){return e}var jV=e.slice(0);eP.each(jV,function(jZ){var j0=[];eP.each(jZ,function(j1){j0.push(new cu(j1.lng+jW,j1.lat))});e.push(j0)});console.log(e);return e},setPointAt:function(T,e,jV){jV=jV||0;if(!e||!this.points[jV][T]||!this.points[jV][T]){return}this._clearCache();this.points[jV][T]=new cu(e.lng,e.lat);if(this._config.geodesic===true){this.calcGreatCirclePoints(iU.convertMC2LL(this.points[jV][0]),iU.convertMC2LL(this.points[jV][1]))}this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},calcGreatCirclePoints:function(jV,T){if(jV.equals(T)){return}var e=iU.getDistance(im(jV.lng),im(jV.lat),im(T.lng),im(T.lat));if(e<250000){return}this.greatCirclePoints.length=0;var jZ=Math.round(e/150000);var j3=this.calcAngularDistance(jV,T);this.greatCirclePoints.push(this.points[0][0]);var j2=jV.lng;var j1=this.points[0][0];for(var jW=0;jW<jZ;jW++){var jY=this.calcMiddlePoint(jV,T,jW/jZ,j3);var j0=iU.convertLL2MC(jY);var jX=j0.lng;var j4=el(j0,j1);if(j4>30037726){if(j0.lng<j1.lng){j0.lng+=hx.WORLD_SIZE_MC}else{j0.lng-=hx.WORLD_SIZE_MC}}this.greatCirclePoints.push(j0);j1=j0}this.greatCirclePoints.push(this.points[0][1]);var j4=el(this.points[0][1],j1);if(j4>30037726){if(this.points[0][1].lng<j1.lng){this.points[0][1].lng+=hx.WORLD_SIZE_MC}else{this.points[0][1].lng-=hx.WORLD_SIZE_MC}}},calcMiddlePoint:function(j2,j1,j3,j7){var jW=j2.lat;var jV=j1.lat;var j6=j2.lng;var j4=j1.lng;var j8=im(jW);var j5=im(jV);var i=im(j6);var e=im(j4);var ka=Math.sin((1-j3)*j7)/Math.sin(j7);var j9=Math.sin(j3*j7)/Math.sin(j7);var jZ=ka*Math.cos(j8)*Math.cos(i)+j9*Math.cos(j5)*Math.cos(e);var jY=ka*Math.cos(j8)*Math.sin(i)+j9*Math.cos(j5)*Math.sin(e);var jX=ka*Math.sin(j8)+j9*Math.sin(j5);var T=Math.atan2(jX,Math.sqrt(Math.pow(jZ,2)+Math.pow(jY,2)));var j0=Math.atan2(jY,jZ);return new cu(e1(j0),e1(T))},calcAngularDistance:function(jW,i){var jX=im(jW.lat);var jV=im(i.lat);var T=im(jW.lng);var e=im(i.lng);return Math.acos(Math.sin(jX)*Math.sin(jV)+Math.cos(jX)*Math.cos(jV)*Math.cos(Math.abs(e-T)))}});eP.extend(g4.prototype,{initialize:function(i){ik.prototype.initialize.call(this,i);var e=this._config;this.setOptions({strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,fillColor:e.fillColor,strokeOpacity:e.strokeOpacity,fillOpacity:e.fillOpacity});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new cu(e.lng,e.lat);this.points[T]=new cu(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new cu(e.lng,e.lat)}this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=iU.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},_onMarkerDragging:function(j2){this._editstate=true;var jV=j2.currentTarget;var j4=j2.point;var j3=jV.index;var i=this.vertexPoints;var j6;var jZ=i[2].p;var j5=i[i.length-2].p;var j0=null;var T=null;var j1=null;var jY=null;if(j3===0){j1=i[j3+2].p;j6=[j5,j4,j1];if(!jV.t){j0=new cu((j5.lng+j4.lng)/2,(j5.lat+j4.lat)/2);T=new cu((j1.lng+j4.lng)/2,(j1.lat+j4.lat)/2)}}else{if(j3===i.length-1){jY=i[j3-2].p;j6=[jY,j4,jZ];if(!jV.t){j0=new cu((jY.lng+j4.lng)/2,(jY.lat+j4.lat)/2);T=new cu((jZ.lng+j4.lng)/2,(jZ.lat+j4.lat)/2)}}else{jY=i[j3-1].p;j1=i[j3+1].p;j6=[jY,j4,j1];if(!jV.t){jY=i[j3-2].p;j1=i[j3+2].p;j6=[jY,j4,j1];j0=new cu((jY.lng+j4.lng)/2,(jY.lat+j4.lat)/2);T=new cu((j1.lng+j4.lng)/2,(j1.lat+j4.lat)/2);if(this.vertexMarkers[j3-1]){this.vertexMarkers[j3-1].hide()}if(this.vertexMarkers[j3+1]){this.vertexMarkers[j3+1].hide()}}}}if(!this._temp.dashedLine){var jX=new fK(j6,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(jX);this._temp.dashedLine=jX}else{this._temp.dashedLine.setPoints(j6)}if(this._config.nodeT&&this._config.nodeT instanceof jd){var jW=this._config.nodeT}else{var jW=new jd(B.imgPath+"nodeT.gif",new iL(11,11),{offset:new iL(5,5)})}if(!this._temp.preTNode&&j0){this._temp.preTNode=new jz(j0,{icon:jW,delFlag:true});this.map.addOverlay(this._temp.preTNode)}else{if(j0){this._temp.preTNode.setPoint(j0)}}if(!this._temp.nexTNode&&T){this._temp.nexTNode=new jz(T,{icon:jW,delFlag:true});this.map.addOverlay(this._temp.nexTNode)}else{if(T){this._temp.nexTNode.setPoint(T)}}},getFillStyleForGL:function(){var e=this._config.fillOpacity;var i;i=ho.formatColorCssToRgbaArray(this._config.fillColor,e);this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(jY){var j2=[];var j0=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[j0]){return this._areaCacheGL[j0]}var j1=this._getDisplayPixelsGL(this.points);if(j1.pointsArray&&j1.pointsArray.length<3){this._areaCacheGL[j0]=[[],j2];return this._areaCacheGL[j0]}var jW;var jX=[];var jV=0;for(var T=0;T<j1.length;T++){if(T>0){jV+=j1[T-1].length}jW=jY(j1[T].pointsArray,null,null,jV);for(var e=0,jZ=jW.length;e<jZ;e+=3){j2.push(jW[e],jW[e+1],jW[e+2])}jX=jX.concat(j1[T].pointsArray)}var j3=[new Float32Array(jX),new Uint16Array(j2)];this._areaCacheGL[j0]=j3;return j3}});eP.extend(gL.prototype,{initialize:function(e){g4.prototype.initialize.call(this,e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return this.domElement},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=fL.getDrawer(this.map);this.domElement=e.addStandardCircle()},draw:function(i){if(!this.domElement){return}i=i||{};var T=this.getDisplayGeometry(i.center,i.zoom);if(this._drawer){this._drawer.setStandardCircleGeometry(this.domElement,T)}},getDisplayGeometry:function(e,i){var T=this.map.pointToOverlayPixelIn(this.point,{zoom:i,center:e});var jW=Math.round(this._radiusMercator/this.map.getZoomUnits(i));var jV={cx:T.x,cy:T.y,radius:jW};return jV},setPoint:function(e,T){if(!e){return}this._clearCache();if(!T){this.vertexPoints=null}this.point=e;this.latLng=iU.convertMC2LL(e);this.points=this._getPerimeterPoints(e,this.radius);this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setRadius:function(e,T){this._clearCache();if(!T){this.vertexPoints=null}this.radius=Math.abs(e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getParseTolerance:function(i,e){if(e===2){e=1}if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return gL.parseTolerance[e][this.getParseCacheIndex(i)]},_onMarkerDragging:function(jY){var jW;var j0;var j1;var i=this.map;this._editstate=true;var jV=jY.currentTarget;var jZ=jV.index;var T=this.vertexPoints;var jX=T[0].p;var j2=T[T.length-1].p;if(jZ==0){j0=jV.point;j1=j2}else{j0=jX;j1=jV.point}jW=iU.getDistanceByMC(j0,j1);this.setRadius(jW,true);this.setCenterIn(j0,true)},_onMarkerDragend:function(jW){this._editstate=false;var jV=jW.currentTarget;var T=jV.index;this.vertexPoints[0]={p:this.point,t:0};if(T==1){this.vertexPoints[1]={p:jV.point,t:0}}this.clearVertexs();this.addVertexs();var i=new fA("oneditend");i.pixel=jW.pixel;i.point=jW.point;i.latLng=jW.latLng;i.overlay=this;this.dispatchEvent(i)},getVertexPoints:function(){if(!this.vertexPoints){var e=[];e.push({p:this.point,t:0});e.push({p:this.points[Math.floor(this.points.length*3/4)],t:0});this.vertexPoints=e}return this.vertexPoints}});eP.extend(jK.prototype,{initialize:function(i){ik.prototype.initialize.call(this,i);var e=this._config;this.setOptions({topFillColor:e.topFillColor,topFillOpacity:e.topFillOpacity,sideFillColor:e.sideFillColor,sideFillOpacity:e.sideFillOpacity,altitude:e.altitude});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new cu(e.lng,e.lat);this.points[T]=new cu(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new cu(e.lng,e.lat)}this._calcBounds();this.draw();var i=new fA("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getFillStyleForGL:function(){var T=this._config.topFillOpacity;var i=this._config.sideFillOpacity;var e;var jV;e=ho.formatColorCssToRgbaArray(this._config.topFillColor,T,false);jV=ho.formatColorCssToRgbaArray(this._config.sideFillColor,i,false);return{top:e,side:jV}},buildFillVertex:function(jX,kh){var jW=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[jW]&&!kh){return this._areaCacheGL[jW]}var kk=this._getDisplayPixelsGL(this.points);if(kk.pointsArray&&kk.pointsArray.length<3){this._areaCacheGL[jW]={vertex:[],index:[]};return this._areaCacheGL[jW]}var kf=this.getFillStyleForGL();var j8=kf.top;var kc=kf.side;var j1=this._config.altitude;var ko=[0,0,1];var j3=[];var T=[];var ke=0;for(var ki=0;ki<kk.length;ki++){if(ki>0){ke+=(kk[ki-1].length-1)*5}var kb=kk[ki].pointsArray;kb.splice(-2,2);var kp=this.getClockwise(kb);if(kp){kb=this.rev(kb)}for(var kl=0;kl<kb.length;kl+=2){j3.push([kb[kl],kb[kl+1],j1,ko[0],ko[1],ko[2],j8[0],j8[1],j8[2],j8[3]])}var e=jX(kb,null,null,ke);for(var kl=0,j6=e.length;kl<j6;kl+=3){T.push(e[kl],e[kl+1],e[kl+2])}for(var kl=0,kd=kb.length;kl<kd;kl+=2){var j2=kb[kl];var j0=kb[kl+1];var ka=[j2,j0,0];var j9=[j2,j0,j1];var jV=kl+2;var jZ=kl+3;if(kl===kd-2){jV=0;jZ=1}var kn=kb[jV];var km=kb[jZ];var j7=[kn,km,0];var j5=[kn,km,j1];var kj=[j7[0]-ka[0],j7[1]-ka[1],j7[2]-ka[2]];var kg=[j9[0]-ka[0],j9[1]-ka[1],j9[2]-ka[2]];var ko=[];vec3.cross(ko,kj,kg);ka.push(ko[0],ko[1],ko[2]);j9.push(ko[0],ko[1],ko[2]);j7.push(ko[0],ko[1],ko[2]);j5.push(ko[0],ko[1],ko[2]);ka.push(kc[0],kc[1],kc[2],kc[3]);j9.push(kc[0],kc[1],kc[2],kc[3]);j7.push(kc[0],kc[1],kc[2],kc[3]);j5.push(kc[0],kc[1],kc[2],kc[3]);var jY=j3.length;j3.push(ka);j3.push(j9);j3.push(j7);j3.push(j5);T.push(jY,jY+2,jY+3,jY,jY+3,jY+1)}}var j4={vertex:this.convertBuilding3dToTypedArray(j3),index:new Uint16Array(T)};this._areaCacheGL[jW]=j4;return j4},getClockwise:function(j1){var jX=j1.length;if(jX<6){return false}var jV=j1[jX-2];var j0=j1[jX-1];var T=j1[0];var jZ=j1[1];var e=j1[2];var jY=j1[3];for(var jW=2;jW<jX;jW+=2){if(j1[jW]>T){jV=j1[jW-2];j0=j1[jW-1];T=j1[jW];jZ=j1[jW+1];if(jW+2>=jX){e=j1[0];jY=j1[1]}else{e=j1[jW+2];jY=j1[jW+3]}}}return((T-jV)*(jY-jZ)-(jZ-j0)*(e-T)<0)},rev:function(jV){var e=[];for(var T=jV.length-1;T>=0;T-=2){e[jV.length-1-T]=jV[T-1];e[jV.length-1-T+1]=jV[T]}return e},convertBuilding3dToTypedArray:function(jY){var T=jY.length;var jV=new Float32Array(T*7);var jX=new DataView(jV.buffer);var e=0;for(var jW=0;jW<jY.length;jW++){e=jW*7;jV[e+0]=jY[jW][0];jV[e+1]=jY[jW][1];jV[e+2]=jY[jW][2];jV[e+3]=jY[jW][3];jV[e+4]=jY[jW][4];jV[e+5]=jY[jW][5];jX.setUint8(e*4+24,jY[jW][6]);jX.setUint8(e*4+25,jY[jW][7]);jX.setUint8(e*4+26,jY[jW][8]);jX.setUint8(e*4+27,jY[jW][9])}return jV}});eP.extend(bW.prototype,{initialize:function(e){ik.prototype.initialize.call(this,e);return this.domElement},getFillStyleForGL:function(){if(!this._config.url){return}switch(this._config.type){case"image":var e={type:"image",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"video":var e={type:"video",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"canvas":var e={type:"canvas",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break}return this._fillStyleInfoForGL},buildFillVertex:function(jY){var j1=[];var j0=this._getDisplayPixelsGL(this.points);var jW;var jX=[];var jV=0;for(var T=0;T<j0.length;T++){if(T>0){jV+=j0[T-1].length}jW=jY(j0[T].pointsArray,null,null,jV);for(var e=0,jZ=jW.length;e<jZ;e+=3){j1.push(jW[e],jW[e+1],jW[e+2])}jX=jX.concat(j0[T].pointsArray)}var j2=[new Float32Array(jX),new Uint16Array(j1)];return j2},buildFillMaskVertex:function(){var j0=[0,0,1,0,1,1,0,1];var j1=this._getDisplayPixelsGL(this.points);var T=this._config.maskCoord;if(this.hasMaskPng&&T&&T.length===2){var e=[];for(var jZ=0;jZ<T.length;jZ++){e[jZ]=iU.convertLL2MC(T[jZ])}var j4=this._toOverlayPixelsGL(e);this.maskOverlayPixels=j4;var jY=j4[1][0]-j4[0][0];var jW=j4[1][1]-j4[0][1];var j3=(j1[0][0][0]-j4[0][0])/jY;var j2=(j1[0][0][1]-j4[0][1])/jW;var jX=(j1[0][2][0]-j4[0][0])/jY;var jV=(j1[0][2][1]-j4[0][1])/jW;j0=[j3,j2,jX,j2,jX,jV,j3,jV]}else{this.maskOverlayPixels=[j1[0][0],j1[0][2]]}return j0}});function P(e){this._map=e;this._canvasAttrName={strokeweight:"lineWidth",strokecolor:"strokeStyle",fillcolor:"fillStyle",strokeopacity:"globalAlpha",fillopacity:"globalAlpha"};this._type="canvas"}P.prototype=new eU();var cO=P.prototype;cO.addLine=function(){var i=bV("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};cO.setPath=function(T,i){if(!T){return}var e=T.getContext("2d");this._setCanvasPosition(T);this._clearCanvas(e);var jW=parseInt(T.style.top);var jV=parseInt(T.style.left);e.beginPath();eP.each(i,function(jZ){if(jZ.length===0){return}e.moveTo(jZ[0].x-jV,jZ[0].y-jW);for(var jY=1,jX=jZ.length;jY<jX;jY++){e.lineTo(jZ[jY].x-jV,jZ[jY].y-jW)}});this._drawCanvas(T)};cO.setAttribute=function(jV,i,jW){if(!jV){return}var e=jV.getContext("2d");var T=this._getAttributeName(i);if(T){e[T]=jW}jV.setAttribute("_"+i,jW||"");e.save();this._clearCanvas(e);this._drawCanvas(jV)};cO._getAttributeName=function(e){return this._canvasAttrName[e]||e};cO._setCanvasPosition=function(jW){var i=this._map;var j1=i.config.drawMargin;var T=i.width+2*j1;var jY=i.height+2*j1;var jV=-i.offsetX-j1;var jX=-i.offsetY-j1;var j0=jW.getContext("2d");var jZ={strokeStyle:j0.strokeStyle,fillStyle:j0.fillStyle,globalAlpha:j0.globalAlpha,lineWidth:j0.lineWidth,lineCap:"round",lineJoin:"round"};jW.setAttribute("width",T);jW.setAttribute("height",jY);for(var e in jZ){j0[e]=jZ[e]}j0.save();var j2=jW.style;j2.top=jX+"px";j2.left=jV+"px"};cO._clearCanvas=function(e){e.clearRect(0,0,9999,9999)};cO._drawCanvas=function(i){var e=i.getContext("2d");e.globalAlpha=i.getAttribute("_fillopacity");if(e.globalAlpha!=0&&i.getAttribute("_fillcolor")){e.fill()}e.globalAlpha=i.getAttribute("_strokeopacity");if(e.globalAlpha!==0&&i.getAttribute("_strokecolor")){e.stroke()}};cO.addStandardCircle=function(){var i=bV("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};cO.setStandardCircleGeometry=function(jV,jY){if(!jV){return}var T=jV.getContext("2d");this._setCanvasPosition(jV);this._clearCanvas(T);var jX=parseInt(jV.style.top);var jW=parseInt(jV.style.left);var i=jY.cx-jW;var jZ=jY.cy-jX;var e=jY.radius;T.beginPath();T.arc(i,jZ,e,0,Math.PI*2);this._drawCanvas(jV)};function eU(){}DrawerPrototype=eU.prototype;DrawerPrototype.setPalette=function(){};DrawerPrototype.addLine=function(){throw"addLineæ¥å£æ²¡æå®ç°"};DrawerPrototype.setAttribute=function(){throw"setAttributeæ¥å£æ²¡æå®ç°"};DrawerPrototype.setPath=function(){throw"setPathæ¥å£æ²¡æå®ç°"};DrawerPrototype.getType=function(){return this._type};var fL={getDrawer:function(e){if(e._renderType==="webgl"){return null}if(!fL["_"+e.hashCode]){fL["_"+e.hashCode]={}}switch(e.config.drawer){case BMAP_SVG_DRAWER:return fL.getSvgDrawer(e);case BMAP_VML_DRAWER:return fL.getVmlDrawer(e);case BMAP_CANVAS_DRAWER:return fL.getCanvasDrawer(e);default:break}if(fL.isSupportSvg()){return fL.getSvgDrawer(e)}if(fL.isSupportVml()){return fL.getVmlDrawer(e)}if(fL.isSupportCanvas()){return fL.getCanvasDrawer(e)}},getSvgDrawer:function(e){if(!fL["_"+e.hashCode]._svgDrawer){fL["_"+e.hashCode]._svgDrawer=new eD(e)}return fL["_"+e.hashCode]._svgDrawer},getVmlDrawer:function(e){if(!fL["_"+e.hashCode]._vmlDrawer){fL["_"+e.hashCode]._vmlDrawer=new al(e)}return fL["_"+e.hashCode]._vmlDrawer},getCanvasDrawer:function(e){if(!fL["_"+e.hashCode]._canvasDrawer){fL["_"+e.hashCode]._canvasDrawer=new P(e)}return fL["_"+e.hashCode]._canvasDrawer},isSupportVml:function(){if(typeof fL.supportVml!="undefined"){return fL.supportVml}var T=document.body.appendChild(bV("div"));T.innerHTML=\'<v:shape id="vml_tester1" adj="1" />\';var i=T.firstChild;if(!i.style){return false}i.style.behavior="url(#default#VML)";var e=i?typeof i.adj=="object":true;T.parentNode.removeChild(T);fL.supportVml=e;return e},isSupportSvg:function(){if(typeof fL.supportSvg=="undefined"){fL.supportSvg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return fL.supportSvg},isSupportCanvas:function(){if(typeof fL.supportCanvas=="undefined"){fL.supportCanvas=!!bV("canvas").getContext}return fL.supportCanvas}};bw.DrawerSelector=fL;function eD(e){this._map=e;this.SVG_NS="http://www.w3.org/2000/svg";this._svgAttrName={strokeweight:"stroke-width",strokecolor:"stroke",fillcolor:"fill",strokeopacity:"stroke-opacity",fillopacity:"fill-opacity",strokestyle:"stroke-dasharray",strokelinecap:"stroke-linecap",strokelinejoin:"stroke-linejoin"};this._svg=this._createSvg();this._type="svg"}eD.prototype=new eU();var cs=eD.prototype;cs._createSvg=function(){var e=this._svg=bV("svg",{},this.SVG_NS);e.setAttribute("version","1.1");e.setAttribute("type","system");var i=e.style;i.position="absolute";i.MozUserSelect="none";this.setPalette();this._map.getPanes().mapPane.appendChild(e);return e};cs.setPalette=function(){if(!this._svg){return}var T=this._svg;var jZ=this._map;var i=jZ.config.drawMargin;var jW=jZ.width+2*i;var e=jZ.height+2*i;var jY=-jZ.offsetX-i;var jX=-jZ.offsetY-i;this.setAttribute(T,"x",jW+"px");this.setAttribute(T,"y",e+"px");this.setAttribute(T,"viewBox",jY+" "+jX+" "+jW+" "+e);var jV=T.style;jV.top=jX+"px";jV.left=jY+"px";jV.width=jW+"px";jV.height=e+"px"};cs.getPalette=function(){return this._svg};cs.setAttribute=function(jW,T,jX,jV,i){if(!jW){return}if(T==="strokestyle"){i=i||{};var jV=i.strokeWeight||4;var e=i.dashArray||null;switch(jX){case"dashed":if(e){jX=e.join(",")}else{jX=jV*2}break;case"dotted":if(i.strokeLineCap==="round"){jX="1,"+2*jV}else{jX=jV}break;default:jX=0;break}}var jY=jX||"none";if(jX===0){jY=0}jW.setAttributeNS(null,this._getAttributeName(T),jY);return jW};cs._getAttributeName=function(e){return this._svgAttrName[e]||e};cs.addLine=function(){var e=bV("path",{},this.SVG_NS);this.setAttribute(e,"fill-rule","evenodd");this._svg.appendChild(e);return e};cs.setPath=function(T,e){var i=this._getPathString(e)||"M -9999,-9999";this.setAttribute(T,"d",i)};cs._getPathString=function(e){if(e.length===0){return""}var i=[];eP.each(e,function(jW){if(jW.length<2){return}i.push("M "+jW[0].x+" "+jW[0].y+" L");for(var jV=1,T=jW.length;jV<T;jV++){i.push(jW[jV].x);i.push(jW[jV].y)}});return i.join(" ")};cs.addStandardCircle=function(){var e=bV("circle",{},this.SVG_NS);this._svg.appendChild(e);return e};cs.setStandardCircleGeometry=function(T,jV){var i=jV.cx;var jW=jV.cy;var e=jV.radius;this.setAttribute(T,"cx",i);this.setAttribute(T,"cy",jW);this.setAttribute(T,"r",e)};function al(e){this._map=e;this._vmlAttrName={strokeweight:"weight",strokecolor:"color",fillcolor:"color",strokeopacity:"opacity",fillopacity:"opacity",strokestyle:"dashstyle"};this._type="vml"}al.prototype=new eU();var dE=al.prototype;dE.setAttribute=function(T,e,jV){if(T){if(e.indexOf("stroke")==0){T=T.getElementsByTagName("stroke")[0]}else{if(e.indexOf("fill")==0){T=T.getElementsByTagName("fill")[0]}}if(e.indexOf("color")>0){if(!jV){T.on=false}else{T.on=true}}if(e=="strokestyle"){switch(jV){case"dashed":jV="4 2 1 2";break;case"dotted":jV="1 1";break;default:jV="solid";break}}if(e=="strokeweight"){jV=jV+"px"}var i=this._getAttributeName(e);T[i]=jV||""}};dE._getAttributeName=function(e){return this._vmlAttrName[e]||e};dE.addLine=function(){var e=[\'<v:shape style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;"\',\'coordsize="1,1" coordorigin="0,0" filled="t" fillcolor="white">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:shape>"].join("");return bI(this._map.getPanes().mapPane,e)};dE.setPath=function(i,e){this.setAttribute(i,"path",this._getPathString(e));if(eP.Browser.ie==6){i.style.display="none";i.style.display=""}};dE._getPathString=function(e){if(e.length==0){return""}var i=[];eP.each(e,function(jW){if(jW.length<2){return}i.push("m "+jW[0].x+" "+jW[0].y+" l");for(var jV=1,T=jW.length;jV<T;jV++){i.push(jW[jV].x);i.push(jW[jV].y)}i.push("e")});return i.join(" ")||" "};dE.addStandardCircle=function(){var e=[\'<v:oval style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:oval>"].join("");return bI(this._map.getPanes().mapPane,e)};dE.setStandardCircleGeometry=function(T,jV){var i=jV.cx;var jW=jV.cy;var e=jV.radius;T.style.left=(i-e)+"px";T.style.top=(jW-e)+"px";T.style.width=(e*2)+"px";T.style.height=(e*2)+"px";if(eP.Browser.ie===6){T.style.display="none";T.style.display=""}};');
