/**/ï»¿_jsload&&_jsload('menu', 'eP.extend(g9.prototype,{initialize:function(e,jW){if(this._container){return false}this._map=e;var jY=this._overlay=jW===true?false:(jW||null);this._render();var j2=this;this._container.style.cursor=e.config.defaultCursor;if(jY&&jY._config.clickable){this._container.style.cursor="pointer"}eP.on(document,"mousedown",function(i){if(!j2._container){return}j2.hide()});eP.on(this._container,"mousemove",ah);eP.on(this._container,"click",function(i){j2.hide();ah(i)});var j1=this._opts.container;if(!j1&&!jY&&jY!==false){j1=this._map.container;e.addEventListener("onspotmouseover",function(i){j2.spots=i.spots});var T;e.addEventListener("onspotmouseout",function(i){T=i.spots;delete j2.spots});e.addEventListener("onspotclick",function(i){j2.spots=i.spots});e.addEventListener("rightclickex",function(j8){if(this.getMapType()===BMAP_EARTH_MAP){return}if(!j2._container||j8.infoWindow||!j2._enable){return}if(e.currentOperation!==d6.idle){return}if(!j2.spots&&T&&T.length>0){var ka=j8.pixel;var j9=T[0];var j7=j9.pt;var i=this.pointToPixelIn(j7);var j6=j9.bd;if(ka.x-i.x<j6[2]&&ka.x-i.x>j6[0]&&i.y-ka.y<j6[3]&&i.y-ka.y>j6[1]){j2.spots=T}}j2._showMenu(j8,j1);delete j2.spots});e.addEventListener("forcedown",function(j8){if(this.getMapType()===BMAP_EARTH_MAP){return}if(!j2._container||j8.infoWindow||!j2._enable){return}if(!j2.spots&&T&&T.length>0){var ka=j8.pixel;var j9=T[0];var j7=j9.pt;var i=this.pointToPixelIn(j7);var j6=j9.bd;if(ka.x-i.x<j6[2]&&ka.x-i.x>j6[0]&&i.y-ka.y<j6[3]&&i.y-ka.y>j6[1]){j2.spots=T}}j2._showMenu(j8,j1);delete j2.spots})}else{if(this._overlay){j1=this._map.container;this._overlay.addEventListener("rightclick",function(i){if(!j2._container){return}j2.showOverlayMenu(i,j2._overlay)})}else{if(this._overlay!==false){eP.on(j1,"contextmenu",function(j6){if(e.getMapType()===BMAP_EARTH_MAP){return}if(e.currentOperation!==d6.idle){return}if(!j2._container||!j2._enable){return}j6=window.event||j6;var i=j6.target||j6.srcElement;while(i&&!eP.hc(i,"pop")){i=i.parentNode}if(i&&eP.hc(i,"pop")){j2.hide();return}j2._showMenu(j6,j1,true);return c(j6)})}}}var j4=[];for(var jZ=this._items.length-1;jZ>=0;jZ--){var j5=this._items[jZ];if(j5._insertIndex!==-1){j4=j4.concat(this._items.splice(jZ,1))}}for(var jZ=0,jV=this._items.length;jZ<jV;jZ++){var j5=this._items[jZ];if(j5._type==="menuitem"){j5.initialize(e,this)}if(j5._type==="divider"){this._dividers[j5._dIndex].dom=bI(this._container,"<div class=\'BMap_cmDivider\'></div>")}}for(var jZ=j4.length-1;jZ>=0;jZ--){var j5=j4[jZ];if(j5._type==="menuitem"){j5.initialize(e,this)}if(j5._type==="divider"){for(var jX=0,j3=this._items.length;jX<j3;jX++){if(jX===j5._insertIndex){var j0=this._items[jX]._container||this._dividers[this._items[jX]._dIndex].dom;this._dividers[j5._dIndex].dom=fD(j0,"<div class=\'BMap_cmDivider\'></div>");break}}}}for(var jZ=j4.length-1;jZ>=0;jZ--){var j5=j4[jZ];this._items.splice(j5._insertIndex,0,j5)}this._updateShadowSize()},_draw:function(){if(this._map){this.initialize(this._map,this._overlay);if(this._isOpen){this._isOpen=false;this.show()}}},remove:function(){if(this._container){this._container.parentNode.removeChild(this._container);this._container=null}this._map=null},_render:function(){this._container=bI(this._map.container,"<div unselectable=\'on\'></div>");this._container.className="BMap_contextMenu";this._container.style.fontSize="12px";return this._container},addItem:function(jW,e){if(!jW||jW._type!="menuitem"||jW._text==""||jW._width<=0){return}for(var jV=0,T=this._items.length;jV<T;jV++){if(this._items[jV]===jW){return}}if(e===undefined||e>this._items.length-1){e=-1}jW._insertIndex=e;jW.initialize(this._map,this);if(e===-1){this._items.push(jW);this._rItems.push(jW)}else{this._items.splice(e,0,jW);this._rItems.splice(e,0,jW)}eP.ac(jW.getDom(),"BMap_cmLstItem");if(this._items.length>1){this._items[this._items.length-2]._type=="menuitem"&&eP.rc(this._items[this._items.length-2].getDom(),"BMap_cmLstItem")}else{this._items[0]._type=="menuitem"&&eP.ac(this._items[0].getDom(),"BMap_cmFstItem")}this._updateShadowSize()},removeItem:function(jV){if(!jV||jV._type!="menuitem"){return}for(var T=0,e=this._items.length;T<e;T++){if(this._items[T]===jV){this._items[T].remove();this._items.splice(T,1);delete jV._insertIndex;e--}}for(var T=0,e=this._rItems.length;T<e;T++){if(this._rItems[T]===jV){this._rItems[T].remove();this._rItems.splice(T,1);delete jV._insertIndex;e--}}if(!this._container){return}if(this._items.length>0){this._items[this._items.length-1]._type=="menuitem"&&eP.ac(this._items[this._items.length-1].getDom(),"BMap_cmLstItem")}this._updateShadowSize()},addSeparator:function(e){if(e===undefined||e>this._items.length-1){e=-1}var jZ={_type:"divider",_dIndex:this._dividers.length,_insertIndex:e};this._dividers.push({dom:null});if(!this._container){return}var jY="<div class=\'BMap_cmDivider\'></div>";if(e===-1){this._dividers[this._dividers.length-1].dom=bI(this._container,jY)}else{var jW=this._items;for(var jX=0,jV=jW.length;jX<jV;jX++){if(jX===e){var T=jW[jX]._container||this._dividers[jW[jX]._dIndex].dom;this._dividers[this._dividers.length-1].dom=fD(T,jY);break}}}if(e===-1){this._items.push(jZ)}else{this._items.splice(e,0,jZ)}this._updateShadowSize()},removeSeparator:function(T){if(!this._dividers[T]){return}if(this._dividers[T].dom&&this._dividers[T].dom.parentNode){this._dividers[T].dom.parentNode.removeChild(this._dividers[T].dom)}for(var jV=0,e=this._items.length;jV<e;jV++){if(this._items[jV]&&this._items[jV]._type=="divider"&&this._items[jV]._dIndex==T){this._items.splice(jV,1);e--}if(this._items[jV]&&this._items[jV]._type=="divider"&&this._items[jV]._dIndex>T){this._items[jV]._dIndex--}}this._dividers.splice(T,1);this._updateShadowSize()},setPosition:function(e,i){this._left=e;this._top=i;this._container.style.left=e+"px";this._container.style.top=i+"px"},show:function(){if(this._isOpen==true){return}if(this._rItems.length==0){return}this._isOpen=true;if(this._container){this._container.style.visibility="visible"}var e=new fA("onopen");e.point=this.curPoint;e.pixel=this.curPixel;this.dispatchEvent(e)},hide:function(){if(this._isOpen==false){return}this._isOpen=false;if(this._container){this._container.style.visibility="hidden"}var e=new fA("onclose");e.point=this.curPoint;e.pixel=this.curPixel;this.dispatchEvent(e)},setCursor:function(e){if(!e){return}this._opts.cursor=e;if(this._container){this._container.style.cursor=this._opts.cursor}},_updateShadowSize:function(){if(this._container){this._container.offsetWidth+"px";this._container.offsetHeight+"px"}},_showMenu:function(jX,j0,jZ){if(this._rItems.length==0){return}if(!this._opts.marker&&jX.overlay&&jX.overlay instanceof jz){return}var j1=this;var j3=jX.layerX||jX.offsetX;var j2=jX.layerY||jX.offsetY;var j5=jX.target||jX.srcElement;if(jZ){var jY=j5;if(j0==j1._map.container&&jY!==j1._map.maskLayer&&jY.nodeName.toLowerCase()!="svg"){while(jY&&!eP.hc(jY,"shadow")){jY=jY.parentNode}if(!eP.hc(jY,"shadow")||jY.getAttribute("type")!="infowindow_shadow"){j1.hide();return}}while(j5&&j5!=j1._map.container){if(!(j5.clientWidth==0&&j5.clientHeight==0&&j5.offsetParent&&j5.offsetParent.nodeName.toLowerCase()=="td")){if(j5.nodeName.toLowerCase()=="svg"){j3+=parseInt(j5.getAttribute("viewBox").split(" ")[0])||0;j2+=parseInt(j5.getAttribute("viewBox").split(" ")[1])||0}else{j3+=j5.offsetLeft;j2+=j5.offsetTop}}j5=j5.offsetParent||j5.parentNode}j1.curPixel=new fa(j3,j2)}else{j1.curPixel=jX.pixel}if(this.spots&&this.spots.length>0){var jW=this.spots[0];var j6=jW.userdata.iconPoint;j1.curPoint=j6;j1.curPixel=j1._map.pointToPixelIn(j6)}else{if(jX.overlay&&jX.overlay instanceof jz){j1.curPoint=jX.overlay.getPoint();j1.curPixel=j1._map.pointToPixelIn(j1.curPoint)}else{j1.curPoint=j1._map.pixelToPointIn(j1.curPixel)}}if(j1.curPoint.lng<ec[j1._map.mapType].bounds[0]||j1.curPoint.lng>ec[j1._map.mapType].bounds[2]||j1.curPoint.lat<ec[j1._map.mapType].bounds[1]||j1.curPoint.lat>ec[j1._map.mapType].bounds[3]){return}var jV=j1.getDom().offsetHeight;var j4=j1.getDom().offsetWidth;var T=jX.offsetX;var i=jX.offsetY;if(jZ){T=j3;i=j2}if(jX.offsetX+j4>this._map.width){T-=j4}if(jX.offsetY+jV>this._map.height){i-=jV}j1.setPosition(T,i);j1.show()},showOverlayMenu:function(jZ,T,j0){if(this._rItems.length==0||!this._map){return}var jW=this;if(T){jW.tempOverlay=T}jW.curPixel=jZ.pixel;if(T instanceof s){jW.curPixel=jW._map.pointToPixel(T.getPosition());jZ.pixel=jW.curPixel;if(j0){j0.x&&(jZ.pixel.x+=j0.x);j0.y&&(jZ.pixel.y+=j0.y)}}jW.curPoint=jW._map.pixelToPointIn(jW.curPixel);var jV=jW.getDom().offsetHeight;var i=jW.getDom().offsetWidth;var jY=jZ.pixel.x;var jX=jZ.pixel.y;if(jZ.pixel.x+i>this._map.width){jY=jZ.pixel.x-i}if(jZ.pixel.y+jV>this._map.height){jX=jZ.pixel.y-jV}jW.setPosition(jY,jX);jW.show()}});eP.extend(hJ.prototype,{initialize:function(e,i){if(this._container){return false}this._map=e;this._contextmenu=i;if(i.getDom()){this._render();this._bind();if(!this._enabled){this._enabled=true;this.disable()}}return true},remove:function(){var e=this;if(this._container){this._container.parentNode.removeChild(this._container);this._container=null}this._contextmenu=null;this._map=null},_draw:function(){if(this._contextmenu&&this._map){this.initialize(this._map,this._contextmenu)}},_render:function(){var jX="<div"+(this._opts.id?" id=\'"+this._opts.id+"\'":"")+" unselectable=\'on\'><span>"+this._text+"</span></div>";var j1=this._insertIndex;var jW=this._contextmenu.getDom();var jY=this._contextmenu._items;var T=this._contextmenu._dividers;if(j1===-1){this._container=bI(jW,jX)}else{for(var jV=0,e=jY.length;jV<e;jV++){if(jV===j1){var jZ=jY[jV]._container||T[jY[jV]._dIndex].dom;this._container=fD(jZ,jX);break}}}jW.style.borderRadius="4px";var j0=this._container.style;j0.padding="8px 8px";j0.MozUserSelect="none";j0.lineHeight="22px";j0.width=this._opts.width+"px";if(this._enabled){j0.color="#656565";j0.cursor="pointer"}else{j0.color="#aaa";j0.cursor=this._map.config.defaultCursor}return this._container},_bind:function(){var e=this;eP.on(this._container,"click",function(i){if(!e._enabled){ah(i);return}if(e._callback&&e._callback.call){var T=iU.convertMC2LL(e._contextmenu.curPoint);e._callback.call(e,T,e._contextmenu.curPixel,e._contextmenu._overlay||e._contextmenu.tempOverlay)}});eP.on(this._container,"mousedown",function(i){ah(i)});eP.on(this._container,"mouseover",function(){if(!e._enabled){return}e._container.style.color="#3385ff";e._container.style.backgroundColor="#F0F8FF"});eP.on(this._container,"mouseout",function(){if(!e._enabled){return}e._container.style.color="#656565";e._container.style.backgroundColor="#fff"})},setText:function(e){if(!e){return}this._text=e+"";if(this._container){this._container.innerHTML="<span>"+this._text+"</span>"}},enable:function(){this._enabled=true;if(this._container){this._container.style.color="#656565";this._container.style.cursor="pointer"}},disable:function(){this._enabled=false;if(this._container){this._container.style.color="#aaa";this._container.style.cursor=this._map.config.defaultCursor}}});');