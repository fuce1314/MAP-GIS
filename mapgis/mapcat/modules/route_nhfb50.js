/**/﻿_jsload&&_jsload('route', 'function eA(e,jW,i){c2.call(this);if(!e){return}this.container=(typeof(e)=="object")?e:eP.G(e);this.page=1;this.pageCount=100;this.argName="pg";this.pagecap=4;this.callback=jW;this.update=true;var T={page:1,totalCount:100,pageCount:100,pagecap:4,argName:"pg",update:true};if(!i){i=T}for(var jV in i){if(typeof(i[jV])!="undefined"){this[jV]=i[jV]}}this.render()}eP.extend(eA.prototype,{render:function(){this.initialize()},initialize:function(){this.checkPages();this.container.innerHTML=this.createHtml()},checkPages:function(){if(isNaN(parseInt(this.page))){this.page=1}if(isNaN(parseInt(this.pageCount))){this.pageCount=1}if(this.page<1){this.page=1}if(this.pageCount<1){this.pageCount=1}if(this.page>this.pageCount){this.page=this.pageCount}this.page=parseInt(this.page);this.pageCount=parseInt(this.pageCount)},getPage:function(){var i=location.search;var T=new RegExp("[?&]?"+this.argName+"=([^&]*)[&$]?","gi");var e=i.match(T);this.page=RegExp.$1},createHtml:function(){var j1=[];var jV=this.page-1;var jY=this.page+1;j1.push(\'<p style="margin:0;padding:0;white-space:nowrap">\');if(jV<1){}else{if(this.page>=this.pagecap){var T=\'<span style="margin-right:3px"><a style="color:#7777cc" href="javascript:void(0)" onclick="{temp1}">首页</a></span>\';j1.push(T.replace("{temp1}","BMapGL.I(\'"+this.hashCode+"\').toPage(1);"))}var T=\'<span style="margin-right:3px"><a style="color:#7777cc" href="javascript:void(0)" onclick="{temp2}">上一页</a></span>\';j1.push(T.replace("{temp2}","BMapGL.I(\'"+this.hashCode+"\').toPage("+jV+");"))}if(this.page<this.pagecap){if(this.page%this.pagecap==0){var jW=this.page-this.pagecap-1}else{var jW=this.page-this.page%this.pagecap+1}var jZ=jW+this.pagecap-1}else{var j0=Math.floor(this.pagecap/2);var jX=this.pagecap%2-1;if(this.pageCount>this.page+j0){var jZ=this.page+j0;var jW=this.page-j0-jX}else{var jZ=this.pageCount;var jW=this.page-j0-jX}}if(this.page>this.pageCount-this.pagecap&&this.page>=this.pagecap){var jW=this.pageCount-this.pagecap+1;var jZ=this.pageCount}for(var e=jW;e<=jZ;e++){if(e>0){if(e==this.page){j1.push(\'<span style="margin-right:3px">\'+e+"</span>")}else{if(e>=1&&e<=this.pageCount){var T=\'<span><a style="color:#7777cc;margin-right:3px" href="javascript:void(0)" onclick="{temp3}">[\'+e+"]</a></span>";j1.push(T.replace("{temp3}","BMapGL.I(\'"+this.hashCode+"\').toPage("+e+");"))}}}}if(jY>this.pageCount){}else{var T=\'<span><a style="color:#7777cc" href="javascript:void(0)" onclick="{temp4}">下一页</a></span>\';j1.push(T.replace("{temp4}","BMapGL.I(\'"+this.hashCode+"\').toPage("+jY+");"))}j1.push("</p>");return j1.join("")},toPage:function(i){var e=i?i:1;if(typeof(this.callback)=="function"){this.callback(e);this.page=e}if(this.update){this.render()}}});function db(e){this["city"]=e.city;this._start=e.start;this._end=e.end;this._plans=e.plans;this["moreResultsUrl"]=e.url;this["taxiFare"]=e.taxiFare||null;this._startStatus=e.startStatus||BMAP_ROUTE_STATUS_NORMAL;this._endStatus=e.endStatus||BMAP_ROUTE_STATUS_NORMAL}eP.extend(db.prototype,{getStart:function(){return this._start},getEnd:function(){return this._end},getStartStatus:function(){return this._startStatus},getEndStatus:function(){return this._endStatus},getNumPlans:function(){return this._plans.length},getPlan:function(e){if(this._plans[e]){return this._plans[e]}}});function hI(e){db.call(this,e);this["policy"]=e.policy}eP.inherit(hI,db,"DrivingRouteResult");function r(e){db.call(this,e)}eP.inherit(r,db,"WalkingRouteResult");function fb(e){db.call(this,e)}eP.inherit(fb,db,"RidingRouteResult");function dt(e){db.call(this,e);this["policy"]=e.policy;this["transitType"]=e.transitType;this["intercityPolicy"]=e.intercityPolicy;this["transitTypePolicy"]=e.transitTypePolicy}eP.inherit(dt,db,"TransitRouteResult");eP.extend(dt.prototype,{getTransitType:function(){return this["transitType"]}});function gu(e){this._routes=e.routes.slice(0);this._distance=e.distance||0;this._duration=e.duration||0;this._dragPois=e.dragPois||[]}eP.extend(gu.prototype,{getRoute:function(e){if(this._routes[e]){return this._routes[e]}},getNumRoutes:function(){return this._routes.length},getDistance:function(e){if(e===false){return this._distance}else{return iw(this._distance)}},getDuration:function(e){if(e===false){return this._duration}else{return aE(this._duration,"nav")}},getDragPois:function(){return this._dragPois}});function ev(e){gu.call(this,e);this._lines=e.lines;this._description=e.description;this._duration=e.duration||0;this._totalType=e.totalType||[];this._total=e.total||[]}eP.inherit(ev,gu,"TransitRoutePlan");eP.extend(ev.prototype,{getNumLines:function(){return this._lines.length},getLine:function(e){if(this._lines[e]){return this._lines[e]}},getDescription:function(e){if(e===false){return bF.removeHtml(this._description)}else{return this._description}},getDuration:function(e){if(e===false){return this._duration}else{return aE(this._duration,"bustime")}},getLinesTitle:function(){var jV="";var e=this._lines.length-1;for(var T=0;T<e;T++){if(this._lines[T]&&this._lines[T]["title"]){jV+=this._lines[T]["title"]+" → "}}jV+=this._lines[e]["title"];return jV},getBusName:function(e){return e.substring(0,e.indexOf("("))},getWalkDistance:function(){var T=0;var e=this._routes.length;for(var jV=0;jV<e;jV++){T+=this._routes[jV].getDistance(false)}return iw(T)},getNumTotal:function(){return this._totalType.length},getTotalType:function(e){return this._totalType[e]},getTotal:function(e){return this._total[e]}});function dy(e){this._steps=e.steps&&e.steps.slice(0)||[];this._distance=e.distance||0;this._index=e.index||0;this._points=e.points.slice(0);this._planIndex=e.planIndex||0;this._rt=e.rt;if(this._distance===0&&this._points.length>2){this._points.length=2}}eP.extend(dy.prototype,{getNumSteps:function(){return this._steps.length},getStep:function(e){if(this._steps[e]){return this._steps[e]}},getDistance:function(e){if(e===false){return this._distance}else{return iw(this._distance)}},getIndex:function(){return this._index},getPolyline:function(){return this._polyline},getPath:function(){return this._points},getRouteType:function(){return this._rt},getPlanIndex:function(){return this._planIndex}});function jF(e){this["title"]=e.title;this.uid=e.uid;this["type"]=e.type;this._stops=e.stops.slice(0);this._points=e.points.slice(0);this._distance=e.distance||0;this._numViaStops=e.numViaStops||0;this._status=e.status||{}}eP.extend(jF.prototype,{getNumViaStops:function(){return this._numViaStops},getGetOnStop:function(){return this._stops[0]},getGetOffStop:function(){return this._stops[1]},getPath:function(){return this._points},getPolyline:function(){return this._polyline},getDistance:function(e){if(e===false){return this._distance}else{return iw(this._distance)}},getTitle:function(){return this["title"]}});function dG(e){this._path=e.path;this._point=e.point;this._index=e.index;this._description=e.description;this._distance=e.distance||0;this._routeIndex=e.routeIndex||0;this._planIndex=e.planIndex||0}eP.extend(dG.prototype,{getPosition:function(){return this._point},getIndex:function(){return this._index},getDescription:function(e){if(e===false){return bF.removeHtml(this._description)}else{return this._description}},getDistance:function(e){if(e===false){return this._distance}else{return iw(this._distance)}},getRouteIndex:function(){return this._routeIndex},getPlanIndex:function(){return this._planIndex}});ju._genTitle=function(jW,jY,jV){var i="-21px";var e="";if(jV===0){e+=";border-top:1px solid #e4e6e7";i="5px"}var jX="nav-ed";if(jV===0){jX="nav-st"}var T=["<div style=\'"+e+"\'><div style=\'cursor:pointer;padding:8px 0 8px 10px;line-height:15px\'"];T.push("onclick=\'"+jY+"\'>");T.push("<span class=\'navtrans-navlist-icon "+jX+"\'></span>");T.push("<div style=\'overflow:hidden;line-height:20px;\'>"+jW);T.push("</div></div></div>");return T.join("")};ju._genResultTitle=function(T,i,e){return\'<h1 style="margin:0;border-top:1px solid #e4e6e7;\'+(e?"border-bottom:1px solid #e4e6e7;padding:10px 0 10px 7px;":"padding:10px 0 9px 7px;")+"font:bold 16px "+B.fontFamily+\'"> \'+i+"前往 "+T+" 的路线</h1>"};eP.extend(ju.prototype,{search:function(i,e){if(!i||!e){this.clearResults();this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE);return false}return true},clearResults:function(){delete this._results;delete this._ud;delete this._json;delete this._boundsPoints;delete this._segPolylinePoints;var e=this._opts.renderOptions;this._setStatus();if(e.panel){e.panel.innerHTML=""}if(e.map){e.map.closeInfoWindow()}this._clearOverlays();this._curIndex=-1},_formatDestQuery:function(i,T){var e;T=T||{};if(typeof i==="string"){e=[2,"","",i,0,""]}else{if(i instanceof cu||i instanceof co){var jV=iU.convertLL2MC(i);e=[1,"",jV.lng+","+jV.lat,(T.wd||""),0,""]}else{var jV=iU.convertLL2MC(i.point);e=[1,""+i.uid,jV.lng+","+jV.lat,i.title,0,""]}}return e.join("$$")+"$$"},_formatDestQuery30:function(i,T){var e;T=T||{};if(typeof i==="string"){e=i}else{if(i instanceof cu||i instanceof co){e=i.lat.toFixed(6)+","+i.lng.toFixed(6)}else{var jV=i.point;e=jV.lat.toFixed(6)+","+jV.lng.toFixed(6)}}return e},_formatDestUri:function(T,i){var e;if(typeof T==="string"){e=T}else{if(T instanceof cu||T instanceof co){var jV=T;e=jV.lat+","+jV.lng}else{var jV=T.point;e=jV.lat+","+jV.lng}}if(typeof T!=="string"&&i&&i!==""&&typeof(i)==="string"){e="name:"+i+"|latlng:"+e}return e},getTPointQueryParam:function(e){var jV="";var T="1";var i=this._formatDestQuery(e);return i+jV+"$$"+T+"$$"},_getUriByOptions:function(i){var e;i=i||{};if(typeof dest==="string"){e=dest}else{if(dest instanceof cu||dest instanceof co){var T=dest;e=T.lat+","+T.lng}else{var T=dest.point;e=T.lat+","+T.lng}}return e}});var dj=0;var hG=1;function iw(e){if(typeof e==="string"){e=parseFloat(e)}var i;if(!e||e<0){i="0米"}else{if(e<=10){i="10米"}else{i=e<1000?Math.round(e/10)*10+"米":(e/1000).toFixed(1)+"公里"}}if(i==="1000米"){i="1.0公里"}return i}function aE(j0,jV){if(j0===0){j0=1}if(!j0||isNaN(j0)){return""}var e="";var i=60;var jW=i*24;var T=Math.ceil(j0/i);if(jV==="bustime"){var jZ=T%10;var jX=parseInt(T/10,10);T=jZ!==0?(jZ>5?(++jX*10):jX?(jX*10):5):T}var j1=parseInt(T/jW,10);T%=jW;var jY=parseInt(T/i,10);T%=i;if(j1>=1){e+=j1+"天"}if(jY>=1){e+=jY+"小时"}if(T>=1){if(jV&&jV==="nav"&&j1>=1){return e}else{e+=T+"分钟"}}return e}function am(e){var T=e.getSouthWest();var i=e.getNorthEast();return[T,i]}eP.extend(eE.prototype,{_asyncSearch:function(){for(var T=0,e=this._queryList.length;T<e;T++){var jW=this._queryList[T];this[jW.method].apply(this,jW.arguments)}delete this._queryList;var jV=this;if(this._opts.renderOptions.map){this._opts.renderOptions.map.addEventListener("onpoiselected",function(i){jV.preciseSearch(i)})}},_internalSearch:function(jV,e){var i=this;function T(jY){var jW=jY.split("$$");var jX=jW[0];var jZ=null;if(/[0-2]/.test(jX)&&jW.length===7){jZ=jW[+jX+1]}return jZ}this._getIdByLoc(this._loc,function(jZ){var jX={qt:i.QUERY_TYPE,c:jZ,sn:jV,en:e,sy:i._opts.policy||0,ext:1};if(jX.sy===BMAP_TRANSIT_POLICY_AVOID_SUBWAYS){jX.f="[0,2,4,7,5,8,9,10,11]"}var jY=T(jV);var jW=T(e);jE.request(function(j1,j0){i._rawDataCbk(j1,j0)},jX,{start:jY,end:jW})})},search:function(T,e){if(ju.prototype.search.call(this,T,e)===true){var i=this;this._getIdByLoc(this._loc,function(jX){if(!jX){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE);return}if(typeof e==="string"||typeof T==="string"){i._setStatus(BMAP_STATUS_INVALID_REQUEST);i._triggerCbk(aG.CBK_SEARCH_COMPLETE);return}else{var jW;jW={output:"json",qt:jC,};jW.origin=i._formatDestQuery30(T);jW.destination=i._formatDestQuery30(e);jW.mode="transit";jW.tactics_incity=i._opts.policy||0;jW.trans_type_intercity=i._opts.transitTypePolicy||0;jW.tactics_intercity=i._opts.intercityPolicy||0}var jV={start:T,end:e,_from:"search",policy:jW.tactics_incity,intercityPolicy:jW.tactics_intercity,transitTypePolicy:jW.trans_type_intercity};jE.request(function(jZ,jY){i._rawDataCbk(jZ,jY)},jW,jV)})}},preciseSearch:function(jV){if(jV.sType!==this.QUERY_TYPE){return}var jW=jV.paramInfo;jW.qt=this.QUERY_TYPE;var T=this;jW.sy=T._opts.policy||0;var i={start:jW.sq,end:jW.eq,_from:"preciseSearch"};if(this._opts._enableTraffic){i.reqURL=B.mapHost+"mobile/webapp/interface/wiseBus/";i.enableTraffic=true}jE.request(function(jX,e){T._rawDataCbk(jX,i)},jW,i)},_rawDataCbk:function(i,e){var jW=this._opts.renderOptions.map;this.clearResults();this._json=i;var jV=i.result;var jX=i.content;this._ud=e;if(jV.error!==0){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{})}else{if(jX.status!==0){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{})}else{if(jX.type===cy){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{})}else{if(jX.type===h4){var T=jX.result;if(T.routes===null||T.routes.length===0){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{});return}if(T.origin["city_id"]===T.destination["city_id"]||T.origin["city_name"]===T.destination["city_name"]){this._json.content["transitType"]=BMAP_TRANSIT_TYPE_IN_CITY;this._processRawInCity()}else{this._json.content["transitType"]=BMAP_TRANSIT_TYPE_CROSS_CITY;this._processRawCrossCity()}this._renderList();this["_selectPlan"](0);return}}}}return},_getRouteStatus:function(T,i){var e=BMAP_ROUTE_STATUS_NORMAL;if(i===0){if(T>0){e=BMAP_ROUTE_STATUS_ADDRESS}else{e=BMAP_ROUTE_STATUS_EMPTY}}return e},_processRawInCity:function(){var kn=this;var kk=this._json.content;var kd=kk.result;var j2={};var j0={};if(typeof this._ud.start==="object"&&!(this._ud.start instanceof cu||this._ud.start instanceof co)){eP.extend(j2,this._ud.start)}else{j2.title="起点";j2.city=kd.origin["city_name"];j2.point=new cu(kd.origin["location"]["lng"],kd.origin["location"]["lat"])}if(typeof this._ud.end==="object"&&!(this._ud.end instanceof cu||this._ud.end instanceof co)){eP.extend(j0,this._ud.end)}else{j0.title="终点";j0.city=kd.destination["city_name"];j0.point=new cu(kd.destination["location"]["lng"],kd.destination["location"]["lat"])}var j6=kk.result["routes"];var kj=[];var kb=0;this._boundsPoints=[];for(var kg=0;kg<j6.length;kg++){if(kb>this._opts.pageCapacity-1){break}this._boundsPoints[kb]=[];var ki="<table class=\'trans-plan-content\'>";var j4=j6[kg];var j1=j4.distance;var e=j4.duration;var jV="";var kh=j4.steps;var j7=0;var ke=0;var km=[];var j5=[];var j3=[];var jW=[];for(var kf=0;kf<kh.length;kf++){var kc=kh[kf][0];var jY=[];jY.push(new cu(kc.start_location["lng"],kc.start_location["lat"]));jY=jY.concat(bF.pathToPoints(kc.path));jY.push(new cu(kc.end_location["lng"],kc.end_location["lat"]));if(kc.vehicle_info["type"]===aU){var kl=new dy({distance:kc.distance,points:jY,rt:BMAP_ROUTE_TYPE_WALKING,index:j7,planIndex:kg});j7++;km.push(kl);j3.push(kl);var jZ="";if(kf===kh.length-1){jZ=j0.title}else{jZ=kh[kf+1][0]["vehicle_info"]["detail"]["on_station"]}ki+="<tr><td><span class=\'navtrans-bus-icon walk\'></span><div class=\'navtrans-bus-desc\'>步行约"+iw(kc.distance)+"，到达<span class=\'navtrans-busstation\'>"+jZ+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_ROUTE)}else{if(kc.vehicle_info["type"]===h5){var j8=kc.vehicle_info["detail"];var j9={title:j8.on_station,point:new cu(kc.start_location["lng"],kc.start_location["lat"])};var jX={title:j8.off_station,point:new cu(kc.end_location["lng"],kc.end_location["lat"])};var ka=new jF({title:j8.name,distance:kc.distance,points:jY,stops:[j9,jX],type:this._getLineType(j8.type,false),numViaStops:j8.stop_num});j5.push(ka);j3.push(ka);ki+="<tr><td><span class=\'navtrans-bus-icon bus\'></span><div class=\'navtrans-bus-desc\'>乘坐<span class=\'navtrans-busstation\'>"+j8.name+"</span>，经过"+j8.stop_num+"站，到达<span class=\'navtrans-busstation\'>"+jX.title+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_LINE)}}}ki+="</table>";var T=new ev({routes:km,lines:j5,total:j3,distance:j1,duration:e,description:ki,totalType:jW});kj.push(T);kb++}this._results=new dt({plans:kj,start:j2,end:j0,url:"",transitType:this._json.content["transitType"],intercityPolicy:this._ud.intercityPolicy,transitTypePolicy:this._ud.transitTypePolicy,policy:this._ud.policy});this._setStatus(BMAP_STATUS_SUCCESS);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,this._results);return},_processRawCrossCity:function(){var kp=this;var km=this._json.content;var ke=km.result;var j2={};var j0={};if(typeof this._ud.start==="object"&&!(this._ud.start instanceof cu||this._ud.start instanceof co)){eP.extend(j2,this._ud.start)}else{j2.title="起点";j2.city=ke.origin["city_name"];j2.point=new cu(ke.origin["location"]["lng"],ke.origin["location"]["lat"])}if(typeof this._ud.end==="object"&&!(this._ud.end instanceof cu||this._ud.end instanceof co)){eP.extend(j0,this._ud.end)}else{j0.title="终点";j0.city=ke.destination["city_name"];j0.point=new cu(ke.destination["location"]["lng"],ke.destination["location"]["lat"])}var j7=km.result["routes"];var kl=[];var kc=0;this._boundsPoints=[];for(var ki=0;ki<j7.length;ki++){if(kc>this._opts.pageCapacity-1){break}this._boundsPoints[kc]=[];var kk="<table class=\'trans-plan-content\'>";var j4=j7[ki];var j1=j4.distance;var e=j4.duration;var jV="";var kj=j4.steps;var j8=0;var kg=0;var ko=[];var j5=[];var j3=[];var jW=[];for(var kh=0;kh<kj.length;kh++){for(var kf=0;kf<kj[kh].length;kf++){var kd=kj[kh][kf];var jY=[];jY.push(new cu(kd.start_location["lng"],kd.start_location["lat"]));jY=jY.concat(bF.pathToPoints(kd.path));jY.push(new cu(kd.end_location["lng"],kd.end_location["lat"]));if(kd.vehicle_info["type"]===aU){var kn=new dy({distance:kd.distance,points:jY,rt:BMAP_ROUTE_TYPE_WALKING,index:j8,planIndex:ki});j8++;ko.push(kn);j3.push(kn);var jZ="";if(kh===kj.length-1&&kf===kj[kh].length-1){jZ=j0.title}else{if(kh<kj.length-1&&kf===kj[kh].length-1){var j6=kj[kh+1][0]["vehicle_info"];switch(j6.type){case h5:jZ=j6.detail["on_station"];break;case af:case h3:case cL:jZ=j6.detail["departure_station"];break}}else{if(kf<kj[kh].length-1){var j6=kj[kh][kf+1]["vehicle_info"];switch(j6.type){case h5:jZ=j6.detail["on_station"];break;case af:case h3:case cL:jZ=j6.detail["departure_station"];break}}}}kk+="<tr><td><span class=\'navtrans-bus-icon walk\'></span><div class=\'navtrans-bus-desc\'>步行约"+iw(kd.distance)+"，到达<span class=\'navtrans-busstation\'>"+jZ+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_ROUTE)}else{if(kd.vehicle_info["type"]===h5){var j9=kd.vehicle_info["detail"];var ka={title:j9.on_station,point:new cu(kd.start_location["lng"],kd.start_location["lat"])};var jX={title:j9.off_station,point:new cu(kd.end_location["lng"],kd.end_location["lat"])};var kb=new jF({title:j9.name,distance:kd.distance,points:jY,stops:[ka,jX],type:this._getLineType(j9.type),numViaStops:j9.stop_num});j5.push(kb);j3.push(kb);kk+="<tr><td><span class=\'navtrans-bus-icon bus\'></span><div class=\'navtrans-bus-desc\'>乘坐<span class=\'navtrans-busstation\'>"+j9.name+"</span>，经过"+j9.stop_num+"站，到达<span class=\'navtrans-busstation\'>"+jX.title+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_LINE)}else{if(kd.vehicle_info["type"]===af){var j9=kd.vehicle_info["detail"];var ka={title:j9.departure_station,point:new cu(kd.start_location["lng"],kd.start_location["lat"])};var jX={title:j9.arrive_station,point:new cu(kd.end_location["lng"],kd.end_location["lat"])};var kb=new jF({title:j9.name,distance:kd.distance,points:jY,stops:[ka,jX],type:this._getLineType(kd.vehicle_info["type"],true)});j5.push(kb);j3.push(kb);kk+="<tr><td><span class=\'navtrans-cross-city-icon train\'></span><div class=\'navtrans-bus-desc\'>乘坐<span class=\'navtrans-busstation\'>"+j9.name+"</span>到达<span class=\'navtrans-busstation\'>"+jX.title+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_LINE)}else{if(kd.vehicle_info["type"]===h3){var j9=kd.vehicle_info["detail"];var ka={title:j9.departure_station,point:new cu(kd.start_location["lng"],kd.start_location["lat"])};var jX={title:j9.arrive_station,point:new cu(kd.end_location["lng"],kd.end_location["lat"])};var kb=new jF({title:j9.name,distance:kd.distance,points:jY,stops:[ka,jX],type:this._getLineType(kd.vehicle_info["type"],true)});j5.push(kb);j3.push(kb);kk+="<tr><td><span class=\'navtrans-cross-city-icon airplane\'></span><div class=\'navtrans-bus-desc\'>乘坐<span class=\'navtrans-busstation\'>"+j9.name+"</span>到达<span class=\'navtrans-busstation\'>"+jX.title+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_LINE)}else{if(kd.vehicle_info["type"]===cL){var j9=kd.vehicle_info["detail"];var ka={title:j9.departure_station,point:new cu(kd.start_location["lng"],kd.start_location["lat"])};var jX={title:j9.arrive_station,point:new cu(kd.end_location["lng"],kd.end_location["lat"])};var kb=new jF({title:j9.name,distance:kd.distance,points:jY,stops:[ka,jX],type:this._getLineType(kd.vehicle_info["type"],true)});j5.push(kb);j3.push(kb);kk+="<tr><td><span class=\'navtrans-bus-icon bus\'></span><div class=\'navtrans-bus-desc\'>乘坐<span class=\'navtrans-busstation\'>"+j9.name+"</span>到达<span class=\'navtrans-busstation\'>"+jX.title+"</span></div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_LINE)}else{if(kd.vehicle_info["type"]===d1){var kn=new dy({distance:kd.distance,points:jY,rt:BMAP_ROUTE_TYPE_DRIVING,index:j8,planIndex:ki});j8++;ko.push(kn);j3.push(kn);kk+="<tr><td><span class=\'navtrans-bus-icon drive\'></span><div class=\'navtrans-bus-desc\'>驾车约"+iw(kd.distance)+"</div></td></tr>";jW.push(BMAP_TRANSIT_PLAN_TYPE_ROUTE)}}}}}}}}kk+="</table>";var T=new ev({routes:ko,lines:j5,total:j3,distance:j1,duration:e,description:kk,totalType:jW});kl.push(T);kc++}this._results=new dt({plans:kl,start:j2,end:j0,url:"",transitType:this._json.content["transitType"],policy:this._ud.policy,intercityPolicy:this._ud.intercityPolicy,transitTypePolicy:this._ud.transitTypePolicy});this._setStatus(BMAP_STATUS_SUCCESS);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,this._results);return},_renderPlan:function(jW){var kb=this._opts.renderOptions.map;var e=[];var kd=this;if(!kb){return}var T=this._results.getPlan(jW);if(!T){return}var jV=this._results.getStart();var j9=this._results.getEnd();var j5=fv.addDestPoi(kb,jV.point,jV.title,dj);jV.marker=j5;j5.addEventListener("click",function(){kd._select(0)});this._overlays.push(j5);var j3=fv.addDestPoi(kb,j9.point,j9.title,hG);j9.marker=j3;this._overlays.push(j3);j3.addEventListener("click",function(){kd._selectLast()});var j1=jV.point;var j8=j9.point;this._boundsPoints[jW].push(j1,j8);for(var j7=0,j4=T.getNumTotal(),j6=0;j7<j4;j7++){if(T.getTotalType(j7)===BMAP_TRANSIT_PLAN_TYPE_LINE){var j0=T.getTotal(j7);var j2=fv.addLine(kb,j0.getPath());j0._polyline=j2;this._overlays.push(j2);var jY=j0.getGetOnStop();e.push(jY);var jZ=fv.addTransPoi(kb,jY.point,j0.type,jY.title);jY.marker=jZ;this._overlays.push(jZ);var kc=j0.getGetOffStop();e.push(kc);var jX=fv.addTransPoi(kb,kc.point,j0.type,kc.title);kc.marker=jX;(function(){var i=j6;j6=j6+1;jZ.addEventListener("click",function(){kd._select((i+1)*2-1)});jX.addEventListener("click",function(){kd._select((i+1)*2)})})();this._overlays.push(jX);this._boundsPoints[jW].push(jY.point,kc.point)}else{if(T.getTotalType(j7)===BMAP_TRANSIT_PLAN_TYPE_ROUTE){var ka=T.getTotal(j7);j2=fv.addRoute(kb,ka.getPath(),ka.getRouteType());ka._polyline=j2;this._overlays.push(j2)}}}var kd=this;if(this._opts.renderOptions.autoViewport){kb.setViewport(this._boundsPoints[jW],{margins:[30,30,30,30]})}this._triggerCbk(aG.CBK_POLYLINES_SET,T._lines,T._routes);this._triggerCbk(aG.CBK_MARKERS_SET,[jV,j9],e)},_renderList:function(){if(this._opts.renderOptions.panel&&this._opts.renderOptions.panel.appendChild&&this._results&&this._results.getNumPlans()>0){var T=bV("div",{style:"font:12px "+B.fontFamily+";background:#fff"});var j6=ju._genResultTitle(this._results.getEnd()["title"],"乘公共交通工具");var j0=this._genTitleHtml(this._results.getStart()["title"],\'BMapGL.I("\'+this.hashCode+\'")["_select"](0)\',0);var jW=this._genTitleHtml(this._results.getEnd().title,\'BMapGL.I("\'+this.hashCode+\'")["_selectLast"]()\',1);var j7=["<table style=\'font:12px "+B.fontFamily+";border-collapse:collapse;width:100%;\' cellpadding=\'0\' cellspacing=\'0\' border=\'0\'>"];for(var j3=0,j1=this._results.getNumPlans();j3<j1;j3++){var j5=this._results.getPlan(j3);var jY=j5.getDistance().replace(/(\\d+(?:.\\d+)?)/,"$1 ");var e=j5.getDuration().replace(/(\\d+)/,"$1 ");var jZ=j5.getWalkDistance();bg="";var j4="<p style=\'margin:0px 0px 5px 0px;font-size:14px;color: #36c;\'>"+j5.getLinesTitle()+"</p>";if(this._json.content["transitType"]===BMAP_TRANSIT_TYPE_IN_CITY){jY=jY+"  &nbsp;|&nbsp;  "}else{jY=""}var jV="<p style=\'margin:5px 0px;font-size:12px;\'>"+jY+e+"  &nbsp;|&nbsp; 步行"+jZ+"</p>";var jX="vertical-align:top;";j7.push("<tr class=\'tranroute-plan-list\' style=\\"cursor:pointer"+bg+\'">\');j7.push("<td style=\'"+jX+"line-height:18px\' ><div style=\'margin:3px 0px;border:1px solid #e4e6e7;\'><div class=\'trans-title\' style=\'padding: 5px 10px;\' onclick=\'BMapGL.I(\\""+this.hashCode+\'")._selectPlan(\'+j3+")\'>"+j4+jV+"</div><div class=\'trans_plan_desc\' style=\'padding:0px 8px;margin:0px;display:none;position:relative;\'>"+j0+j5.getDescription()+jW+"</div></div></td>");j7.push("</tr>")}j7.push("</table>");var j2="<div style=\'border-bottom:1px solid #ccc;margin-bottom:10px;color:#7777cc;background:#e5ecf9;overflow:hidden;padding:2px;text-align:right\'>";if(this._results.moreResultsUrl){j2+="<a style=\'color:#7777cc\' href=\'"+this._results.moreResultsUrl+"\' target=\'_blank\'>到百度地图查看&#187;</a>"}j2+="&nbsp;</div>";T.innerHTML=j6+j7.join("")+j2;this._opts.renderOptions.panel.appendChild(T);this._triggerCbk(aG.CBK_RESULTS_HTML_SET,T)}},_select:function(jY,j0){var T=this._opts.renderOptions.map;if(T){j0=j0||window.event;var j3=this._results.getPlan(this._curIndex);if(!j3){return}var j2=this;var j4=j3.getNumLines()*2;if(jY===0||jY===j4+1){var j1=jY===0?this._results.getStart():this._results.getEnd();var jW=fv.createTransInfoWnd({content:"<b>"+j1.title+"</b>",total:j4,curIndex:jY,nextTransCbk:function(e){j2._select(e)}});jW.addEventListener("open",function(){j2._triggerCbk(aG.CBK_INFO_HTML_SET,j1,fv.getInfoWindowDom(T))});var jZ=jY===0?0:1;var j2=this;if(T.config.enableStreetEntrance&&false){PanoramaEntranceUtil.insearchPanoEntranceInInfoWnd(jW,T.getCurrentCity().code,{panoInstance:T._pano,lngLat:j1.point,titleTip:j1.title,type:"busline",beforeDomId:"trans_nav"},function(){j2._overlays[jZ].openInfoWindow(jW)})}else{j2._overlays[jZ].openInfoWindow(jW)}}else{var i=j3.getLine(Math.floor((jY+1)/2)-1);var j5;var jV=i.getTitle();var jX;if(jY%2===1){j5=i.getGetOnStop();jX=jV+"<b>"+j5.title+"上车</b>"}else{j5=i.getGetOffStop();jX=jV+"<b>"+j5.title+"下车</b>"}var jW=fv.createTransInfoWnd({content:jX,total:j4,curIndex:jY,nextTransCbk:function(e){j2._select(e)}});jW.addEventListener("open",function(){j2._triggerCbk(aG.CBK_INFO_HTML_SET,j5,fv.getInfoWindowDom(T))});var j2=this;if(T.config.enableStreetEntrance&&false){PanoramaEntranceUtil.insearchPanoEntranceInInfoWnd(jW,T.getCurrentCity().code,{panoInstance:T._pano,lngLat:j5.point,titleTip:j5.title,type:"busline",beforeDomId:"trans_nav"},function(){j5.marker.openInfoWindow(jW)})}else{j5.marker.openInfoWindow(jW)}}}},_selectLast:function(jV){jV=jV||window.event;if(this._results&&this._curIndex>-1){var T=this._results.getPlan(this._curIndex);if(!T){return}var i=T.getNumLines()*2;this["_select"](i+1)}},_selectPlan:function(jX){if(!this._results&&!this._result.getPlan(jX)){return}var j0=this._results.getPlan(jX);var e=this._opts.renderOptions.map;if(e){e.closeInfoWindow();this._clearOverlays();this._renderPlan(jX)}if(this._opts.renderOptions.panel){var j1=this._opts.renderOptions.panel.getElementsByTagName("table")[0];if(!j1){return}var jY=eP.getElementsByClassName(j1,"tranroute-plan-list");var jZ=eP.getElementsByClassName(j1,"trans_plan_desc");for(var jV=0;jV<jZ.length;jV++){if(jV!==jX){jZ[jV].style.display="none"}}for(var T=0;T<jY.length;T++){eP.removeClassName(jY[T],"expand")}var jW=eP.getElementsByClassName(jY[jX],"trans_plan_desc")[0];if(jW.style.display==="none"){jW.style.display="block";eP.addClassName(jY[jX],"expand")}else{jW.style.display="none"}}this._curIndex=jX},_clearOverlays:function(){for(var e=0;e<this._overlays.length;e++){if(this._overlays[e]&&this._overlays[e]._p){this._overlays[e]._p.remove();this._overlays[e]._p=null}this._overlays[e]&&this._overlays[e].remove();this._overlays[e]=null}this._overlays.length=0},_getLineType:function(i,e){if(!e){return eE.LINE_TYPE_MAPPING[i]}else{return eE.LINE_TYPE_MAPPING_CROSS_CITY[i]}},_genTitleHtml:function(jV,jX,T){var i="";if(T===0){i+="padding-top:5px;"}var jW="nav-ed";if(T===0){jW="nav-st"}var e=["<div style=\'"+i+"\'><div style=\'cursor:pointer;padding:2px 0 2px 0px;line-height:15px\'"];e.push("onclick=\'"+jX+"\'>");e.push("<span class=\'navtrans-navlist-icon "+jW+"\'></span>");e.push("<div style=\'overflow:hidden;line-height:20px;\'>"+jV);e.push("</div></div></div>");return e.join("")}});cB.MAX_THRESHOLD=20;cB.DRAG_REQ_FREQUENCE=50;cB.DRAG_MAXPOINTS=10;eP.extend(cB.prototype,{init_d:function(){this._d={plys:[],viaPts:[],viaPtsInfo:[],dragOverlays:[],tipLbl:null,sliderMkr:null,dragReqFlag:false,cbkDragPt:null,cbkPly:null,isSearchByDrag:false,curDragPly:null,dragSrcCityCode:1,dragEndCityCode:1,cbkStartPoiName:"起点",cbkEndPoiName:"终点",mouseOnViaMkr:false,cxtMenu:[]}},_asyncSearch:function(){this.init_d();for(var T=0,e=this._queryList.length;T<e;T++){var jW=this._queryList[T];this[jW.method].apply(this,jW.arguments)}delete this._queryList;var jV=this;if(this._opts.renderOptions.map){this._opts.renderOptions.map.addEventListener("onpoiselected",function(i){jV.preciseSearch(i)})}},search:function(jV,e,T){this._d.isSearchByDrag=false;var T=T||{};if(ju.prototype.search.call(this,jV,e)===true){var i=this;this._getIdByLoc(this._loc,function(jZ){jZ=jZ||1;var jY;jY={output:"json",qt:jC,};var jW={start:jV,end:e};var jX="";if(i.QUERY_TYPE===hU){jY.origin=i._formatDestQuery30(jV);jY.destination=i._formatDestQuery30(e);jY.region=jZ;jY.mode="walking"}else{if(i.QUERY_TYPE===aN){if(typeof e==="string"||typeof jV==="string"){i._setStatus(BMAP_STATUS_INVALID_REQUEST);i._triggerCbk(aG.CBK_SEARCH_COMPLETE,{});return}else{jY.origin=i._formatDestQuery30(jV);jY.destination=i._formatDestQuery30(e);jY.mode="driving";jY.tactics=i._opts.policy||0;jW.policy=jY.tactics}}else{if(i.QUERY_TYPE===hm){jY.origin=i._formatDestQuery30(jV);jY.destination=i._formatDestQuery30(e);jY.region=jZ;jY.mode="riding"}}}jE.request(function(j1,j0){i._rawDataCbk(j1,j0)},jY,jW,jX)})}},_dragSearch:function(T,e){var i=this;i._d.isSearchByDrag=true;i._getIdByLoc(i._loc,function(jW){jW=jW||1;var j0=iU.convertLL2MC(i._d.viaPts[0]);var jV="1$$$$"+j0.lng+","+j0.lat+"$$$$";var j4=i._d.dragSrcCityCode||jW;var j3="";var jX="";for(var j1=1,jY=i._d.viaPts.length;j1<jY;j1++){var j2=i._d.viaPts[j1];if(j1===jY-1){j3+=i._formatDestQuery(j2);jX+=(i._d.dragEndCityCode||jW)}else{if(j2.if_wp){j3+=i.getTPointQueryParam(j2)+"+to:"}else{j3+=i._formatDestQuery(j2)+"+to:"}jX+="0 +to:"}}var jZ={qt:i.QUERY_TYPE,c:jW,drag:1,sc:j4,ec:jX,sn:jV,en:j3,sy:i._opts.policy||0};if(i._opts._enableTraffic){jZ.route_traffic=1;jZ.version=4;jZ.mrs=0}var j5={start:T,end:e,enableTraffic:i._opts._enableTraffic};eP.extend(j5,{useEncodeURI:true});jE.request(function(j7,j6){i._rawDataCbk(j7,j6)},jZ,j5)})},preciseSearch:function(jV){var T=this;var jW={};jW.qt=jC;if(T.QUERY_TYPE===hU){jW.origin=jV.paramInfo["start_name"];jW.destination=jV.paramInfo["end_name"];jW.region=jV.paramInfo["region"];jW.mode="walking"}if(T.QUERY_TYPE===hm){jW.origin=jV.paramInfo["start_name"];jW.destination=jV.paramInfo["end_name"];jW.region=jV.paramInfo["region"];jW.mode="riding"}var i={start:jW.origin,end:jW.destination};jE.request(function(jX,e){T._rawDataCbk(jX,i)},jW,i)},_rawDataCbk:function(j0,T){this.clearResults();this._json=j0;var e=j0.result;var jX=j0.content;this._ud=T;if(e.error!==0){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{})}else{if(jX.status!==0||(jX.result&&jX.result["routes"]===null)){this._setStatus(BMAP_STATUS_INVALID_REQUEST);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,{})}else{if(jX.type===cy){if(this.QUERY_TYPE===hU||this.QUERY_TYPE===hm){var jV=jX.result;var jW;var jY;jW=this._getRouteStatus30(jV.origin["content"]);jY=this._getRouteStatus30(jV.destination["content"]);if(jW!=BMAP_ROUTE_STATUS_EMPTY&&jY!=BMAP_ROUTE_STATUS_EMPTY&&this._opts.renderOptions.map){var jZ=new g2(j0,{renderOptions:this._opts.renderOptions,sType:this.QUERY_TYPE});var i=bV("div",{style:"font:12px "+B.fontFamily+";background:#fff"});i.innerHTML=jZ.render(T);if(this._opts.renderOptions.panel){this._opts.renderOptions.panel.appendChild(i);jZ.initialize();return}else{jZ.withoutPanelInitial();return}}this._results=this._createResults({city:"",plans:[],startStatus:jW,endStatus:jY});this._setStatus(BMAP_STATUS_UNKNOWN_ROUTE);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,this._results);return}else{if(this.QUERY_TYPE===aN){}}}else{if(jX.type===h4){if(this.QUERY_TYPE===aN){this._opts.renderOptions.panel=null}this._processRaw();this._renderMap();if(this.QUERY_TYPE===hU||this.QUERY_TYPE===hm){this._renderList()}}}}}},_getRouteStatus:function(T,i){var e=BMAP_ROUTE_STATUS_NORMAL;if(i===0){if(T>0){e=BMAP_ROUTE_STATUS_ADDRESS}else{e=BMAP_ROUTE_STATUS_EMPTY}}return e},_getRouteStatus30:function(i){var e=BMAP_ROUTE_STATUS_NORMAL;if(typeof i==="undefined"||i===null||i.length===0){e=BMAP_ROUTE_STATUS_EMPTY}else{if(i.length>0){e=BMAP_ROUTE_STATUS_ADDRESS}}return e},_stopDragging:function(){var jW=this;if(jW._d.sliderMkr){jW._d.sliderMkr.disableDragging()}for(var jV=0,e=this._d.dragOverlays.length;jV<e;jV++){var T=this._d.dragOverlays[jV];if(T instanceof jz){T.disableDragging()}}},_processRaw:function(){var ko=this;var kn=this._json.content;var ka=kn.result;var j0={};var jY={};if(typeof this._ud.start==="object"&&!(this._ud.start instanceof cu||this._ud.start instanceof co)){eP.extend(j0,this._ud.start)}else{if(ko.QUERY_TYPE===hU||ko.QUERY_TYPE===hm){j0.title=ka.origin["wd"]||"起点";j0.uid=ka.origin["uid"];j0.url=aG._getPoiUrl(j0.uid,ka.origin["area_id"]);j0.point=new cu(ka.origin["originPt"]["lng"],ka.origin["originPt"]["lat"]);j0.city=ka.origin["cname"]}else{if(ko.QUERY_TYPE===aN){j0.title="起点";j0.point=new cu(ka.routes[0]["origin"]["lng"],ka.routes[0]["origin"]["lat"])}}}if(typeof this._ud.end==="object"&&!(this._ud.end instanceof cu||this._ud.end instanceof co)){eP.extend(jY,this._ud.end)}else{if(ko.QUERY_TYPE===hU||ko.QUERY_TYPE===hm){jY.title=ka.destination["wd"]||"终点";jY.uid=ka.destination["uid"];jY.url=aG._getPoiUrl(jY.uid,ka.destination["area_id"]);jY.point=new cu(ka.destination["destinationPt"]["lng"],ka.destination["destinationPt"]["lat"]);jY.city=ka.destination["cname"]}else{if(ko.QUERY_TYPE===aN){jY.title="终点";jY.point=new cu(ka.routes[0]["destination"]["lng"],ka.routes[0]["destination"]["lat"])}}}var j7=[];this._d.viaPtsInfo.length=0;var kj=1;var km=[];this._segPolylinePoints=[];var j3=0;var j8=[];var kf=[];var kl=[];var kg=[];var j5=ka.routes;if(ko.QUERY_TYPE===hU||ko.QUERY_TYPE===hm){for(var kh=0;kh<j5.length;kh++){var kb=j5[kh];for(var kd=0;kd<1;kd++){var ki=kb.steps;for(j=0;j<ki.length;j++){var kc=new cu(ki[j]["stepOriginLocation"]["lng"],ki[j]["stepOriginLocation"]["lat"]);var j9=j;var j1=ki[j]["instructions"];var jX=ki[j]["distance"];var j2=new dG({point:kc,index:j9,description:j1,distance:jX});kl.push(j2);var jW=[];jW.push(kc);jW=jW.concat(bF.pathToPoints(ki[j]["path"]));jW.push(new cu(ki[j]["stepDestinationLocation"]["lng"],ki[j]["stepDestinationLocation"]["lat"]));kg=kg.concat(jW);if(jW.length>0){this._segPolylinePoints[j3]=jW;km=km.concat(jW)}j3++}var jX=kb.distance;var e=new dy({steps:kl,distance:jX,index:kd,points:kg,rt:this.ROUTE_TYPE});kf.push(e)}var j4=new gu({routes:kf,distance:kb.distance,duration:kb.duration});j8.push(j4)}var j6={plans:j8,start:j0,end:jY}}else{if(ko.QUERY_TYPE===aN){for(var kh=0;kh<j5.length;kh++){var kb=j5[kh];for(var kd=0;kd<1;kd++){var ki=kb.steps;for(j=0;j<ki.length;j++){var kc=new cu(ki[j]["start_location"]["lng"],ki[j]["start_location"]["lat"]);var j9=j;var j1="";var jX=ki[j]["distance"];var j2=new dG({point:kc,index:j9,description:j1,distance:jX});kl.push(j2);var jW=[];jW=jW.concat(bF.pathToPoints(ki[j]["path"]));kg=kg.concat(jW);if(jW.length>0){this._segPolylinePoints[j3]=jW;km=km.concat(jW)}j3++}var jX=kb.distance;var e=new dy({steps:kl,distance:jX,index:kd,points:kg,rt:this.ROUTE_TYPE});kf.push(e)}var j4=new gu({routes:kf,distance:kb.distance,duration:kb.duration});j8.push(j4)}var j6={plans:j8,start:j0,end:jY,policy:ko._ud.policy}}}this._results=this._createResults(j6);this._d.viaPts.length=0;this._d.plys.length=0;var T=j0.point;this._d.viaPts.push(T);for(var kh=0,ke=j7.length;kh<ke;kh++){var kk=j7[kh];this._d.viaPts.push(kk)}var jV=jY.point;this._d.viaPts.push(jV);var jZ=kg;jZ.stNo=kh;jZ.edNo=kh+1;this._d.plys.push(jZ);this._setStatus(BMAP_STATUS_SUCCESS);this._triggerCbk(aG.CBK_SEARCH_COMPLETE,this._results)},_getAllStepCount:function(){var jW=0;var jX=this._results.getPlan(0);for(var jV=0,e=jX.getNumRoutes();jV<e;jV++){var T=jX.getRoute(jV);jW+=T.getNumSteps()}return jW},_getCurStep:function(jY){var jX=0;var jZ=this._results.getPlan(0);for(var jW=0,T=jZ.getNumRoutes();jW<T;jW++){var j1=jZ.getRoute(jW);for(var jV=0,j0=j1.getNumSteps();jV<j0;jV++){var e=j1.getStep(jV);if(jX===jY){return e}jX++}}},_getDescription:function(j0,jZ,ka,j6,j5,jV,ke){var jX="";var j4=parseInt(jZ.d,10);var j1=jZ.poi;if(j1){j4=j4-j1.pd}var j9=iw(j4);var T=this._getRoadName(jV.t,jV.n);var jW=this._getRoadName(jZ.t,jZ.n);var kd=this._getRoadName(jZ.t,ka.n);var j2=this._getDwType(j0.dw)||"";var j3=j0.dr?(j2+"<span>"+j0.dr+"</span>，"):"";if(ke.rt===3){j3+="到达<span>"+this._getRetType(ke.rt)+"</span>，"}var kb=((jW!==""&&T===jW)?"继续":"")+this._getRoadAct(jZ.t,jZ.n);var e=this._getPoiInfo(jZ);var j8=this._getTicInfo(j0);var kc=(jW===kd)?"":(this._getRetAct(ka.t,ka.n)+"<span>"+kd+"</span>");var j7=this._getTurnIcon(j0.ett||j0.extt||j0.tt);jX=j7+"<div class=\'navtrans-navlist-content\'>"+kb+jW+this._getRetType(j0.rt)+j9+"，"+e+j8+j3;if(j6===0){jX=j7+"<div class=\'navtrans-navlist-content\'>从起点向"+this._getTurnType(j0.ett||j0.extt||j0.tt)+"出发</div>"}else{if(j6>0&&j6<j5-1){var jY=this._getTurnType(j0.ett||j0.extt||j0.tt);if(!jY){jY=this._getTurnType(1)}jX=jX+jY+kc+"</div>"}else{jX=jX+"到达终点</div>"}}return jX},_isInThreshold:function(jZ,T,jY){if(T&&jY&&jY.length>0){for(var jX=0,e=jY.length;jX<e;jX++){var jW=jY[jX];var jV=jZ.pointToPixel(jW);if(fv.getDistanceByPixel(T,jV)<=cB.MAX_THRESHOLD){return true}}}return false},_renderMap:function(){var e=this._opts.renderOptions.map;if(e&&this._results){this._renderViaMkr();this._renderPly()}},_renderPly:function(){var kd=this._opts.renderOptions.map;var e=this._results.getPlan(0);var kc=e.getRoute(0);var jV=this._results.getStart();var kb=this._results.getEnd();var ke=this;var jX=this._d.viaPts.length;var ka=[];var jZ=[];var T;for(var j7=0,j4=this._d.plys.length;j7<j4;j7++){var j2=this._d.plys[j7];T=fv.addRoute(kd,j2,kc.getRouteType());e._routes[j7]._polyline=T;T.stNo=j2.stNo;T.edNo=j2.edNo;var j5=T.getBounds();ka.push(j5.getSouthWest());ka.push(j5.getNorthEast());if(this._enableDragging){if(jX<cB.DRAG_MAXPOINTS+2){T.addEventListener("mousemove",function(i){if(ke._d.mouseOnViaMkr){if(ke._d.sliderMkr){ke._d.sliderMkr.hide()}return}ke._d.curDragPly=this;if(ke._d.sliderMkr){if(ke._isInThreshold(kd,i.pixel,ke._d.viaPts)){ke._d.sliderMkr.hide()}else{ke._d.sliderMkr.show();ke._d.sliderMkr.setPosition(i.point);ke._d.tipLbl.setContent("拖动以更改路线");ke._d.tipLbl.show();ke._d.sliderMkr.setLabel(ke._d.tipLbl)}}else{ke._d.sliderMkr=fv.addDragMkr(kd,i.point);ke._d.sliderMkr.enableDragging();ke._d.sliderMkr.addEventListener("dragging",function(kg){var kh=ke._d.curDragPly.stNo;var kf=ke._d.curDragPly.edNo;ke._requestDragging(this,kd,kh,kf)});ke._d.sliderMkr.addEventListener("dragend",function(kh){var kg=ke._d.cbkDragPt;var ki=kg.name;var kf=ke._d.curDragPly.edNo;kg.if_wp=null;ke._d.viaPts.splice(kf,0,kg);ke._d.viaPtsInfo.splice(kf,0,{title:!!ki?ki:"未知路段",curNo:kf,point:kg});this.setPosition(kg);ke._stopDragging();ke._dragSearch(jV,kb)});if(!ke._d.tipLbl){ke._d.tipLbl=fv.createTipLbl("拖动以更改路线")}kd.addOverlay(ke._d.sliderMkr)}});T.addEventListener("mouseout",function(i){if(ke._d.sliderMkr){ke._d.sliderMkr.hide()}})}}ke._d.dragOverlays.push(T);if(this._opts._enableTraffic){kc=e.getRoute(j7);for(var j6=0,j0=kc._steps.length;j6<j0;j6++){var jW=kc._steps[j6];var j3=jW.trafficPaths;var j8=jW.trafficStatus;for(var j1=0,j9=j3.length;j1<j9;j1++){if(j8[j1]){var jY=fv.addRouteWithTraffic(kd,j3[j1],j8[j1])}jZ.push(jY);ke._d.dragOverlays.push(jY)}}kc._trafficePlys=jZ}}if(this._opts.renderOptions.autoViewport){kd.setViewport(ka,{margins:[30,30,30,30]})}this._triggerCbk(aG.CBK_POLYLINES_SET,e._routes)},_renderViaMkr:function(){var T=this._opts.renderOptions.map;var j4=this._results.getPlan(0);var e=this._results.getStart();var j1=this._results.getEnd();var j2=this;var j3=0;for(var jZ=0,jV=this._d.viaPts.length;jZ<jV;jZ++){var j0=this._d.viaPts[jZ];var jX;if(jZ===0){jX=fv.addDestPoi(T,j0,e.title,dj);e.marker=jX;if(this.QUERY_TYPE===hU||this.QUERY_TYPE===hm){jX.addEventListener("click",function(){j2._select(0)})}this._overlays.push(jX)}else{if(jZ===this._d.viaPts.length-1){jX=fv.addDestPoi(T,j0,j1.title,hG);j1.marker=jX;if(this.QUERY_TYPE===hU||this.QUERY_TYPE===hm){jX.addEventListener("click",function(){j2._select(j2._getAllStepCount()+1)})}this._overlays.push(jX)}else{if(j0.if_wp){jX=fv.addWayPointMkr(T,j0,j3);j3++;jX.if_wp=1}else{jX=fv.addDragMkr(T,j0)}this._d.viaPtsInfo[jZ-1].marker=jX;var jY=new g9();jY.addItem(new hJ("删除该点",function(j6,j5,i){j2._delVia(i.curNo)},{width:60}));jX.addContextMenu(jY);j2._d.cxtMenu.push(jY)}}jX.curNo=jZ;if(this._enableDragging){jX.enableDragging();jX.addEventListener("mouseover",function(i){j2._d.mouseOnViaMkr=true;if(j2._d.tipLbl){j2._d.tipLbl.setContent("拖动以更改路线");j2._d.tipLbl.show();this.setLabel(j2._d.tipLbl)}else{j2._d.tipLbl=fv.createTipLbl("拖动以更改路线");this.setLabel(j2._d.tipLbl)}});jX.addEventListener("mouseout",function(i){this.getLabel()&&this.getLabel().hide();j2._d.mouseOnViaMkr=false});jX.addEventListener("dragging",function(i){j2._requestDragging(this,T)});jX.addEventListener("dragend",function(j5){var i=j2._d.cbkDragPt;var j6=this.curNo;if(this.if_wp){i.if_wp=1}j2._d.viaPts[j6]=i;this.setPosition(i);var j8=j2._d.viaPts[0];var j7=j2._d.viaPts[j2._d.viaPts.length-1];if(j6===0){e.point=j8;e.title=j2._d.cbkStartPoiName}if(j6===j2._d.viaPts.length-1){j1.point=j7;j1.title=j2._d.cbkEndPoiName}j2._stopDragging();j2._dragSearch(e,j1)})}j2._d.dragOverlays.push(jX)}var jW=[e];jW=jW.concat(this._d.viaPtsInfo);jW=jW.concat([j1]);this._triggerCbk(aG.CBK_MARKERS_SET,jW)},_requestDragging:function(jZ,i,jV,j0){var j2=this;if(j2._d.dragReqFlag===true){return}j2._d.dragReqFlag=true;setTimeout(function(){j2._d.dragReqFlag=false},cB.DRAG_REQ_FREQUENCE);var jX;var j4=iU.convertLL2MC(jZ.getPosition());var e=i.getZoom();var j1=jZ.curNo;var j3=j2._opts.policy;if(typeof jV!=="undefiend"&&typeof j0!=="undefined"){var jW=j2._d.viaPts[jV];jW=iU.convertLL2MC(jW);var jY=j2._d.viaPts[j0];jY=iU.convertLL2MC(jY);jX={qt:h1,pt:j4.lng+","+j4.lat,sn:jW.lng+","+jW.lat,en:jY.lng+","+jY.lat,r:5000,st:1,et:1,sy:j3,l:e}}else{if(j1===0){var jY=j2._d.viaPts[j1+1];jY=iU.convertLL2MC(jY);jX={qt:h1,pt:j4.lng+","+j4.lat,sn:"",en:jY.lng+","+jY.lat,r:5000,st:1,et:1,sy:j3,l:e}}else{if(j1===this._d.viaPts.length-1){var jW=j2._d.viaPts[j1-1];jW=iU.convertLL2MC(jW);jX={qt:h1,pt:j4.lng+","+j4.lat,sn:jW.lng+","+jW.lat,en:"",r:5000,st:1,et:1,sy:j3,l:e}}else{var jW=j2._d.viaPts[j1-1];jW=iU.convertLL2MC(jW);var jY=j2._d.viaPts[j1+1];jY=iU.convertLL2MC(jY);jX={qt:h1,pt:j4.lng+","+j4.lat,sn:jW.lng+","+jW.lat,en:jY.lng+","+jY.lat,r:5000,st:1,et:1,sy:j3,l:e}}}}var T={curDragMkr:jZ,map:i,stNo:jV,edNo:j0};jE.request(function(j6,j5){j2._requestDraggingCbk(j6,j5)},jX,T)},_requestDraggingCbk:function(j4,T){var j0=this;if(j4&&j4.content){j0._d.cbkDragPt=bF.parseGeo(j4.content["dragpt"],true).point;var j3;var i=T.map;var jW=T.stNo;var jY=T.edNo;var jX=T.curDragMkr;var jZ=jX.curNo;if(typeof jW!=="undefiend"&&typeof jY!=="undefined"){j3=bF.parseGeoExt(j4.content["geo"]).points}else{if(jZ===0){j3=bF.parseGeo(j4.content["geo"],true).points;j0._d.cbkStartPoiName=j4.content["name"]?j4.content["name"]:"起点"}else{if(jZ===j0._d.viaPts.length-1){j3=bF.parseGeo(j4.content["geo"],true).points;j0._d.cbkEndPoiName=j4.content["name"]?j4.content["name"]:"终点"}else{j3=bF.parseGeoExt(j4.content["geo"]).points}}}if(j3){j0._clearOldLine(jZ,i,jW,jY);if(j0._d.cbkPly){j0._d.cbkPly.setPath(j3)}else{var j1=j0._results.getPlan(0);var j2=j1.getRoute(0);j0._d.cbkPly=fv.addRoute(i,j3,j2.getRouteType())}}var e=j4.content["name"]?j4.content["name"]:"未知路段";j0._d.cbkDragPt.name=e;var jV="("+iw(j4.content["dis"])+")";j0._d.tipLbl&&j0._d.tipLbl.show();j0._d.tipLbl&&j0._d.tipLbl.setContent(e+jV)}},_clearOldLine:function(jY,jZ,jX,T){for(var jW=0,e=this._d.dragOverlays.length;jW<e;jW++){var jV=this._d.dragOverlays[jW];if(jV instanceof fK){if(typeof jX!=="undefiend"&&typeof T!=="undefined"){if(jV.stNo===jX&&jV.edNo===T){jZ.removeOverlay(jV);break}}else{if(jV.stNo===jY||jV.edNo===jY){jZ.removeOverlay(jV)}}}}if(this._hlRoute){this._hlRoute.hide()}},_select:function(T){var jY=this._curIndex;var jW=this._opts.renderOptions;if(jW.panel){var jX=jW.panel.getElementsByTagName("table");var j3=jX[jX.length-1];var j0=j3.getElementsByTagName("tr");if(jY-1>=0&&j0[jY-1]){j0[jY-1].style.background=""}if(T-1>=0&&j0[T-1]){j0[T-1].style.background="#f0f0f0"}}var j7=jW.map;if(j7){var e=this._results.getPlan(0);var j5=e.getRoute(0);var j9=this._getAllStepCount();var j8=this;j7.closeInfoWindow();if(T===0||T===j9+1){var j4=T===0?this._results.getStart():this._results.getEnd();var i=fv.createTransInfoWnd({content:"<b>"+j4.title+"</b>",total:j9,curIndex:T,nextTransCbk:function(ka){j8._select(ka)},hideStep:(jW.highlightMode===BMAP_HIGHLIGHT_STEP?false:true)});i.addEventListener("open",function(){j8._triggerCbk(aG.CBK_INFO_HTML_SET,j4,fv.getInfoWindowDom(j7))});i.addEventListener("close",function(){if(j8._opts.renderOptions.panel){var kb=jW.panel.getElementsByTagName("table");var kc=kb[kb.length-1];if(kc){var ka=kc.getElementsByTagName("tr");if(j8._curIndex-1>=0&&ka[j8._curIndex-1]){ka[j8._curIndex-1].style.background=""}}}j8._curIndex=-1});var j6=T===0?0:1;var j8=this;if(j7.config.enableStreetEntrance&&false){PanoramaEntranceUtil.insearchPanoEntranceInInfoWnd(i,j7.getCurrentCity().code,{panoInstance:j7._pano,lngLat:j4.point,titleTip:j4.title,type:"busline",beforeDomId:"trans_nav"},function(){j8._overlays[j6].openInfoWindow(i)})}else{j8._overlays[j6].openInfoWindow(i)}if(this._hlRoute){this._hlRoute.hide()}}else{var j2=jW.highlightMode;if(j2===BMAP_HIGHLIGHT_STEP){var jV=this._getCurStep(T-1);var i=fv.createTransInfoWnd({content:jV.getDescription()?jV.getDescription(false):jV.instructions,total:j9,curIndex:T,nextTransCbk:function(ka){j8._select(ka)}});i.addEventListener("open",function(){j8._triggerCbk(aG.CBK_INFO_HTML_SET,jV,fv.getInfoWindowDom(j7))});i.addEventListener("close",function(){if(j8._opts.renderOptions.panel){var kb=jW.panel.getElementsByTagName("table");var kc=kb[kb.length-1];if(kc){var ka=kc.getElementsByTagName("tr");if(j8._curIndex-1>=0&&ka[j8._curIndex-1]){ka[j8._curIndex-1].style.background=""}}}j8._curIndex=-1});var j1=jV.getPosition?jV.getPosition():jV.pathPoints[jV.pathPoints.length-1];var j8=this;if(j7.config.enableStreetEntrance&&false){PanoramaEntranceUtil.insearchPanoEntranceInInfoWnd(i,j7.getCurrentCity().code,{panoInstance:j7._pano,lngLat:j1,titleTip:jV.getDescription?jV.getDescription(false):jV.instructions,type:"driving",beforeDomId:"trans_nav"},function(){j7.openInfoWindow(i,j1)})}else{j7.openInfoWindow(i,j1)}}else{if(j2===BMAP_HIGHLIGHT_ROUTE){if(T===1&&!this._opts._enableTraffic){var jV=this._getCurStep(0);j7.setCenter(jV.getPosition?jV.getPosition():jV.pathPoints[jV.pathPoints.length-1]);if(jW.autoViewport){j7.setZoom(17)}if(this._hlRoute){this._hlRoute.hide()}}else{if(this._segPolylinePoints[T-1]){if(!this._hlRoute){this._hlRoute=fv.addRoute(j7,this._segPolylinePoints[T-1],j5.getRouteType()+2)}else{this._hlRoute.setPath(this._segPolylinePoints[T-1]);this._hlRoute.show()}if(jW.autoViewport){var jZ=j7.getViewport(this._hlRoute.getBounds());if(jZ.zoom>17){jZ.zoom=17}j7.setViewport(jZ)}}}}}}}this._curIndex=T},_toggle:function(){var i=this._opts.renderOptions;if(i.panel){var e=eP.getElementsByClassName(i.panel,"navtrans-res");if(e&&e.length>0){e=e[0];if(e&&e.style.display==="none"){e.style.display=""}else{e.style.display="none"}}var T=eP.getElementsByClassName(i.panel,"navtrans-view");if(T&&T.length>0){T=T[0];eP.toggleClass(T,"expand")}}},_clearOverlays:function(){var jV=this._opts.renderOptions.map;if(!jV){return}for(var T=0,e=this._overlays.length;T<e;T++){jV.removeOverlay(this._overlays[T]);this._overlays[T]=null}this._overlays.length=0;jV.removeOverlay(this._hlRoute);this._hlRoute=null;if(this._d){if(this._d.sliderMkr){jV.removeOverlay(this._d.sliderMkr);this._d.sliderMkr=null}if(this._d.tipLbl){jV.removeOverlay(this._d.tipLbl);this._d.tipLbl=null}for(var T=0,e=this._d.dragOverlays.length;T<e;T++){jV.removeOverlay(this._d.dragOverlays[T]);this._d.dragOverlays[T]=null}this._d.dragOverlays.length=0;if(this._d.cbkPly){jV.removeOverlay(this._d.cbkPly);this._d.cbkPly=null}for(var T=0,e=this._d.cxtMenu.length;T<e;T++){jV.removeContextMenu(this._d.cxtMenu[T]);this._d.cxtMenu[T]=null}this._d.cxtMenu.length=0;this._d.mouseOnViaMkr=false}},_delVia:function(T){if(this._results){var i=this._results.getStart();var e=this._results.getEnd();this._d.viaPts.splice(T,1);this._stopDragging();this._dragSearch(i,e)}},_renderList:function(){if(this._opts.renderOptions.panel&&this._opts.renderOptions.panel.appendChild&&this._results&&this._results.getNumPlans()>0){var jW=this._results.getPlan(0);var j5=bV("div",{style:"font:12px "+B.fontFamily+";background:#fff"});var jV=this._d.viaPtsInfo;var e=jV.length;var j1=[];var jZ="";switch(this.QUERY_TYPE){case aN:jZ="驾车";break;case hm:jZ="骑行";break;case hU:jZ="步行";break}var kb=ju._genResultTitle(this._results.getEnd().title,jZ,e>0);if(e>0){j1.push("<table style=\'width:100%;margin-left:4px;font:12px "+B.fontFamily+";border-collapse:collapse\' cellpadding=\'0\' cellspacing=\'0\' border=\'0\'>");for(var j8=0;j8<e;j8++){j1.push("<tr>");if(j8===0){if(e===1){j1.push(\'<td style="padding:2px 5px;line-height:20px">途经点</td>\')}else{j1.push(\'<td valign="top" rowspan="\'+e+\'" style="padding:2px 5px;line-height:18px">途经点</td>\')}}j1.push(\'<td style="padding:2px 5px;line-height:20px">\'+jV[j8].title+"</td>");j1.push(\'<td style="padding:2px 10px;line-height:20px;cursor:pointer;color:#0000ff" onclick=\\\'BMapGL.I("\'+this.hashCode+\'")._delVia(\'+jV[j8]["curNo"]+")\'>删除</td>");j1.push("</tr>")}j1.push("</table>")}var j9=ju._genTitle(this._results.getStart().title,\'BMapGL.I("\'+this.hashCode+\'")._select(0)\',0);var j2=["<table class=\'navtrans-table\' style=\'width:100%;font:12px "+B.fontFamily+";border-collapse:collapse\' cellpadding=\'0\' cellspacing=\'0\' border=\'0\'>"];var j7=0;for(var j4=0,j0=jW.getNumRoutes();j4<j0;j4++){var ka=jW.getRoute(j4);for(var j8=0,j6=ka.getNumSteps();j8<j6;j8++){var jY="";if(this._curIndex===j7+1){jY=";background:#f0f0f0"}j2.push(\'<tr style="cursor:pointer\'+jY+\'" onclick=\\\'BMapGL.I("\'+this.hashCode+\'")._select(\'+(j7+1)+")\'>");j2.push("<td style=\'border-bottom:1px solid #E4E6E7;padding:10px;line-height:20px;\' >"+(this._getCurStep(j7).getDescription?this._getCurStep(j7).getDescription():this._getCurStep(j7)["instructions"])+"</td>");j2.push("</tr>");j7++}}j2.push("</table>");var T=ju._genTitle(this._results.getEnd().title,\'BMapGL.I("\'+this.hashCode+\'")._select(\'+(j7+1)+")",1);var j3="<div class=\'navtrans-view expand\' style=\'position:relative;color:#7777cc;background:#e5ecf9;height:53px;overflow:hidden;text-align:right\' onclick=\'BMapGL.I(\\""+this.hashCode+"\\")._toggle()\'><span class=\'suggest-plan\'>推荐</span><div class=\'suggest-plan-des\'>"+jW.getDistance().replace(/(\\d+(?:.\\d+)?)/,"$1 ")+"&nbsp;&nbsp;|&nbsp;&nbsp;"+jW.getDuration().replace(/(\\d+)/,"$1 ")+"</div>";if(this._results.moreResultsUrl){j3+="<a style=\'color:#7777cc;position:absolute;top:5px;right:20px;\' href=\'"+this._results.moreResultsUrl+"\' target=\'_blank\'>到百度地图查看&#187;</a>"}j3+="&nbsp;<span class=\'navtrans-arrow\'></span></div>";var jX="<div class=\'navtrans-res\'>"+j1.join("")+j9+j2.join("")+T+"</div>";j5.innerHTML=kb+j3+jX;this._opts.renderOptions.panel.appendChild(j5);this._triggerCbk(aG.CBK_RESULTS_HTML_SET,j5)}},_getRoadName:function(i,e){if(e===""||!e){if(i===9||i===12||i===1||i===16){e=cB.ROAD_TYPE[i]}}return e},_getPoiInfo:function(jX){var e="";var jW=jX.poi;if(jW){var jV=this._getPsType(jW.ps)||"";var i=this._getPwType(jW.pw)||"";var T=jW.pd<((jX.t===13||jX.t===4)?1000:50)?"":"约"+iw(jW.pd)+"后";e=i+jV+"<b>"+jW.pn+"</b>"+T+(jV===""?"":"，")}return e},_getTicInfo:function(i){var e=i.iw;return !i.ic?"":((this._getIwGo(e)||"")+"<b>"+i.ic+"</b>"+(this._getIwTo(e)||""))},_getRoadAct:function(T,i){var e="沿";if(T===0||(!i&&T!==1&&T!==16&&T!==9&&T!==12)){e=""}return e},_getRetAct:function(T,i){var e="进入";if(!i&&(T===9||T===12)){e="上"}else{if(T===0||(!i&&T!==1&&T!==16)){e=""}}return e},_getTaxiFare:function(){if(this._json&&this._json.content&&this._json.content["taxi"]){var jV=this._json.content["taxi"];var e={distance:jV.dis,remark:jV.remark};if(jV.detail[0]){var T=jV.detail[0];e.day={initialFare:parseFloat(T.startPrice),unitFare:parseFloat(T.kmPrice),totalFare:parseFloat(T.totalPrice)}}if(jV.detail[1]){var i=jV.detail[1];e.night={initialFare:parseFloat(i.startPrice),unitFare:parseFloat(i.kmPrice),totalFare:parseFloat(i.totalPrice)}}return e}return null}});cn.TURN_TYPE=["","直行","右前方转弯","右转","右后方转弯","调头","左后方转弯","左转","左前方转弯","靠左","直行","靠右","正北方向","东北方向","正东方向","东南方向","正南方向","西南方向","正西方向","西北方向"];cn.RET_TYPE=["","从起点出发","到达目的地","途经点","行驶"];cn.TURN_ICON_CLASS=["s-1","s-1","s-2","s-3","s-4","s-5","s-6","s-7","s-8","s-9","s-1","s-10","","","","","","","",""];cn.IWGO=["在","从","从"];cn.IWTO=["","","离开"];cn.PWTYPE=["过","在"];cn.PSTYPE=["左侧的","右侧的",""];cn.DWTYPE=["","朝"];eP.extend(cn.prototype,{_createResults:function(e){return new hI(e)},_getTurnType:function(e){return cn.TURN_TYPE[e]},_getTurnIcon:function(T){var i="navtrans-navlist-icon "+(cn.TURN_ICON_CLASS[T]?cn.TURN_ICON_CLASS[T]:"");var e=\'<span class="\'+i+\'"></span>\';return e},_getRetType:function(e){return cn.RET_TYPE[e]},_getIwGo:function(e){return cn.IWGO[e]},_getIwTo:function(e){return cn.IWTO[e]},_getPwType:function(e){return cn.PWTYPE[e]},_getPsType:function(e){return cn.PSTYPE[e]},_getDwType:function(e){return cn.DWTYPE[e]}});fh.TURN_TYPE=["","直走","向右前方转","右转","向右后方转","向后转","向左后方转","左转","向左前方转","左转穿过马路并继续向前","右转穿过马路并继续向前","左转穿过马路并往回走","右转穿过马路并往回走","正北方向","东北方向","正东方向","东南方向","正南方向","西南方向","正西方向","西北方向","","","",""];fh.TURN_ICON_CLASS=["s-1","s-1","s-2","s-3","s-4","s-5","s-6","s-7","s-8","s-7","s-3","s-7","s-3","","","","","","","","","","","",""];fh.RET_TYPE=["","从起点出发","到达目的地","途经点","走"];fh.IWGO=["在","从","从"];fh.IWTO=["","","离开"];fh.PWTYPE=["过","在"];fh.PSTYPE=["左侧的","右侧的",""];fh.DWTYPE=["","朝"];eP.extend(fh.prototype,{_createResults:function(e){delete e.url;return new r(e)},_getTurnType:function(e){return fh.TURN_TYPE[e]},_getTurnIcon:function(T){var i="navtrans-navlist-icon "+(fh.TURN_ICON_CLASS[T]?fh.TURN_ICON_CLASS[T]:"");var e=\'<span class="\'+i+\'"></span>\';return e},_getRetType:function(e){return fh.RET_TYPE[e]},_getIwGo:function(e){return fh.IWGO[e]},_getIwTo:function(e){return fh.IWTO[e]},_getPwType:function(e){return fh.PWTYPE[e]},_getPsType:function(e){return fh.PSTYPE[e]},_getDwType:function(e){return fh.DWTYPE[e]}});eP.extend(cZ.prototype,{_createResults:function(e){delete e.url;return new fb(e)}});var dR=new iL(9,0);var iE=new iL(300,300);eP.extend(g2.prototype,{render:function(j0){window.RouteAddrInst=this;var jX={};var kb=this.json;this.endIndex=1;var jV=this.endIndex;var j5=[];var j9=[];var ke=["sel_n","sel_n1","sel_y","sel_x","sel_x1"];var kc=[-1,-1];var j6=[];var j9=[];var j2=kb.content["result"];this.tpCity=[j2.originInfo["area_id"],j2.destinationInfo["area_id"]];tempCode=j2.originInfo["area_id"];for(var j7=0;j7<jV+1;j7++){var j1=null;j5.push([]);j6.push("");j9.push("");if(j7==0){if(j2.originInfo){this.tpCity[0]=j2.originInfo["area_id"];tempCode=this.tpCity[0]}}else{if(j2.destinationInfo){this.tpCity[j7]=j2.destinationInfo["area_id"];tempCode=this.tpCity[j7]}}j1=this.getCurPoint30(j7);if(j1.length>0){j9[j7]=\'<a href="javascript:void(0)" ></a>\';j5[j7].push(\'<div id="RADiv_ResItem\'+j7+\'" class="sel_body_body_div sel_body_resitem">\');var jZ=[0,9];if(j1.length<10){jZ[1]=j1.length-1}j5[j7].push(this.makeListTable(j7,jZ));if(j1.length>10){j5[j7].push(\'<div id="RADiv_PAGE\'+j7+\'" style="height:20px;" class="sel_body_body_page"></div>\');this.totalPage[j7]=Math.ceil(j1.length/10);this.curPageIndex[j7]=1}j5[j7].push("</div>");if(j1.length===1){kc[j7]=2;this.qInfo[j7]["n"]=j1[0]["name"];this.qInfo[j7]["c"]=tempCode;this.qInfo[j7]["u"]=j1[0]["uid"];var e=new cu(j1[0]["location"]["lng"],j1[0]["location"]["lat"]);var kf=e;this.qInfo[j7]["point"]=e;this.qInfo[j7]["x"]=kf.lng;this.qInfo[j7]["y"]=kf.lat;this.qInfo[j7]["t"]=BMAP_POI_TYPE_NORMAL;var j4=this.addPointMarker(this._opts.renderOptions.map,kf,j1[0]["name"],j7);this.markerDest=j4;this.locPois.push(j4.point);j6[j7]=j1[0]["name"]}else{kc[j7]=0}}}var jW;var T;var j3=false;var ka=false;for(var j8=0,jY;j8<kc.length;j8++){jY=kc[j8];if(jW){if(jY==0||jY==3){kc[j8]=jY+1}}else{if(jY==0&&!T){this.curPointIndex=j8;T=j8+1;continue}if(T&&jY==0){kc[j8]=1}}}jX.startPointClass=ke[kc[0]];this.startName=j2.originInfo["wd"];if(j6[0]==""){jX.startPoint=this.startName}else{jX.startPoint=j6[0]}jX.startBody=j5[0].join("");jX.endPointClass=ke[kc[jV]];this.endName=j2.destinationInfo["wd"];if(j6[jV]==""){jX.endPoint=this.endName}else{jX.endPoint=j6[jV]}jX.endBody=j5[jV].join("");jX.startButton=j9[0];jX.endIndex=jV;jX.endButton=j9[jV];this.tpName=[];var kd=[""];jX.tpList=kd.join("");return this.template(jX)},bindEvent:function(){var i,e;if(eP.G("RouteAddress_DIV0")){i=eP.G("RouteAddress_DIV0").getElementsByTagName("tr");this.routDivTrBindFun(i)}if(eP.G("RouteAddress_DIV1")){e=eP.G("RouteAddress_DIV1").getElementsByTagName("tr");this.routDivTrBindFun(e)}var jW=this;if(this.infoWindow){this.infoWindow.addEventListener("open",function(){var jX=eP.G("selInfoWndBtn");eP.on(jX,"click",function(){var jY=jX.getAttribute("data-uid").split("_");jW.itmSelect(jY[0],jY[1])});eP.on(jX,"mouseover",function(){jW._selBtnOver(jX)});eP.on(jX,"mousedown",function(){jW._selBtnDown(jX)});eP.on(jX,"mouseout",function(){jW._selBtnOut(jX)})})}var jV,T;if(eP.G("RouteAddress_DIV0")){jV=eP.G("RouteAddress_DIV0").firstChild.firstChild;eP.on(jV,"click",function(jY){var jX=jV.getAttribute("data-uid");jW.showLst(jX)})}if(eP.G("RouteAddress_DIV1")){T=eP.G("RouteAddress_DIV1").firstChild.firstChild;eP.on(T,"click",function(jY){var jX=T.getAttribute("data-uid");jW.showLst(jX)})}},routDivTrBindFun:function(i){var e=this;this.each(i,function(T,jV){eP.on(jV,"mouseover",function(jY){var jZ=jV.getAttribute("data-uid").split("_");var jX=parseInt(jZ[0],10);n2=parseInt(jZ[1],10);i8=parseInt(jZ[2],10);e._lstMouseOver(this,0,jZ[0],i8-n2,jY)});eP.on(jV,"mouseout",function(jY){var jZ=jV.getAttribute("data-uid").split("_");var jX=parseInt(jZ[0],10);n2=parseInt(jZ[1],10);i8=parseInt(jZ[2],10);e._lstMouseOut(this,0,jZ[0],i8-n2,jY)});eP.on(jV,"click",function(jY){var jZ=jV.getAttribute("data-uid").split("_");var jX=parseInt(jZ[0],10);n2=parseInt(jZ[1],10);i8=parseInt(jZ[2],10);e.select(jX,i8,jY)});var jW=jV.childNodes[2].getElementsByTagName("div")[0];eP.on(jW,"click",function(jX){var j0=jW.getAttribute("data-uid").split("_"),jZ=j0[0],jY=j0[1];e.itmSelect(jZ,jY)});eP.on(jW,"onmouseover",function(jX){e._selBtnOver(jW)});eP.on(jW,"onmouseout",function(jX){e._selBtnOut(jW)});eP.on(jW,"onmousedown",function(jX){e._selBtnDown(jW)})})},formatJson30:function(i,e){},parseJson:function(jX,e){if(!jX.content){jX.content={start:[],end:[]}}jX.content["tpList"]=[];if(jX.result.type==19){this.parseQuery(jX,e);var jY=jX.content,jV=[],T=jY.length;jX.content={start:[],end:[]};if(T>2){for(var jW=1;jW<(T-1);jW++){jV.push(jY[jW])}}jX.content["end"]=jY[T-1];jX.content["tpList"]=jV;jX.content["start"]=jY[0]}return jX},parseQuery:function(j6,T){var j4={},j2=this,e,jV,j0=0,jY=0,jZ=[],j1,j7=j6.result,jX=[];j4.city_list=[];j4.count=[];j4.current_null=[];j4.e_query=[];j4.e_wd=[];j4.end_city=[];j4.wd2=[];j4.prio_flag=[];j4.sug_index=[];j4.total=[];j4.s_wd="";j4.s_query="";this.canShowList=[];if(!j7.e_wd){j7.e_wd=[];j7.e_query=[]}e=this.parseOnePosition(T.start);j1=e.type;j4.s_wd=j1==1?e.keyword:j7.s_wd;j4.s_query=j1==1?e.keyword:j7.s_query;if(j1==1){j2.qInfo[j0].n=j4.s_wd;j2.qInfo[j0].x=e.point.split(",")[0];j2.qInfo[j0].y=e.point.split(",")[1]}this.canShowList.push(j1==2);j4.total.push(j1==1?1:j7.total[jY]);j4.count.push(j1==1?1:j7.count[jY]);j4.current_null.push(j1==1?0:j7.current_null[jY]);j4.prio_flag.push(j1==1?1:j7.prio_flag[jY]);j4.sug_index.push(j1==1?"":j7.sug_index[jY]);jZ.push(j1==1?[{name:e.keyword,geo:"1|"+e.point+";"+e.point+"|"+e.point+";"}]:j6.content[jY]);j4.city_list.push(j1==1?0:j7.city_list[jY]);j4.wd2.push(j1==1?"":j7.wd2[jY]);if(j1==2){jY++}j0++;jX=decodeURIComponent(T.end).split("to:");for(var jW=0,j5;(j5=jX[jW]);jW++){j5=this.parseOnePosition(j5);j1=j5.type;if(j1==2){if(j5.uid&&j5.point){j1=1}}this.canShowList.push(j1==2);var j3=j1==2?j5.keyword:jY==0?j7.s_wd:j7.e_wd[jY-1];j4.e_wd.push(j3);j4.e_query.push(j3);j4.end_city.push(j1==1?j6.current_city:jY==0?j7.start_city:j7.end_city[jY-1]);if(j1==1){j2.qInfo[j0].n=j4.s_wd;j2.qInfo[j0].x=j5.point.split(",")[0];j2.qInfo[j0].y=j5.point.split(",")[1]}if(j5.if_wp){this.insertTP(j0-1,{query:j4.e_wd[j0-1],addr:j4.wd2[j0],point:j1==1?bF.getPoiPoint(j5.point):null,uid:j5.uid});this.tpListInMap.push({query:j4.e_wd[j0-1],addr:j4.wd2[j0],point:j1==1?bF.getPoiPoint(j5.point):null,uid:j5.uid})}j4.total.push(j1==1?1:j7.total[jY]);j4.count.push(j1==1?1:j7.count[jY]);j4.current_null.push(j1==1?0:j7.current_null[jY]);j4.prio_flag.push(j1==1?1:j7.prio_flag[jY]);j4.sug_index.push(j1==1?"":j7.sug_index[jY]);jZ.push(j1==1?[{name:j5.keyword,geo:"1|"+j5.point+";"+j5.point+"|"+j5.point+";"}]:j6.content[jY]);j4.city_list.push(j1==1?0:j7.city_list[jY]);j4.wd2.push(j1==1?"":j7.wd2[jY]);if(j1==2){jY++}j0++}eP.extend(j6.result,j4);j6.content=jZ},insertTP:function(e,T){var i=eP.extend({},T);if(this.tpList.length>e){this.tpList[e]=T}else{if(this.tpList.length==e){this.tpList.push(T)}else{return}}this.tpList[e]=i},parseOnePosition:function(i){var i=decodeURIComponent(i),e=i.split("$$");return{type:e[0],uid:e[1],point:e[2],keyword:e[3],if_sug:e[4],keyword2:e[5],fe_xy:e[6],if_wp:e[7]}},getCurPoint30:function(e){var i=[];switch(e){case 0:case"0":i=this.json.content["result"]["origin"]["content"];break;case 1:case"1":i=this.json.content["result"]["destination"]["content"];break}return i},getCurPoint:function(e){return e==0?this.json.content["start"]:(e==this.endIndex?this.json.content["end"]:this.json.content["tpList"][e-1])},makeListTable:function(jX,jW,jV){var jZ=this;this.curSelectedIndex=-1;var j0=jV?jV:this.getCurPoint30(jX);var jY=[];jY.push(\'<div id="RA_ResItem_\'+jX+\'"><table border="0" cellspacing="0" cellpadding="0" style="width:100%">\');for(var T=jW[0];T<=jW[1];T++){jY.push(\'<tr  onmouseover="RouteAddrInst._lstMouseOver(this, 0,\'+jX+", "+(T-jW[0])+\', event)" onmouseout="RouteAddrInst._lstMouseOut(this, 0,\'+jX+", "+(T-jW[0])+\', event)" onclick="RouteAddrInst.select(\'+jX+","+T+\', event)"  filter = "item" data-uid="\'+jX+"_"+jW[0]+"_"+T+\'"  ><th><div title="在图上显示该点" class="icon iconbg" id="no_\'+jX+"_"+(T-jW[0]+1)+\'"></div></th>\');var e=(jX==0)?"选为起点":(jX==this.endIndex)?"选为终点":"选为途经点";jY.push(\'<td style="word-break:break-all;padding-right:24px">\');jY.push(\'<a href="javascript:void(0)">\'+j0[T]["name"]+"</a>");if(j0[T]["address"]&&j0[T]["address"]!=""){jY.push("<div>");jY.push(\'<span style="color:#999">地址: \'+j0[T]["address"]+"</span>");jY.push("</div>")}jY.push("</td>");jY.push(\'<td style="vertical-align:middle;width:106px"><div tid="selBtn_\'+jX+"_"+T+\'" class="selBtn"  onclick="RouteAddrInst.itmSelect(\'+jX+","+T+\');return false;" onmouseover="RouteAddrInst._selBtnOver(this)" onmouseout="RouteAddrInst._selBtnOut(this)" onmousedown="RouteAddrInst._selBtnDown(this)" data-uid = "\'+jX+"_"+T+\'"  >\'+e+"</div>");jY.push(\'<a data-uid="\'+j0[T]["uid"]+\'" href="javascript:void(0);" class="list_street_view_poi" style="visibility:hidden"><img src="//map.baidu.com/wolfman/static/common/images/transparent.gif" ></a>\');jY.push("</td>");jY.push("</tr>")}jY.push("</table></div>");return jY.join("")},addPointMarker:function(jW,jV,i,e,T){var jY;if(e==0){jY=fv.addDestPoi(jW,jV,i,dj)}else{if(e==this.endIndex){jY=fv.addDestPoi(jW,jV,i,hG)}else{var jX=this.tpListInMap[e-1];jX.point=jV;T&&(jX.uid=T);jY=fv.addWayPointMkr(jW,jV,e-1)}}this.destList.push(jY);return jY},template:function(i){var T=[];T.push(\'<div class="RouteAddressOuterBkg">\');T.push(\'<div class="RouteAddressTip"><span>请选择准确的起点、途经点或终点</span></div>\');T.push(\'<div class="RouteAddressInnerBkg">\');T.push(\'<div id="pos5" style="display:none"></div>\');T.push(\'<div id="RouteAddress_DIV0" class="\'+i.startPointClass+\'"> \');T.push(\'<div class="sel_body">\');T.push(\'<div class="sel_body_top" data-uid="0" onclick="RouteAddrInst.showLst(0)" >\');T.push(\'<div class="sel_body_title">\');T.push(\'<div class="sel_body_sign"></div>\');T.push(\'<div class="sel_body_name">起点：<b id="B_PointName0">\'+i.startPoint+"</b></div>");T.push("</div>");T.push(\'<div id="RD_TOP_BUT0" class="sel_body_button">\'+i.startButton+"</div>");T.push("</div>");T.push(\'<div class="sel_body_body" id="RADIV_BODY0">\'+i.startBody+"</div>");T.push("</div>");T.push("</div>");T.push(i.tpList);T.push(\'<div id="RouteAddress_DIV\'+i.endIndex+\'" class="\'+i.endPointClass+\'">\');T.push(\'<div class="sel_body">\');T.push(\'<div class="sel_body_top" data-uid=\'+i.endIndex+\' onclick="RouteAddrInst.showLst(\'+this.endIndex+\')" >\');T.push(\'<div class="sel_body_title">\');T.push(\'<div class="sel_body_sign"></div>\');T.push(\'<div class="sel_body_name">终点：<b id="B_PointName\'+i.endIndex+\'">\'+i.endPoint+"</b></div>");T.push("</div>");T.push(\'<div id="RD_TOP_BUT\'+i.endIndex+\'" class="sel_body_button">\'+i.endButton+"</div>");T.push("</div>");T.push(\'<div class="sel_body_body" id="RADIV_BODY\'+i.endIndex+\'">\'+i.endBody+"</div>");T.push("</div>");T.push("</div>");T.push(\'<div id="pos6" style="display:none"></div>\');T.push("</div>");T.push("</div>");var e=T.join("");return e},showLst:function(j3){this.curPointIndex=j3;var j1=this,j2=[];var jV=j2.length+1;var jY=this.getCurPoint30(j3);var jZ=j1.curPageIndex;var j0=eP.G("RouteAddress_DIV"+j3)["className"];if(j0=="sel_n"||j0=="sel_x"||(this.canShowList&&!this.canShowList[j3])){return}if(j0=="sel_n1"||j0=="sel_y"||j0=="sel_x1"){for(var T=0;T<=jV;T++){var e=eP.G("RouteAddress_DIV"+T);eP.G("B_PointName"+T).innerHTML=this.getCurPoiName(T);if(e.className=="sel_x"){e.className="sel_x1"}else{if(e.className=="sel_n"){e.className="sel_n1"}}}j1.clearMarkers();if(j1.markerDest){for(var T=0;T<j1.destList.length;T++){j1.map.removeOverlay(j1.destList[T])}j1.destList=[];j1.markerDest=null}if(j0=="sel_y"){j1.qInfo[j3]={n:"",c:0,u:0,x:0,y:0,t:-1};j1.resType[j3]=0}var jX=0;if(j3===0){jX=j1.json.content["result"]["origin"].length}else{if(j3===1){jX=j1.json.content["result"]["destination"].length}}if(jX<=0){eP.G("RouteAddress_DIV"+j3)["className"]="sel_x"}else{eP.G("RouteAddress_DIV"+j3)["className"]="sel_n";var jW=(jZ[j3]-1)*10+9;if(jY.length<(jW+1)){jW=jY.length-1}j1.addMarkers(j3,[(jZ[j3]-1)*10,jW])}}this.curSelectedIndex=-1},_selectIt:function(j1,jX){var j0=this;var j3;if(eP.G("RA_ResItem_"+j1)){j3=eP.G("RA_ResItem_"+j1).childNodes[0]}if(j3){var jZ=j3.rows[jX];if(jZ){jZ.style.backgroundColor="#F4F4F4";var T=jZ.getElementsByTagName("td")[1];var jV=T.childNodes[0];jV.style.visibility="visible";var i=jZ.getElementsByTagName("th")[0];var j2=i.childNodes[0];j2.style.backgroundPosition=-jX*18+"px -166px"}}if(j0.markersList.length>jX){var jY=B.staticHost+"/wolfman/static/common/images/";jY+="markers_new2x_2960fb4.png";var e=new iL(18*jX,166);var jW=new jd(jY,new iL(18,27),{offset:new iL(9,27),imageOffset:e,infoWindowOffset:dR,imageSize:iE,});j0.markersList[jX].setIcon(jW);j0._setTop(j0.markersList[jX],true,true)}},_lstMouseOver:function(jV,T,jY,i,jX){var jW=this._opts.renderOptions.map;if(this.curSelectedIndex!=i){jW.closeInfoWindow();this._selectIt(jY,i)}},_lstMouseOut:function(jV,T,jX,i,jW){if(this.curSelectedIndex!=i){this._unSelectIt(jX,i)}},_unSelectIt:function(j1,jX){var j0=this;var j3=null;if(eP.G("RA_ResItem_"+j1)){j3=eP.G("RA_ResItem_"+j1).childNodes[0]}if(j3){var jZ=j3.rows[jX];jZ.style.backgroundColor="#ffffff";var T=jZ.getElementsByTagName("td")[1];var jV=T.childNodes[0];jV.style.visibility="";var i=jZ.getElementsByTagName("th")[0];var j2=i.childNodes[0];j2.style.backgroundPosition=-jX*18+"px -273px"}if(j0.markersList.length>jX){var jY=B.staticHost+"/wolfman/static/common/images/";jY+="markers_new2x_2960fb4.png";var e=new iL(18*jX,273);var jW=new jd(jY,new iL(18,27),{offset:new iL(9,27),imageOffset:e,infoWindowOffset:dR,imageSize:iE,});j0.markersList[jX].setIcon(jW);j0._setTop(j0.markersList[jX],false)}},_setTop:function(T,i,e){if(!T||!T.setTop){return}if(i&&!T._isTop&&T.iconDom&&T.iconDom.style){T._isTop=true;if(e){T.setTop(true,1000100)}else{T.setTop(true)}return}if(!i&&T.iconDom&&T.iconDom.style){delete T._isTop;T.setTop(false)}},select:function(T,i,jW){if(arguments.length>2){jW=jW||window.e;var e=jW.srcElement||jW.target;if(e.className=="selBtn"){return}}var jY=this.json.content||[];var jV=this;var jX=jV.getCurPoint30(T);this.map.closeInfoWindow();if(!jX){return}if((jV.resCity[0]!=jV.resCity[1])&&jV.markerDest){if(this.map){this.map.setViewport(jV.pointsList)}}this._showInfoWindow(jX,T,i);if(this.curSelectedIndex!=-1){this._unSelectIt(T,this.curSelectedIndex)}this.curSelectedIndex=i%10;this._selectIt(T,this.curSelectedIndex)},clearMarkers:function(){var i=this;(function T(){if(i.markersList.length===0){return}i.map.removeOverlay(i.markersList.shift());T()})();(function e(){if(i.pointsList.length===0){return}i.pointsList.shift();e()})()},itmSelect:function(j1,j0){var j5=this;var jV=this.map;var j4=j5.json.content||[];var j3=this.getCurPoint30(j1);j5.qInfo[j1]["n"]=j3[j0]["name"];j5.qInfo[j1]["c"]=this.resCity[j1];j5.qInfo[j1]["u"]=j3[j0]["uid"];var j7=new cu(j3[j0]["location"]["lng"],j3[j0]["location"]["lat"]);var jX=j7;j5.qInfo[j1]["point"]=j7;j5.qInfo[j1]["x"]=jX.lng;j5.qInfo[j1]["y"]=jX.lat;j5.qInfo[j1]["t"]=BMAP_POI_TYPE_NORMAL;if(eP.G("B_PointName"+j1)){eP.G("B_PointName"+j1).innerHTML=j3[j0]["name"]}j5.markerDest=this.addPointMarker(jV,jX,j3[j0]["name"],j1);if(j1!=0&&j1!=this.endIndex){var j6=this.tpListInMap[j1-1];j6.query=j3[j0].name}j5.clearMarkers();if(this.isAllPointSure()){if(j5.markerDest){for(var jW=0;jW<j5.destList.length;jW++){j5.map.removeOverlay(j5.destList[jW])}j5.destList=[];jV.removeOverlay(j5.markerDest);j5.markerDest=null}j5.submit()}else{if(eP.G("RouteAddress_DIV"+j1)){eP.G("RouteAddress_DIV"+j1)["className"]="sel_y"}var T=0;for(var jW=1;jW<=this.endIndex;jW++){var jZ=(j1+jW)%(this.endIndex+1);if(eP.G("RouteAddress_DIV"+jZ)&&eP.G("RouteAddress_DIV"+jZ)["className"]!="sel_y"){T=jZ;break}else{T=jZ;break}}if(j5.resType[T]==0){if(eP.G("RouteAddress_DIV"+(T))){eP.G("RouteAddress_DIV"+(T))["className"]="sel_n"}var j2=j5.curPageIndex[T];var jY=(j2-1)*10+9;var e=this.getCurPoint30(T);if(e.length<(jY+1)){jY=e.length-1}j5.addMarkers(T,[(j2-1)*10,jY]);j5.select(T,0)}else{if(j5.resType[T]==2){if(eP.G("RouteAddress_DIV"+(T))){eP.G("RouteAddress_DIV"+(T))["className"]="sel_n"}}else{if(eP.G("RouteAddress_DIV"+(T))){eP.G("RouteAddress_DIV"+(T))["className"]="sel_x"}}}this.curPointIndex=T}},submit:function(){var jV=this;var jW=this.map;var jX=jV.qInfo[0]["c"];var i=jV.qInfo[jV.endIndex]["c"];if(jX==i){var jY=jX}var e={};var T=new fA("onpoiselected");e.start_name=jV.qInfo[0]["point"]["lat"]+","+jV.qInfo[0]["point"]["lng"];e.end_name=jV.qInfo[1]["point"]["lat"]+","+jV.qInfo[1]["point"]["lng"];e.region=jV.qInfo[0]["c"]||jV.qInfo[1]["c"];T.paramInfo=e;jW.dispatchEvent(T)},getTPointQueryParam:function(j0,e){var jZ=2,jW="",j1="",jX="",T="0",i="",jV="",j2="",jY="1";if(j0.point||j0.rPoint){jZ=1;j1=j0.point?(j0.point.lng+","+j0.point.lat):(j0.rPoint.lng+","+j0.rPoint.lat);if(j0.uid){jZ=2;jW=j0.uid}}if(j0.query){jX=j0.query}if(j0.addr){T="1";i=j0.addr}if(!isNaN(e)){jZ=e}return jZ+"$$"+jW+"$$"+j1+"$$"+jX+"$$"+T+"$$"+i+"$$"+jV+"$$"+jY+"$$+to:"},isAllPointSure:function(){for(var e=0;e<=this.endIndex;e++){if(this.qInfo[e]["n"]==""&&!this.qInfo[e]["x"]&&!this.qInfo[e]["y"]||this.qInfo[e]["n"]==undefined){return false}}return true},_selBtnOver:function(e){e.style.backgroundPosition="-100px -81px"},_selBtnOut:function(e){e.style.backgroundPosition="-21px -81px"},_selBtnDown:function(e){e.style.backgroundPosition="-220px -81px";e.style.fontWeight="bold"},initialize:function(){var jZ=this;var jV=this.endIndex;var j2=this.json;jZ.setParsValue();for(var jX=0;jX<=jV;jX++){if(eP.G("RADiv_PAGE"+jX)){pg0=new eA("RADiv_PAGE"+jX,function(j5){var j4=jZ.curPointIndex;var j3=[(j5-1)*10,j5*10-1];if(jZ.resCount[j4]<(j3[1]+1)){j3[1]=jZ.resCount[j4]-1}eP.remove=function(i){i=eP.G(i);var j6=i.parentNode;j6&&j6.removeChild(i)};if(eP.G("RA_ResItem_"+j4)){eP.remove(eP.G("RA_ResItem_"+j4));eP.insertHTML(eP.G("RADiv_ResItem"+j4),"AFTERBEGIN",jZ.makeListTable(j4,j3))}jZ.addMarkers(j4,j3,true);eP.G("RADiv_ResItem"+j4).scrollTop=0;jZ.curPageIndex[j4]=j5},{pagecap:5,pageCount:jZ.totalPage[jX],page:jZ.curPageIndex[T]})}}var jW=[0,9];var j1=this.curPointIndex,j0=eP.G("RouteAddress_DIV"+j1),e=this.getCurPoint30(j1);if(j0.className=="sel_n"){if(e&&e.length>0){if(e.length<(jW[1]+1)){jW[1]=e.length-1}jZ.addMarkers(j1,jW);jZ.select(j1,0)}}else{if(this.markerDest&&j0.className=="sel_x"){this.map.setViewport(this.locPois)}}for(var T=0;T<=jV;T++){if(eP.G("RouteAddress_DIV"+T)["className"]=="sel_y"){var jY=this.getCurPoint30(T);if(jY.length>0&&jY[0].ifFromIW&&jY[0].ifFromIW==1){eP.rc(eP.G("RD_TOP_BUT"+T),"sel_body_button");eP.G("RD_TOP_BUT"+T).innerHTML=""}}}},withoutPanelInitial:function(){var jZ=this;var jV=this.endIndex;var j2=this.json;jZ.setParsValue();for(var jY=0;jY<=jV;jY++){var T=jZ.curPointIndex;var jX=[0,9];if(jZ.resCount[T]<(jX[1]+1)){jX[1]=jZ.resCount[T]-1}jZ.addMarkers(T,jX,true)}var jW=[0,9];var j1=this.curPointIndex,j0=eP.G("RouteAddress_DIV"+j1),e=this.getCurPoint30(j1);if(j1==1){if(e&&e.length>0){if(e.length<(jW[1]+1)){jW[1]=e.length-1}jZ.addMarkers(j1,jW)}}else{if(this.markerDest&&j1==0){if(this.map){this.map.setViewport(this.pointsList)}}}jZ.select(j1,0)},setStatusByRes:function(T){var jV=this.map;if(T.current_city){if(!(T.result.result_show&1)&&(T.result.type==29||T.result.type==13)){var jW=T.current_city;var i=["country","province","city","area"],jX=jW.type!=null?modelConfig.level[i[jW.type]]:undefined,e=jW.geo!=null?e=bF.parseGeo(jW.geo,true).point:undefined;if(!jV.enableLoadTiles){jV.enableLoadTiles=true;jV.centerAndZoom(e||jV.getCenter(),jX||jV.getZoom())}else{if(jX){jV.zoomTo(jX)}if(e){jV.setCenter(e)}}}}},setParsValue:function(){this.resCity=this.tpCity;var e=this.json.content["result"];if(e.origin["content"].length>0){if(e.origin["content"].length===1){this.resType[0]=1}else{this.resType[0]=0}this.resCount[0]=e.origin["content"].length}else{this.resType[0]=3}if(e.destination["content"].length>0){if(e.destination["content"].length===1){this.resType[1]=1}else{this.resType[1]=0}this.resCount[1]=e.destination["content"].length}else{this.resType[1]=3}return},addMarkers:function(j4,j3,jW){var j6=this.json.content||[];var j7=this;var j5=this.getCurPoint30(j4);var jV=j7.map;j7.clearMarkers();if(!j5){return}for(var j1=j3[0];j1<=j3[1];j1++){var j8=new cu(j5[j1]["location"]["lng"],j5[j1]["location"]["lat"]);j7.markersList.push(fv.addSearchPoi_R(j8,j1-j3[0],j5[j1]["name"],{type:"RouteAddrMarker"},jV));j7.pointsList.push(j8)}var jZ=j7.pointsList;if(j7.markerDest){if(!((j7.resCity[0]!=j7.resCity[1]))){jZ.push(j7.markerDest.getPosition())}}var e=this.map.getMapType();if(false){var jX=ec[BMAP_PERSPECTIVE_MAP].citys;var j0=jX[jV.currentCity][1];var j2=getPointsBounds(jZ);var T=jV.getViewport(j2)["zoom"];if(j0.intersects(j2)){if(T<=15){T=15}jV.centerAndZoom(jZ[0],T)}else{if(jV){jV.setViewport(jZ)}}}else{if(jV){jV.setViewport(jZ)}}if(j7.pointsList.length==11){j7.pointsList.pop()}var jY=this.markersList;for(var j1=j3[0];j1<=j3[1];j1++){(function(){var i=j1;if(jY[j1-j3[0]]){jY[j1-j3[0]].addEventListener("click",function(){j7.select(j4,i)});jY[j1-j3[0]].addEventListener("mouseover",function(){var j9=i%10;if(j7.curSelectedIndex!=j9){j7._selectIt(j4,j9)}});jY[j1-j3[0]].addEventListener("mouseout",function(){var j9=i%10;if(j7.curSelectedIndex!=j9){j7._unSelectIt(j4,j9)}})}})()}},_showInfoWindow:function(jZ,jX,jW){var j0=this;var jY=jZ[jW];var i="<span class=\'iw_poi_title\' title=\'"+jY.name+"\'>"+jY.name+"</span>";var T=[];var j1="";if(jY.address&&jY.address!=""){j1="地址: "+jY.address}T.push("<div style=\'padding:11px 11px 6px 11px;line-height:20px;word-break:break-all\'>"+j1+"</div>");T.push("<div style=\'line-height:180%;margin-bottom:10px;\'>");var jV="选为途经点";if(jX==0){jV="选为起点"}if(jX==this.endIndex){jV="选为终点"}T.push("<div style=\'text-align:center;\'><div id=\'selInfoWndBtn\' class=\'selInfoWndBtn\'  data-uid = \'"+jX+"_"+jW+"\'  />"+jV+"</div>");T.push("</div>");if(!this.infoWindow){this.infoWindow=new dV(T.join(""),{title:i,height:0,width:280,margin:[0,0,0,0]});this.infoWindow.addEventListener("open",function(){var j2=eP.G("selInfoWndBtn");eP.on(j2,"click",function(){var j3=j2.getAttribute("data-uid").split("_");j0.itmSelect(j3[0],j3[1])});eP.on(j2,"mouseover",function(){j0._selBtnOver(j2)});eP.on(j2,"mousedown",function(){j0._selBtnDown(j2)});eP.on(j2,"mouseout",function(){j0._selBtnOut(j2)})});this.infoWindow.addEventListener("close",function(){j0._unSelectIt(jX,e)})}else{this.infoWindow.setTitle(i);this.infoWindow.setContent(T.join(""))}var e=jW%10;if(this.markersList&&this.markersList[e]){this.markersList[e].openInfoWindow(this.infoWindow)}},getCurPoiName:function(e){if(e==undefined){e=this.curPointIndex}if(e==0){return this.startName}else{if(e==this.endIndex){return this.endName}else{return this.tpName[e-1]}}},each:function(jW,T){for(var jV=0,e=jW.length;jV<e;jV++){T(jV,jW[jV])}}});eP.extend(iu.prototype,{_asyncSearch:function(jW,e,jV){var T=this;var i=this.getUrl(jW,e,jV);T.goURI("web",i)},routeCall:function(jW,e,jV){var T=this;var i=this.getUrl(jW,e,jV);T.goURI("web",i)},setPointParameters:function(jV,i){var T=this.opts;var jW="";if(jV&&jV.latlng&&jV.name){var e=jV.latlng;jW="latlng:"+e.lat+","+e.lng;jW+="|name:"+jV.name}else{var e=jV.latlng;jW=e?e.lat+","+e.lng:(jV.name?jV.name:"")}T[i]=jW},getUrl:function(jV,jY,e){this.setPointParameters(jV,"origin");this.setPointParameters(jY,"destination");this.opts=eP.extend(this.opts,e);var jW=this.opts;var T=[];var j1="";var j4="";if(typeof(jW.origin)==="undefined"||jW.origin===""){jW.origin=""}var j3={destination:false,mode:false};for(var jX in jW){j1=jX+"="+jW[jX];T.push(j1);if(typeof(j3[jX])!=="undefined"){j3[jX]=true}}this.mode=jW.mode;if(j3.mode===false){var j2="mode="+BMAP_MODE_DRIVING;this.mode=BMAP_MODE_DRIVING;T.push(j2);j3.mode=true}var j0=true;for(var jZ in j3){j0=j0&&j3[jZ]}if(j0){return T.join("&")}return false},goURI:function(T,i,jW){var e=function(jX){var jY=document.createElement("script");jY.src="http://127.0.0.1:6259/sendintent?callback=send&intent="+encodeURIComponent(jX+"&src=baidu|jsapi#Intent;scheme=bdapp;package=com.baidu.BaiduMap;end");document.body.appendChild(jY)};if(i){var jV=a0[T]+i+"&src=baidu|jsapi";if(T==="web"){jV+="&output=html"}location.href=jV;jW&&jW()}}});');