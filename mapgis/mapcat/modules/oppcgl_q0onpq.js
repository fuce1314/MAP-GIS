/**/ï»¿_jsload&&_jsload('oppcgl', 'function gA(){this._currentState="idle";this._currentTouchCount=0;this._firstPointerId=-1;this._secondPointerId=-1}gA.prototype.takeAction=function(e,i){if(this["_on"+e]){this["_on"+e](i)}return this.getState()};gA.prototype._onmousedown=function(e){if(this._currentTouchCount===0){this._firstPointerId=e}else{if(this._currentTouchCount===1){this._secondPointerId=e}}this._currentTouchCount++;if(this._currentState==="idle"){this._currentState="readyToDrag"}else{if(this._currentState==="dragging"||this._currentState==="readyToDrag"){this._currentState="readyToPinch"}else{if(this._currentState==="pinching"){this._currentState="freeze"}else{this._currentState="freeze"}}}};gA.prototype._onmousemove=function(){if(this._currentState==="readyToDrag"||this._currentState==="dragging"){this._currentState="dragging"}else{if(this._currentState==="readyToPinch"){this._currentState="pinching"}}};gA.prototype._onmouseup=function(e){if(this._currentState==="idle"){return}this._currentTouchCount--;if(this._currentState==="readyToDrag"||this._currentState==="dragging"){this._currentState="idle";this._firstPointerId=-1;this._secondPointerId=-1}else{if(this._currentState==="readyToPinch"||this._currentState==="pinching"){this._clearId(e);this._currentState="freeze"}else{if(this._currentState==="freeze"){if(this._currentTouchCount===0){this._currentState="idle";this._firstPointerId=-1;this._secondPointerId=-1;return}if(this._currentTouchCount===2){if(e!==this._firstPointerId&&e!==this._secondPointerId){this._currentState="pinching"}}if(e===this._firstPointerId||e===this._secondPointerId){this._clearId(e);this._currentState="freeze"}}}}};gA.prototype._ongesturestart=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="idle"||this._currentState==="readyToDrag"){this._currentState="readyToPinch"}};gA.prototype._ongesturechange=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="readyToPinch"){this._currentState="pinching"}};gA.prototype._ongestureend=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="readyToPinch"||this._currentState==="pinching"||this._currentState==="freeze"){this._currentState="idle"}};gA.prototype.getState=function(){return d6[this._currentState]||0};gA.prototype.reset=function(){this._currentState="idle";this._currentTouchCount=0;this._firstPointerId=-1;this._secondPointerId=-1};gA.prototype._clearId=function(e){if(e===this._firstPointerId){this._firstPointerId=-1}else{if(e===this._secondPointerId){this._secondPointerId=-1}}};gA.prototype.setState=function(e){this._currentState=e};bw.register(function(e){if(e._mouse){return}e._mouse=new gf(e);if(!e._mouse._drag){e._mouse=null}if(e._renderType==="webgl"){e.addEventListener("dblclick",function(i){if(!e.config.enableDblclickZoom){return}this.zoomIn(i.point)});e.addEventListener("rightdblclick",function(i){if(!e.config.enableDblclickZoom){return}this.zoomOut(i.point)});e.addEventListener("minuspress",function(i){this.zoomOut()});e.addEventListener("pluspress",function(i){this.zoomIn()})}});function jR(jX,jW){var T={};T.id=jX.pointerId||0;T.clientPos={x:jX.clientX||jX.pageX||0,y:jX.clientY||jX.pageY||0};var jZ=0;var jV=0;var i=jW.container;while(i&&i.parentNode){jZ+=i.scrollLeft;jV+=i.scrollTop;if(i.tagName!=="BODY"&&"absolute|fixed".indexOf(ce(i).position)>=0){i=i.offsetParent}else{i=i.parentNode}}T.clientPos.x=jX.clientX+jZ;T.clientPos.y=jX.clientY+jV;T.offsetPos={x:jX.layerX||jX.offsetX||0,y:jX.layerY||jX.offsetY||0};T.target=jX.target;T.button=jX.button||0;T.ctrlKey=jX.ctrlKey||false;T.metaKey=jX.metaKey||false;var jY=ag(T,jW);eP.extend(T,jY);T.offsetPosMap=new fa(jY.x,jY.y);T.timeStamp=jX.timeStamp;T.domEvent=jX;if(jX.type&&jX.type.indexOf("wheel")>-1){T.wheelDelta=jX.wheelDelta;T.detail=jX.detail;T.deltaX=jX.deltaX;T.deltaY=jX.deltaY;T.deltaMode=jX.deltaMode}T.offsetX=T.offsetPosMap.x;T.offsetY=T.offsetPosMap.y;T.layerX=jX.layerX;T.layerY=jX.layerY;return T}function ag(jV,T){var jX=jV.target;var j6=jV.clientPos.x;var j5=jV.clientPos.y;var j0=null;var jZ=null;if(jX.nodeType!==1){jX=jX.parentNode}var jY=T.getContainer();var jW=jY;while(jW){j6-=jW.offsetLeft+jW.clientLeft||0;j5-=jW.offsetTop+jW.clientTop||0;if(jW.tagName==="BODY"){var j3=ce(jW);if("relative|absolute|fixed".indexOf(j3.position)>=0){j6-=(parseFloat(j3.left)||0)+parseFloat(j3.marginLeft);j5-=(parseFloat(j3.top)||0)+parseFloat(j3.marginTop)}j6+=jW.clientLeft||0;j5+=jW.clientTop||0;var j2=ce(jW.parentNode);if("absolute|fixed".indexOf(j3.position)>=0&&"relative|absolute|fixed".indexOf(j2.position)===-1){jW=null}else{jW=jW.parentNode}}else{if(jW.tagName==="HTML"){var j4=ce(jW);if("relative".indexOf(j4.position)>=0){j6-=(parseFloat(j4.left)||0);j5-=(parseFloat(j4.top)||0)}jW=jW.offsetParent}else{jW=jW.offsetParent}}}var i=T.getPanes();var e=null;while(jX&&jX!==jY){if(jX.hashCode){if(eP.instance(jX.hashCode) instanceof et){j0=eP.instance(jX.hashCode)}if(eP.instance(jX.hashCode) instanceof dV||eP.instance(jX.hashCode) instanceof hO){jZ=eP.instance(jX.hashCode)}}var j7=jX.parentNode;if(j7===i.floatPane||j7===i.markerMouseTarget||j7===i.floatShadow||j7===i.labelPane||j7===i.markerPane||j7===i.mapPane){e=jX}jX=j7}var j1=null;if(e&&!j0&&!jZ){j1=e}return{x:j6,y:j5,overlay:j0,infoWindow:jZ,customOverlayDom:j1,pixel:new fa(j6,j5),point:T.pixelToPointIn(new fa(j6,j5)),latlng:T.pixelToPoint(new fa(j6,j5))}}function g1(jW,jV){var jX=jW.changedTouches[0];var i=jW.changedTouches.length;var T={target:jW.target,timeStamp:jW.timeStamp,ctrlKey:jW.ctrlKey||false,webkitForce:jW.webkitForce,metaKey:jW.metaKey||false,touchesCount:jW.touches.length,targetTouchesCount:jW.targetTouches.length};if(jW.changedTouches){T.changedTouchesCount=jW.changedTouches.length}else{T.changedTouchesCount=1}iI(jX,T,jV);if(i>1){T.secondTouchInfo={};eP.extend(T.secondTouchInfo,T);iI(jW.changedTouches[1],T.secondTouchInfo,jV)}return T}function iI(jX,jY,e){if(!jX){return}var j0=jX.clientX;var jZ=jX.clientY;jY.id=jX.identifier||0;jY.clientPos={x:j0,y:jZ};var jV=0;var T=0;var i=e.container;while(i.offsetParent){jV+=i.offsetLeft;T+=i.offsetTop;i=i.offsetParent}jY.offsetPos={x:j0-jV,y:jZ-T};jY.button=0;jY.offsetPosMap=new fa(jY.offsetPos.x,jY.offsetPos.y);var jW=ag(jY,e);eP.extend(jY,jW)}function bD(jZ,jY){var i=jZ.clientX;var j0=jZ.clientY;if(typeof window.scrollY==="number"){j0+=window.scrollY}var jX={};jX.id=0;jX.clientPos={x:i,y:j0};jX.target=jZ.target;var jV=0;var T=0;var jW=jY.container;while(jW.offsetParent){jV+=jW.offsetLeft;T+=jW.offsetTop;jW=jW.offsetParent}jX.offsetPos={x:i-jV,y:j0-T};jX.timeStamp=jZ.timeStamp;jX.offsetPosMap=new fa(jX.offsetPos.x,jX.offsetPos.y);jX.scale=jZ.scale;jX.rotation=jZ.rotation;return jX}function gf(e){this._map=e;if(e._renderType==="webgl"){this._drag=new gV(e)}else{if(typeof iA==="undefined"){return}this._drag=new iA(e)}this._earthDrag=null;this._earthWheel=null;this._dragStarted=false;this._touchStarted=false;this._waitForSecondTouch=false;this._firstTouchInfo={};this._secondTouchInfo={};this._currentTouchCount=0;this._prevGestureScale=1;this._useGesture=!!((bU()&&window.GestureEvent)||(!window.TouchEvent&&window.GestureEvent));this._opButton=-1;this._rotationFix=0;this._pinchRotationThreshold=20;this._pinchZoomThreshold=0.2;this._gestureStatus={zoom:false,rotate:false,tilt:false,dragZoom:false};this._diffX=0;this._diffY=0;this._enableRightDrag=true;if(typeof navigator.userAgent==="string"&&navigator.userAgent.indexOf("QQBrowser")>0){this._enableRightDrag=false}this._lastWheelTime=new Date();this._isModernBrowser=e.config.isModernBrowser;if(e.getRenderType()==="webgl"){e.deepZoom=new b0(e)}else{if(this._isModernBrowser){e.deepZoom=new aD(e)}}this._stateMachine=new gA();this._init();this._bind();if(this._useGesture){this._bindGesture()}this._bindRightButton();this._bindMouseWheel();this._operationVelocity=0;this._lastDiffDistance=0;this._zoomVelocity=0;this._lastDiffZoom=0;this._rotationVelocity=0;this._initRotation=0;this._trackVelocityTimer=null;this._trackTimeStamp=0;this._lastDragPoint={x:0,y:0};this._penultimateDragPoint={x:0,y:0};this._touchInMap=false}gf.prototype._init=function(){this._supportPointerEvent=(window.PointerEvent||window.MSPointerEvent)&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);var e={mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"};if(this._supportPointerEvent){if(window.PointerEvent){e.mousedown="pointerdown";e.mousemove="pointermove";e.mouseup="pointerup"}else{if(window.MSPointerEvent){e.mousedown="MSPointerDown";e.mousemove="MSPointerMove";e.mouseup="MSPointerUp"}}}this._eventMapping=e;var i=this;this._map.on("destroy",function(){i._stateMachine=null;i._keydown&&eP.un(document,"keydown",i._keydown);i._keydown=null;i._mousemove&&eP.un(document,e.mousemove,i._mousemove);i._mousemove=null;i._touchmove&&eP.un(document,"touchmove",i._touchmove);i._touchmove=null;i._mouseup&&eP.un(document,e.mouseup,i._mouseup);i._mouseup=null;i._touchend&&eP.un(document,"touchend",i._touchend);i._touchend=null;i._mousedown&&eP.un(document,"mousedown",i._mousedown);i._mousedown=null;i._gesturechange&&eP.un(document,"gesturechange",i._gesturechange);i._gesturechange=null;i._gestureend&&eP.un(document,"gestureend",i._gestureend);i._gestureend=null})};gf.prototype._bind=function(){var jW=this._map;var T=jW.temp;var i=this._eventMapping;var jV=this;var e=jW.platform;eP.on(e,i.mousedown,function(jY){if(bU()){return}jV._mousedown=true;var jX=jR(jY,jW);jV._mouseButton=jY.button;jW.dispatchEvent(eP.extend(new fA("onmousedown"),jX));jV._processMouseDown(jX)});eP.on(e,"touchstart",function(jY){if(jV._mousedown===true){return}jV._touchStarted=true;var jX=g1(jY,jW);jV._processMouseDown(jX);jV._touchInMap=true;if(!jX.customOverlayDom){jY.preventDefault()}});eP.on(document,"keydown",this._keydown=function(jX){if(!jV._touchStarted&&jW.currentOperation===d6.dragging){if(jX.metaKey||jX.ctrlKey||jX.altKey){jV._mousedown=false;jV._processMouseUp(jR(jX,jW))}}});eP.on(document,i.mousemove,this._mousemove=function(jY){if(jV._touchStarted){return}var jX=jR(jY,jW);jX.button=jV._mouseButton;if(jW.currentOperation===d6.idle){jW.dispatchEvent(eP.extend(new fA("onmousemove"),jX))}jV._processMouseMove(jX)});eP.on(document,"touchmove",this._touchmove=function(jX){if(!jV._touchInMap){return}jV._processMouseMove(g1(jX,jW));jX.preventDefault});eP.on(document,i.mouseup,this._mouseup=function(jX){if(jV._touchStarted){return}jV._mousedown=false;jV._processMouseUp(jR(jX,jW))});eP.on(document,"touchend",this._touchend=function(j1){if(!jV._touchInMap){return}if(!jV._firstTouchInfo||!jV._firstTouchInfo.offsetPos){jV._processMouseUp(jR(j1,jW));return}if(j1.targetTouches.length===0){var jZ=Math.abs(jV._diffX)>5||Math.abs(jV._diffY)>5;jV._touchStarted=false;if(!jV._twoFingerTouched&&!jZ){var jX=new fA("onclick");eP.extend(jX,jV._firstTouchInfo);jX.icon=jW.getIconByClickPosition(jV._firstTouchInfo.offsetPos);jW.dispatchEvent(jX);if(jV._waitForSecondTouch===false){jV._waitForSecondTouch=true;jV._firstTouchPos={x:jV._firstTouchInfo.offsetPos.x,y:jV._firstTouchInfo.offsetPos.y};jV._doubleTouchTimer=setTimeout(function jY(){jV._waitForSecondTouch=false;jV._doubleTouchTimer=null},jW.config.clickInterval)}else{if(Math.abs(jV._firstTouchInfo.offsetPos.x-jV._firstTouchPos.x)<20&&Math.abs(jV._firstTouchInfo.offsetPos.y-jV._firstTouchPos.y)<20){var j0=new fA("ondblclick");eP.extend(j0,jV._firstTouchInfo);jW.dispatchEvent(j0)}jV._waitForSecondTouch=false;clearTimeout(jV._doubleTouchTimer);jV._doubleTouchTimer=null}}jV._twoFingerTouched=false;jV._touchInMap=false}jV._processMouseUp(g1(j1,jW))});eP.on(e,"click",function(j0){if(window.TouchEvent&&bU()){return}if(jW.getLock()===true){return}if(jW.currentOperation===d6.idle){var jZ=jV._diffX===0&&jV._diffY===0;var jY=jR(j0,jW);if(jZ){var jX=new fA("onclick");eP.extend(jX,jY);jX.icon=jW.getIconByClickPosition(jX.offsetPosMap);jW.dispatchEvent(jX)}if(!T._clickTimer){T._clickTimer=setTimeout(function(){T._clickTimer=null;if(jZ){var j1=new fA("onclickex");eP.extend(j1,jY);jW.dispatchEvent(j1)}},jW.config.clickInterval)}}jV._diffX=0;jV._diffY=0});jW.container.onselectstart=function(){return false};eP.on(jW.container,"contextmenu",function(jX){jX.cancelBubble=true;c(jX);if(jX.button===2&&jW._rightClickDeep){jV._processRightClick(jR(jX,jW));jW._rightClickDeep=false}});eP.on(e,"dblclick",function(jX){if(jW.getLock()===true){return}if(jW.currentOperation===d6.idle){if(eP.Browser.ie){jW.dispatchEvent(eP.extend(new fA("onclick"),jR(jX,jW)))}if(T._clickTimer){clearTimeout(T._clickTimer);T._clickTimer=null}jW.dispatchEvent(eP.extend(new fA("ondblclick"),jR(jX,jW)))}});eP.on(document,"mousedown",this._mousedown=function(jY){jY=window.event||jY;var jX=jY.srcElement||jY.target;if(T.canKeyboard){T.canKeyboard=jW.container.contains(jX)}else{T.canKeyboard=e.contains(jX)}});eP.on(e,"webkitmouseforcedown",function(jX){jW.dispatchEvent(eP.extend(new fA("onforcedown"),jR(jX,jW)))});eP.on(e,"webkitmouseforceup",function(jX){jW.dispatchEvent(eP.extend(new fA("onforceup"),jR(jX,jW)))})};gf.prototype._bindGesture=function(){var e=this;var i=this._map;eP.on(i.platform,"gesturestart",function(jV){i.currentOperation=e._stateMachine.takeAction("gesturestart");var T=bD(jV,i);e._gestureStartTime=T.timeStamp;if(T.rotation<-160){e._rotationFix=180}else{if(T.rotation>160){e._rotationFix=-180}else{e._rotationFix=0}}e._pinchStartPosition=T.offsetPosMap;e._getCurrentDrag().onReadyToPinch(jV,{initMiddlePoint:T.offsetPosMap,pinchStartPosition:e._pinchStartPosition,zoomRatio:1});jV.preventDefault()});eP.on(document,"gesturechange",this._gesturechange=function(jX){if(i.currentOperation!==d6.readyToPinch&&i.currentOperation!==d6.pinching){return}i.currentOperation=e._stateMachine.takeAction("gesturechange");if(i.currentOperation!==d6.pinching){return}var jW=bD(jX,i);if(isNaN(jW.scale)){jW.scale=e._prevGestureScale}else{e._prevGestureScale=jW.scale}jW.rotation+=e._rotationFix;var T=jW.offsetPosMap;e._pinchingPosition=T;e._diffX=T.x-e._pinchStartPosition.x;e._diffY=T.y-e._pinchStartPosition.y;var jV=e._getPinchParam(jW);if(!jV){jX.preventDefault();return}e._getCurrentDrag().onPinching(jX,{pinchStartPosition:e._pinchStartPosition,pinchingPosition:T,pinchingDistance:jV.pinchingDistance,zoomRatio:jV.zoomRatio,angleDiff:jV.rotation,gestureStatus:e._gestureStatus});jX.preventDefault()});eP.on(document,"gestureend",this._gestureend=function(jW){if(i.currentOperation!==d6.readyToPinch&&i.currentOperation!==d6.pinching){return}var jV=bD(jW,i);if(isNaN(jV.scale)){jV.scale=e._prevGestureScale}else{e._prevGestureScale=jV.scale}var T=e._pinchParam||{};e._getCurrentDrag().onPinchEnd(jW,{pinchStartPosition:e._pinchStartPosition,pinchEndPosition:e._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:e._gestureStatus});e._resetGestureParam();i.currentOperation=e._stateMachine.takeAction("gestureend");jW.preventDefault()})};gf.prototype._getPinchParam=function(jV){var j0=jV.scale;var j2=jV.rotation;var jW=jV.offsetPosMap;var jZ=jW.x-this._pinchStartPosition.x;var jX=jW.y-this._pinchStartPosition.y;var T={x:jZ,y:jX};var j1=jV.timeStamp-this._gestureStartTime;if(j1<100){return null}var i=this._gestureStatus;if(!this._gestureDetected){this._gestureDetected=true;if(Math.abs(jZ)<10&&Math.abs(jX)>10&&Math.abs(j0-1)<0.1&&j2<10){i.tilt=true}}var jY=0;if(!i.tilt&&!i.rotate){if(Math.abs(j2)>this._pinchRotationThreshold){this._initRotation=j2;if(j2>0){jY=j2-this._pinchRotationThreshold}else{jY=j2+this._pinchRotationThreshold}i.rotate=true}else{j2=0}}if(i.rotate&&this._initRotation){jY+=j2-this._initRotation}var e=j0;if(i.tilt){e=1}this._pinchParam={zoomRatio:e,rotation:jY,pinchingDistance:T};return this._pinchParam};gf.prototype._resetGestureParam=function(){this._initRotation=0;this._gestureStatus.zoom=false;this._gestureStatus.rotate=false;this._gestureStatus.tilt=false;this._gestureStatus.dragZoom=false;this._gestureDetected=false;this._pinchParam=null;this._gestureStartTime=null};gf.prototype._bindRightButton=function(){var i=this._map;var e=this;eP.on(i.container,this._eventMapping.mouseup,function(T){if(i.mapType===BMAP_EARTH_MAP){return}if(i.getLock()===true){return}if(i.currentOperation!==d6.readyToDrag){if(i.currentOperation===d6.dragging&&e._diffX===0&&e._diffY===0){}else{return}}if(T.button===2){e._processRightClick(jR(T,i))}})};gf.prototype._processMouseDown=function(j0){var i=this._map;if(j0.overlay&&j0.overlay instanceof jz&&j0.overlay._config.enableDraggingMap===false&&!bU()){if(i.currentOperation===d6.idle){this._clearStatus();this._firstTouchInfo=j0;this._firstTouchInfo.initX=j0.offsetPosMap.x;this._firstTouchInfo.initY=j0.offsetPosMap.y;return}}if(i.currentOperation!==d6.idle&&j0.button!==this._opButton){return}if(j0.button===2&&this._currentTouchCount===1){return}if(i.getLock()){return}if(this._currentTouchCount===2){return}this._currentTouchCount++;if(this._currentTouchCount===2){this._twoFingerTouched=true}if(this._lastTouchstartTime&&bU()){var jW=j0.timeStamp-this._lastTouchstartTime;if(jW<200){this._gestureStatus.dragZoom=true}}this._lastTouchstartTime=j0.timeStamp;i.currentOperation=this._stateMachine.takeAction("mousedown",j0.id);if(j0.secondTouchInfo){this._currentTouchCount++;i.currentOperation=this._stateMachine.takeAction("mousedown",j0.secondTouchInfo.id)}if(i.currentOperation===d6.readyToDrag){if((eP.Browser.ie&&j0.target.setCapture)||(eP.Browser.firefox&&j0.target.setCapture)){j0.target.setCapture()}var jX=this._firstTouchInfo;eP.extend(jX,j0);jX.initX=j0.offsetPosMap.x;jX.initY=j0.offsetPosMap.y;this._opButton=j0.button;if(j0.button===2&&this._enableRightDrag===false){i.currentOperation=d6.idle;this._stateMachine.reset();return}this._getCurrentDrag().onReadyToDrag(j0)}else{if(i.currentOperation===d6.readyToPinch){if(j0.secondTouchInfo){eP.extend(this._firstTouchInfo,j0);this._firstTouchInfo.initX=j0.offsetPosMap.x;this._firstTouchInfo.initY=j0.offsetPosMap.y;eP.extend(this._secondTouchInfo,j0.secondTouchInfo);this._secondTouchInfo.initX=j0.secondTouchInfo.offsetPosMap.x;this._secondTouchInfo.initY=j0.secondTouchInfo.offsetPosMap.y;this._opButton=j0.button}else{eP.extend(this._secondTouchInfo,j0);this._secondTouchInfo.initX=j0.offsetPosMap.x;this._secondTouchInfo.initY=j0.offsetPosMap.y}if(this._useGesture){return}this._initTouchDistance=cf(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);this._initMiddlePoint=e2(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);var jV=this._firstTouchInfo.initX-this._initMiddlePoint.x;var j2=this._initMiddlePoint.y-this._firstTouchInfo.initY;var T=this._secondTouchInfo.initX-this._initMiddlePoint.x;var j1=this._initMiddlePoint.y-this._secondTouchInfo.initY;var jY;if(jV-T!==0){var jZ=(j1-j2)/(T-jV);jY=e1(Math.atan(jZ))}else{jY=90}if(jY<0){jY=180+jY}this._initAngle=jY;this._preAngle=jY;this._pinchStartPosition=this._initMiddlePoint;this._getCurrentDrag().onReadyToPinch(j0,{initMiddlePoint:this._initMiddlePoint,pinchStartPosition:this._pinchStartPosition,zoomRatio:1})}}};gf.prototype._processMouseMove=function(jX){var i=this._map;if(i.currentOperation===d6.idle){return}if(jX.id===this._firstTouchInfo.id){eP.extend(this._firstTouchInfo,jX)}else{if(jX.id===this._secondTouchInfo.id){eP.extend(this._secondTouchInfo,jX)}}if(jX.secondTouchInfo){if(jX.secondTouchInfo.id===this._firstTouchInfo.id){eP.extend(this._firstTouchInfo,jX.secondTouchInfo)}else{if(jX.secondTouchInfo.id===this._secondTouchInfo.id){eP.extend(this._secondTouchInfo,jX.secondTouchInfo)}}}i.currentOperation=this._stateMachine.takeAction("mousemove",jX.id);if(i.currentOperation===d6.pinching){if(this._useGesture){return}if(!this._gestureStartTime){this._gestureStartTime=jX.timeStamp}var j1=cf(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);var j0=e2(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);this._pinchingPosition=j0;this._diffX=j0.x-this._initMiddlePoint.x;this._diffY=j0.y-this._initMiddlePoint.y;var jY={scale:Math.round(j1/this._initTouchDistance*100)/100,rotation:this._calcRotationDiff(j0),offsetPosMap:j0,timeStamp:jX.timeStamp};this._pinchingPosition=j0;var T=this._getPinchParam(jY);if(T){this._zoomRatio=T.zoomRatio;this._getCurrentDrag().onPinching(jX,{initMiddlePoint:this._initMiddlePoint,pinchStartPosition:this._pinchStartPosition,pinchingPosition:j0,pinchingDistance:T.pinchingDistance,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}}else{if(i.currentOperation===d6.dragging){var jW=this._getCurrentDrag();if(this._dragStarted===false){jW.onDragStart&&jW.onDragStart(jX);this._dragStarted=true}if(jX.id===this._firstTouchInfo.id){this._diffX=jX.offsetPosMap.x-this._firstTouchInfo.initX;this._diffY=jX.offsetPosMap.y-this._firstTouchInfo.initY}else{if(jX.secondTouchInfo&&jX.secondTouchInfo.id===this._firstTouchInfo.id){this._diffX=jX.secondTouchInfo.offsetPosMap.x-this._firstTouchInfo.initX;this._diffY=jX.secondTouchInfo.offsetPosMap.y-this._firstTouchInfo.initY}}this._lastDragPoint=jX.pixel;var jV;if(this._lastDragPoint.x===this._penultimateDragPoint.x&&this._lastDragPoint.y===this._penultimateDragPoint.y){jV={x:this._diffX,y:this._diffY}}else{jV={x:this._lastDragPoint.x-this._penultimateDragPoint.x,y:this._lastDragPoint.y-this._penultimateDragPoint.y}}if(!i.config.enableDragging){return}jW.onDragging(jX,{diffX:this._diffX,diffY:this._diffY,velocity:this._operationVelocity,button:this._opButton,dragDistance:{x:this._diffX,y:this._diffY},gestureStatus:this._gestureStatus,dir:jV});if(!this._trackVelocityTimer){var jZ=this;this._trackTimeStamp=(new Date()).getTime();this._trackVelocityTimer=setInterval(function(){jZ._trackVelocity();jZ._penultimateDragPoint=jZ._lastDragPoint},30)}}}};gf.prototype._calcRotationDiff=function(j0){var i=this._firstTouchInfo.offsetPosMap.x-j0.x;var jZ=j0.y-this._firstTouchInfo.offsetPosMap.y;var e=this._secondTouchInfo.offsetPosMap.x-j0.x;var jY=j0.y-this._secondTouchInfo.offsetPosMap.y;var jV;if(i-e!==0){var jW=(jY-jZ)/(e-i);jV=e1(Math.atan(jW))}else{jV=90}if(jV<0){jV=180+jV}var T=jV;while(this._preAngle-jV>100){jV=jV+180}while(this._preAngle-jV<-100){jV=jV-180}var jX=this._initAngle-jV;this._preAngle=jV;return jX};gf.prototype._processMouseUp=function(jW){var jV=this._map;if(jV.currentOperation===d6.idle){return}if(jW.button!==this._opButton){return}this._currentTouchCount--;if(jV.currentOperation===d6.readyToDrag||jV.currentOperation===d6.dragging){if(this._trackVelocityTimer){clearInterval(this._trackVelocityTimer);this._trackVelocityTimer=null}this._dragStarted=false;var i;if(this._lastDragPoint.x===this._penultimateDragPoint.x&&this._lastDragPoint.y===this._penultimateDragPoint.y){i={x:this._diffX,y:this._diffY}}else{i={x:this._lastDragPoint.x-this._penultimateDragPoint.x,y:this._lastDragPoint.y-this._penultimateDragPoint.y}}this._getCurrentDrag().onDragEnd(jW,{velocity:this._operationVelocity,dragDistance:{x:this._diffX,y:this._diffY},gestureStatus:this._gestureStatus,dir:i});this._clearStatus(jW);this._resetGestureParam();if((eP.Browser.ie&&jW.target.releaseCapture)||(eP.Browser.firefox&&jW.target.releaseCapture)){jW.target.releaseCapture()}this._opButton=-1}else{if(jV.currentOperation===d6.pinching){if(!this._useGesture){var T=this._pinchParam;if(T){this._getCurrentDrag().onPinchEnd(jW,{pinchStartPosition:this._pinchStartPosition,pinchEndPosition:this._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}this._resetGestureParam()}this._clearId(jW.id)}else{if(jV.currentOperation===d6.freeze){if(this._currentTouchCount===0){this._clearStatus(jW)}else{if(jW.id===this._firstTouchInfo.id||jW.id===this._secondTouchInfo.id){if(!this._useGesture){var T=this._pinchParam;if(T){this._getCurrentDrag().onPinchEnd(jW,{pinchStartPosition:this._pinchStartPosition,pinchEndPosition:this._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}this._resetGestureParam()}this._clearId(jW.id)}}}}}jV.currentOperation=this._stateMachine.takeAction("mouseup",jW.id);if(jW.changedTouchesCount===2||jW.targetTouchesCount===0){jW.changedTouchesCount=1;this._processMouseUp(jW)}if(this._currentTouchCount===0&&bU()){this._diffX=this._diffY=0}};gf.prototype._clearId=function(e){if(e===this._firstTouchInfo.id){this._firstTouchInfo={}}else{if(e===this._secondTouchInfo.id){this._secondTouchInfo={}}}};gf.prototype._clearStatus=function(){this._firstTouchInfo={};this._secondTouchInfo={}};gf.prototype._processRightClick=function(jW){var jV=this._map;var T=jV.temp;if(T.rightDblclickTimer){clearTimeout(T.rightDblclickTimer);T.rightDblclickTimer=null;jV.dispatchEvent(eP.extend(new fA("onrightclick"),jW));jV.dispatchEvent(eP.extend(new fA("onrightdblclick"),jW))}else{jV.dispatchEvent(eP.extend(new fA("onrightclick"),jW));var i=eP.extend(new fA("onrightclickex"),jW);T.rightDblclickTimer=setTimeout(function(){T.rightDblclickTimer=null;jV.dispatchEvent(i)},jV.config.clickInterval)}};gf.prototype._bindMouseWheel=function(){var jV=this._map;var T=this;if(!eP.Browser.firefox){eP.on(jV.container,"mousewheel",function i(jW){if(jV.getLock()===true){return}if(!jV.config.enableWheelZoom){return}if(jV.mapType!==BMAP_EARTH_MAP){if(T._isModernBrowser){T._deepZoomWheel(jW)}else{T._wheel(jW)}}else{if(T._earthWheel){T._earthWheel.onWheel(jR(jW,jV))}}c(jW)})}else{eP.on(jV.container,"wheel",function e(jW){if(jV.getLock()===true){return}if(!jV.config.enableWheelZoom){return}if(jV.mapType!==BMAP_EARTH_MAP){if(T._isModernBrowser){T._deepZoomWheel(jW)}else{T._wheel(jW)}}else{if(T._earthWheel){T._earthWheel.onWheel(jR(jW,jV))}}c(jW)})}};gf.prototype._getCurrentDrag=function(){var e=this._map;if(e.getMapType()!==BMAP_EARTH_MAP){return this._drag}return this._earthDrag};gf.prototype._wheel=function(jY){var jX=this._map;var jV=this._map.temp;if(jV.dragAni){jV.dragAni.stop();jV.dragAni=null;setTimeout(function(){jX.dispatchEvent(new fA("onmoveend"))},1)}if(jV.touchZoomLabelCanvas){jV.touchZoomLabelCanvas.style.display="none"}if(jV.touchZoomDiv){jV.touchZoomDiv.style.display="none"}jY=window.event||jY;jX.lastLevel=jX.zoomLevel;var T=new fA("onmousewheel");T.trend=jY.wheelDelta>=0;if(isNaN(jY.wheelDelta)){T.trend=jY.deltaY<=0}var i=new Date();if(T.trend===true&&jX.zoomLevel===jX.getMaxZoom()||T.trend===false&&jX.zoomLevel===jX.getMinZoom()||i-this._lastWheelTime<220){jX.currentOperation^=d6.mousewheel;if(T.trend===true&&jX.zoomLevel===jX.getMaxZoom()||T.trend===false&&jX.zoomLevel===jX.getMinZoom()){var jW=new fA("onzoomexceeded");if(jX.zoomLevel===jX.getMaxZoom()){jW.targetZoom=jX.zoomLevel+1}else{jW.targetZoom=jX.zoomLevel-1}jX.dispatchEvent(jW)}c(jY);return}this._astWheelTime=i;eP.extend(T,jR(jY,jX));jX.dispatchEvent(T)};gf.prototype._deepZoomWheel=function(jV){var T=this._map;var i=new fA("ondeepzoommousewheel");eP.extend(i,jR(jV,T));T.dispatchEvent(i)};gf.prototype.setEarthDrag=function(e){this._earthDrag=e};gf.prototype.setEarthWheel=function(e){this._earthWheel=e};gf.prototype._trackVelocity=function(){var T=(new Date()).getTime();var e=T-this._trackTimeStamp;if(e===0){return}this._trackTimeStamp=T;var jV=Math.sqrt(Math.pow(this._diffX,2)+Math.pow(this._diffY,2));var jW=Math.abs(jV-this._lastDiffDistance);this._lastDiffDistance=jV;var i=500*jW/e;this._operationVelocity=(0.6*i+0.4*this._operationVelocity)};function b0(e){this._map=e;this.scrollCount=0;this.maxZoomWheelDir=1;this.minZoomWheelDir=-1;this.maxZoom=e.getMaxZoom();this.minZoom=e.getMinZoom();this.lastWheelTime=0;this._opMethod="";this.lastWheelDelta=0;this.lastDiff=0;this._mouseFixPoint=null;this.bindEvent()}var gJ=b0.prototype;gJ.bindEvent=function(){var e=this;var i=e._map;i.addEventListener("maptypechange",function(T){e.maxZoom=i.getMaxZoom();e.minZoom=i.getMinZoom()});i.addEventListener("deepzoommousewheel",function(T){e.wheel(T)})};gJ.wheel=function(jX){var jZ=this;var i=jZ._map;var j6=i.temp;if(j6.dragAni){j6.dragAni.stop(false,{readyToMove:true});j6.dragAni=null}var jV=Math.floor(jX.timeStamp);var T=jV-this.lastWheelTime;var jW=this._trend=jX.deltaY<=0;if(isNaN(jX.deltaY)){jW=this._trend=jX.wheelDelta>=0}var j5=Math.abs(jX.deltaY);var j3=Math.abs(jX.wheelDelta);var j2=j5;if(j3===0&&j2===0){return}var j1=false;if(this._opMethod==="mouseWheel"&&typeof this._preTrend==="boolean"&&this._preTrend!==this._trend){j1=true}if(T>100||j1===true){this._opMethod=hB(j3,j2,jX.deltaMode);if(this._opMethod==="mouseWheel"){if(j6.wheelAni){j6.wheelAni.stop();j6.wheelAni=null}if(this._wheelMotionTimer){clearTimeout(this._wheelMotionTimer);this._wheelMotionTimer=null}}this._mouseFixPoint=jX.point.clone();this.scrollCount=0;this.startZoom=i.getZoom();i.fire(new fA("onmousewheelscroll"));if((this.startZoom===this.maxZoom&&jW===true)||(this.startZoom===this.minZoom&&jW===false)){var j4=new fA("onzoomexceeded");j4.targetZoom=this.startZoom;i.dispatchEvent(j4);return}}this.lastWheelTime=jV;var j0=this._mouseFixPoint;if(this._opMethod==="mouseWheel"&&j2!==0){var jY=j3?(j3/3):j2;this._onWheelMouse(jY,jW,j0,jX.deltaMode);return}if(this._opMethod==="padScroll"){j5=j2/50}else{j5=j2/20}if(isNaN(j5)&&jX.detail){j5=Math.abs(jX.detail)}var jZ=this;setTimeout(function(){var j7=i.getZoom();var e=jW===true?j7+0.2*j5:j7-0.2*j5;i.setZoomIn(e,{zoomCenter:j0,stopCurrentAnimation:true,noAnimation:true})},20)};gJ._onWheelMouse=function(i,jV,jX,T){var jY=this._map;this.scrollCount++;if(this.scrollCount>10){this.scrollCount=10}var jW=0;if(eP.Browser.firefox){if(T===1){i*=15}if(!eP.Platform.macintosh){jW=bA(i*0.005,2)*this.scrollCount}else{if(i%1!==0){i*=10}jW=bA(i*0.01,2)}}else{if(!eP.Platform.macintosh){jW=bA(i*0.005,2)*this.scrollCount}else{jW=bA(i*0.005,2)}}if(jW>2){jW=2}if(jV===false){jW=-jW}var e=jY.getZoom()+jW;jY.setZoomIn(e,{zoomCenter:jX,fromMouseWheel:true});this._preTrend=this._trend};function gV(e){this._map=e;this._opButton=0;this._initTilt=0;this._initHeading=0;this._mapHeight=0;this._changeHeadingStartPos=null}eP.extend(gV.prototype,{onReadyToDrag:function(jW,i){var jV=this._map;var T=jV.temp;if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}if(jV._ani){jV._ani.stop();jV._ani=null}if(jV._infiniteAni){jV._infiniteAni.stop();jV._infiniteAni=null}if(T.tlPan){T.tlPan.stop();T.tlPan=null}if(!jV.config.enableDragging){return}if(jW.button===0&&jW.ctrlKey===false&&jW.metaKey===false){this._opButton="left";T.pl=jV.offsetX;T.pt=jV.offsetY}else{this._opButton="right";this._initTilt=jV.getTilt();this._initHeading=jV.getHeading();this._mapHeight=jV.getSize().height}if(T.curSpotsArray.length===0&&T.curAreaSpot===null){jV.platform.style.cursor=jV.config.draggingCursor}else{jV.platform.style.cursor="pointer"}},onReadyToPinch:function(jV,i){var T=this._map;if(T.config.fixCenterWhenPinch){this._fixPoint=T.getCenterIn().clone()}else{this._fixPoint=T.pixelToPointIn(i.pinchStartPosition)}this._fixPixel=T.pointToPixelIn(this._fixPoint);this._startZoom=T.getZoom();this._startHeading=T.getHeading();this._startTilt=T.getTilt()},onDragStart:function(){var e=this._map;if(!e.config.enableDragging){return}e.platform.style.cursor=e.config.draggingCursor;this._startZoom=e.getZoom()},onDragging:function(jZ,i){var jV=this._map;if(!jV.config.enableDragging){return}var j4=jV.temp;if(this._opButton==="right"&&jV.getZoom()<jV._enableTiltZoom){return}var j2=i.diffX;var j1=i.diffY;var jX=false;var j3=i.gestureStatus.dragZoom;if(Math.abs(j2)>1||Math.abs(j1)>1){jX=true;if(!j4._moved){if(!j3){jV.dispatchEvent(eP.extend(new fA("ondragstart"),jZ));jV.dispatchEvent(new fA("onmovestart"))}j4._moved=true}}if(jX===false){return}jV.dispatchEvent(eP.extend(new fA("ondragging"),jZ));j4.lastDomMoveTime=jZ.timeStamp;if(j3){jV.setZoomIn(this._startZoom-j1/50,{noAnimation:true})}else{if(this._opButton==="left"){jV._setPlatformPosition(j2,j1,{initMapOffsetX:j4.pl,initMapOffsetY:j4.pt})}else{var j0=20;var jY={noAnimation:true};if(Math.abs(j1)>j0){if(!this._rightDragInitY){this._rightDragInitY=jZ.pixel.y}}if(this._rightDragInitY){if(!jV.config.enableTilt){return}var T=jZ.pixel.y-this._rightDragInitY;this._setTiltByMoveY(this._initTilt,T,jY)}if(Math.abs(j2)>j0){if(!this._rightDragInitX){this._rightDragInitX=jZ.pixel.x}}if(this._rightDragInitX){if(!jV.config.enableRotate){return}var jW=jZ.pixel.x-this._rightDragInitX;if(this._changeHeadingStartPos===null){this._changeHeadingStartPos=jZ.pixel}if(this._changeHeadingStartPos.y<this._mapHeight/2){jV.setHeading(this._initHeading+jW*0.3,jY)}else{jV.setHeading(this._initHeading-jW*0.3,jY)}}}}},_setTiltByMoveY:function(T,jX,e){var jW=this._map;var i=T+jX*0.4;var jV=jW.getCurrentMaxTilt();i=dI(i,hx.MIN_TILT,jV,0.4);jW.setTilt(i,e)},onPinching:function(jX,i){var jW=this._map;if(jW.config.enableTiltGestures&&i.gestureStatus.tilt){this._setTiltByMoveY(this._startTilt,i.pinchingDistance.y,{noAnimation:true});return}var jV=Math.log(i.zoomRatio)/Math.log(2);var T=Math.max(Math.min(this._startZoom+jV,jW.getMaxZoom()),jW.getMinZoom());if(jW.config.enableRotateGestures&&typeof i.angleDiff==="number"){jW.setHeading(this._startHeading+i.angleDiff,{noAnimation:true})}jW.setZoomIn(T,{zoomCenter:this._fixPoint,noAnimation:true,fixPixel:this._fixPixel})},onDragEnd:function(jW,i){var jV=this._map;if(!jV.config.enableDragging){return}var T=jV.temp;if(T.curSpotsArray.length===0&&T.curAreaSpot===null){jV.platform.style.cursor=jV.config.defaultCursor}else{jV.platform.style.cursor="pointer"}if(T._moved&&!i.gestureStatus.dragZoom){jV.dispatchEvent(eP.extend(new fA("ondragend"),jW));if(!jV.config.enableInertialDragging||jW.timeStamp-T.lastDomMoveTime>100){jV.dispatchEvent(new fA("onmoveend"))}else{this._processMotion(i.velocity,i.dragDistance,i.dir)}T._moved=false}this._changeHeadingStartPos=null;this._rightDragInitX=this._rightDragInitY=null;if(this._opButton==="right"){this._tiltBounceBack()}},_tiltBounceBack:function(){var i=this._map;if(i.getZoom()<i._enableTiltZoom){return}var e=i.getCurrentMaxTilt();if(i.getTilt()>e){i.setTilt(e,{duration:200})}else{if(i.getTilt()<hx.MIN_TILT){i.setTilt(hx.MIN_TILT,{duration:200})}}},onPinchEnd:function(jW,i){var jV=this._map;if(i.gestureStatus.tilt){this._tiltBounceBack()}if(jV.config.enableRotateGestures&&i.gestureStatus.rotate){var T=Math.abs(jV.getHeading());if(T%360<10){jV.resetHeading()}}},_processMotion:function(jW,j8,j0){var j6=this._map;var jZ=j6.temp;var T=(new Date()).getTime();var i=0.5*jW;if(this._opButton==="right"){i=0.15*jW}var j4=0;var j3=0;if(j0.y===0){j4=i}else{var jV=Math.abs(j0.x/j0.y);j3=Math.round(Math.sqrt(i*i/(1+jV*jV)));j4=Math.round(jV*j3)}var j2=im(j6._heading);if(j0.x<0){j4=-j4}if(j0.y<0){j3=-j3}var jY=j8.x+j4;var jX=j8.y+j3;if(jZ.dragAni){jZ.dragAni.stop();jZ.dragAni=null;j6.dispatchEvent(new fA("onmoveend"))}var j9=0;var j7=0;if(this._opButton==="right"){if(!this._changeHeadingStartPos){return}var j1=this._mapHeight;var e=this._changeHeadingStartPos;var j5=this._initHeading;jZ.dragAni=new fq({duration:10000,render:function(kb){var ka=(new Date()).getTime()-T;var kc=Math.exp(-ka/250);j9=jY-j4*kc;if(Math.abs(j4*kc)<5&&Math.abs(j3*kc)<5){jZ.dragAni&&jZ.dragAni.stop();return}if(e.y<j1/2){j6.setHeading(j5+j9*0.3,{noAnimation:true})}else{j6.setHeading(j5-j9*0.3,{noAnimation:true})}},finish:function(){jZ.dragAni=null;if(e.y<j1/2){j6.setHeading(j5+j9*0.3,{noAnimation:true})}else{j6.setHeading(j5-j9*0.3,{noAnimation:true})}j6.dispatchEvent(new fA("onmoveend"))},onStop:function(){jZ.dragAni=null;if(e.y<j1/2){j6.setHeading(j5+j9*0.3,{noAnimation:true})}else{j6.setHeading(j5-j9*0.3,{noAnimation:true})}j6.dispatchEvent(new fA("onmoveend"))}});return}jZ.dragAni=new fq({duration:10000,render:function(kc,kb){var ka=(new Date()).getTime()-T;var kd=Math.exp(-ka/250);j9=jY-j4*kd;j7=jX-j3*kd;if(Math.abs(j4*kd)<5&&Math.abs(j3*kd)<5){jZ.dragAni.stop();return}j6._setPlatformPosition(j9,j7,{initMapOffsetX:jZ.pl,initMapOffsetY:jZ.pt})},finish:function(){jZ.dragAni=null;j6._setPlatformPosition(j9,j7,{initMapOffsetX:jZ.pl,initMapOffsetY:jZ.pt});j6.dispatchEvent(new fA("onmoveend"))},onStop:function(ka){jZ.dragAni=null;j6._setPlatformPosition(j9,j7,{initMapOffsetX:jZ.pl,initMapOffsetY:jZ.pt});var kb=new fA("onmoveend");kb.userData=ka;j6.dispatchEvent(kb)}})}});bw.register(function(i){var e=i;if(i._keyboardInit===true){return}i._keyboardInit=true;eP.on(document,"keydown",function(T){if(e.temp.stopArrow===true){e.temp.stopArrow=false}if(e.config.enableKeyboard&&e.temp.canKeyboard){var T=window.event||T;var jV=false;if(eP.Platform.macintosh){if(T.metaKey===true){jV=true}}else{if(T.ctrlKey===true){jV=true}}switch(T.keyCode||T.which){case 189:case 109:case 173:if(!jV){e.temp.operating=true;e.dispatchEvent(new fA("onminuspress"))}break;case 61:case 187:case 107:if(!jV){e.temp.operating=true;e.dispatchEvent(new fA("onpluspress"))}break;case 33:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 34:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 35:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 36:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 37:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=1;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 38:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=2;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 39:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=4;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 40:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=8;e._arrow();T.cancelBubble=true;T.returnValue=false;break}}});eP.on(document,"keyup",function(T){if(e.config.enableKeyboard){var T=window.event||T;switch(T.keyCode||T.which){case 37:e.temp.arrow=e.temp.arrow&~1;if(e.temp.arrow!==0){e._arrow()}break;case 38:e.temp.arrow=e.temp.arrow&~2;if(e.temp.arrow!==0){e._arrow()}break;case 39:e.temp.arrow=e.temp.arrow&~4;if(e.temp.arrow!==0){e._arrow()}break;case 40:e.temp.arrow=e.temp.arrow&~8;if(e.temp.arrow!==0){e._arrow()}break}}e.temp.operating=false});hx.prototype._arrow=function(){if(this.mapType===BMAP_EARTH_MAP){return}if(this._arrow.occurrent&&this._arrow._lastArrow===this.temp.arrow&&this.temp.stopArrow===true){return}var T=this;var jW=T.temp.arrow;T._arrow._lastArrow=jW;T._arrow.interval=30;T._arrow.duration=999;T._arrow.dx=T._arrow.dy=0;if(jW&1){T._arrow.dx=1}if(jW&2){T._arrow.dy=1}if(jW&4){T._arrow.dx=-1}if(jW&8){T._arrow.dy=-1}if(jW&1&&jW&4){T._arrow.dx=0}if(jW&2&&jW&8){T._arrow.dy=0}if(!T._arrow.occurrent){T._arrow.occurrent=true;T._arrow.time=new Date().getTime();T._arrow.beginTime=T._arrow.time;T.dispatchEvent(new fA("onmovestart"));var jV=new fq({fps:T._arrow.interval,duration:T._arrow.duration,transition:gq.linear,render:function(j3){var jY=T._arrow;var j1=T.temp.arrow;if(T._arrow._lastArrow!==j1){T._arrow._lastArrow=j1;if(j1&1){jY.dx=1}if(j1&2){jY.dy=1}if(j1&4){jY.dx=-1}if(j1&8){jY.dy=-1}if(j1&1&&j1&4){jY.dx=0}if(j1&2&&j1&8){jY.dy=0}}if(T.temp.stopArrow===true){jY.dx=0;jY.dy=0}var j2=new Date().getTime();var j0=Math.pow((j2-jY.beginTime)/jY.duration,2);if(!T.temp.arrow){jY.occurrent=false;jV.terminative=true;T._arrow.time=new Date().getTime();setTimeout(function(){T.dispatchEvent(new fA("onmoveend"))},40)}var j4=(j2-jY.time);var jZ=jY.dx*j4*j0>=0?Math.ceil(jY.dx*j4*j0):Math.floor(jY.dx*j4*j0);var jX=jY.dy*j4*j0>=0?Math.ceil(jY.dy*j4*j0):Math.floor(jY.dy*j4*j0);if(jZ!==0&&jX!==0){jZ=Math.round(jZ*0.7);jX=Math.round(jX*0.7)}jY.time=j2;T._setPlatformPosition(jZ,jX)},finish:function(){T._arrow.time=new Date().getTime();setTimeout(function(){T._arrowPan()},T._arrow.interval)}})}};hx.prototype._arrowPan=function(){var jX=this;var jV=jX._arrow;if(jX.temp.stopArrow){jV.dx=0;jV.dy=0}if(!jX.temp.arrow){jV.occurrent=false;jX.dispatchEvent(new fA("onmoveend"));return}var jY=new Date().getTime();var jZ=(jY-jV.time);var jW=Math.ceil(jV.dx*jZ);var T=Math.ceil(jV.dy*jZ);jV.time=jY;jX._setPlatformPosition(jW,T);setTimeout(function(){jX._arrowPan()},jV.interval)}});');
